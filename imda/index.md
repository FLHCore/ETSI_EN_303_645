
### 6.1 Introduction (簡介)

#### 📝 原文翻譯

[cite_start]第 6 節為 IoT 用戶和 IoT 開發人員在實作階段提供了一套基線安全建議 [cite: 231]。

[cite_start]這些建議涵蓋了四個基本的 IoT 安全設計原則（詳情請參閱附錄 A）[cite: 232]：
1.  [cite_start]預設安全 (Secure by defaults) [cite: 233]
2.  [cite_start]嚴謹防禦 (Rigour in defence) [cite: 234]
3.  [cite_start]問責性 (Accountability) [cite: 235]
4.  [cite_start]韌性 (Resiliency) [cite: 236]

[cite_start]單一產品被用來實作一個系統，而該系統在組織的流程、政策和人員的背景下運行 [cite: 237][cite_start]。從產品到系統、最終到組織的整合層級不斷提高，需要額外的考量，因為整體的安全狀態取決於其最弱的環節 [cite: 238][cite_start]。總體而言，這些建議是系統化地、在 IoT 系統整個生命週期中保護它的基礎 [cite: 239]。

[cite_start]雖然本文件提供的基線建議適用於大多數 IoT 系統，但 IoT 用戶和 IoT 開發人員仍需要根據業務需求和相關法規要求，來決定這些建議對其預期系統/解決方案的適當性 [cite: 240]。

#### 👨‍💻 開發人員重點提醒

* [cite_start]**您的責任重大：** 這整節（第 6 節）明確指出是為您（開發人員）在「實作階段」準備的 [cite: 231]。
* [cite_start]**跳脫「單一產品」思維：** 您不能只考慮您開發的「單一產品」[cite: 237][cite_start]。您必須意識到，您的裝置會被整合到一個更大的「系統」和「組織」中 [cite: 237, 238]。
* [cite_start]**別當「最弱環節」：** 系統的整體安全取決於最弱的部分 [cite: 238]。您開發的裝置絕對不能成為那個最弱的環節。
* [cite_start]**安全非一體適用：** 您需要和您的客戶（IoT 用戶）一起評估，哪些建議是他們業務真正需要的，以及是否有特定法規必須遵守 [cite: 240]。

---

好的，我們接著處理 6.2 節及其子節 6.2.1。

---

### 6.2 Principle 1: Secure by defaults (原則 1：預設安全)

### 6.2.1 Employ strong cryptography [2] (採用強式密碼學 [2])

#### 📝 原文翻譯

[cite_start]強大的密碼學能力是確保資料交易安全的基礎構建模組，包括 IoT 裝置之間的身份驗證和感測數據交換 [cite: 243][cite_start]。密碼學能力的用法範例包括數位簽章和加密 [cite: 244]。

[cite_start]**建議：** 應在 IoT 系統中適當且足夠地應用業界公認的密碼學技術和最佳實踐 [cite: 245]。

最佳實踐的範例包括：
* [cite_start]使用經批准的演算法 [cite: 247]
* [cite_start]足夠的金鑰長度 [cite: 248]
* [cite_start]使用經批准的隨機數生成器 [cite: 249]
* [cite_start]建議的密碼學週期 [cite: 250]
* [cite_start]建議的熵源 (entropy sources) [cite: 251]
* [cite_start]使用可更新的密碼學 [cite: 251]

#### 👨‍💻 開發人員重點提醒

* **「安全」是出廠標配，不是選配：** 「預設安全」原則意味著您的裝置一出廠就必須是安全的。您不能預期用戶會自己去開啟安全功能。
* [cite_start]**別自創加密法：** 絕對不要自己發明加密演算法。指南明確要求使用「業界公認的」和「經批准的」技術 [cite: 245, 247]。這意味著您應該使用像 AES、RSA 這類經過嚴格審查的標準演算法。
* [cite_start]**金鑰管理是關鍵：** 演算法再強，金鑰管不好也沒用。您必須注意金鑰的長度（例如，不要用過短的金鑰）、金鑰的來源（需要好的隨機數和熵源）[cite: 248, 249, 251][cite_start]，以及金鑰的生命週期（多久該更換一次）[cite: 250]。
* [cite_start]**為未來做準備：** 「使用可更新的密碼學」[cite: 251] 是一個關鍵提醒。現在安全的演算法未來可能被破解。您的裝置必須有能力透過韌體更新 (OTA) 來升級加密演算法或更換金鑰，否則它在未來將成為安全隱患。

---

### 6.2.2 Protect impactful data [1], [3] (保護具影響力的資料 [1], [3])

#### 📝 原文翻譯

[cite_start]IoT 系統的具影響力資料（Impactful data）可指金鑰、憑證、程式碼/韌體、個人資料、輸入/命令和感測數據等 [cite: 253][cite_start]。存取具影響力的資料應要求保證及/或驗證其源自真實的來源，並應受到保護，免於遭未經授權方篡改、修改及/或洩露 [cite: 253][cite_start]。所有進出 IoT 裝置的敏感通訊都應被加密 [cite: 255]。

[cite_start]**建議：** 具影響力的資料應檢查其真實性，並受到保護，免於遭未經授權方洩露和修改 [cite: 254][cite_start]。所有進出 IoT 裝置的敏感通訊都應被加密 [cite: 255]。

#### 👨‍💻 開發人員重點提醒

* [cite_start]**不只是「用戶資料」：** 您必須擴大對「敏感資料」的定義。它不只是用戶的個人資訊，還包括您裝置的**韌體 (firmware)**、用於驗證的**金鑰**和**憑證**，以及接收到的**控制命令** [cite: 253]。如果這些東西被竄改，後果不堪設想。
* **資料保護三態：** 您需要保護所有狀態下的資料：
    1.  [cite_start]**傳輸中 (In transit)：** 裝置與雲端或 App 之間的所有通訊都必須加密 [cite: 255]。這呼應了上一節的 TLS/DTLS。
    2.  **靜態 (At rest)：** 資料儲存在裝置的記憶體（例如 Flash）時，是否需要加密？如果攻擊者能實體接觸到裝置並讀取記憶體，他們是否能輕易竊取金鑰、憑證或用戶資料？
    3.  **使用中 (In use)：** 資料在 RAM 中處理時，也要考慮保護。
* [cite_start]**驗證來源 (真實性)：** 光加密不夠，您還必須驗證資料來源。當您的裝置收到一個（例如「開鎖」或「更新韌體」）的命令時，您必須 100% 確定這個命令是來自合法的主機或用戶，而不是攻擊者偽造的 [cite: 253, 254]。

---

### 6.3 Principle 2: Rigour in defence (原則 2：嚴謹防禦)

### 6.3.1 Conduct threat modelling [8] (執行威脅建模 [8])

#### 📝 原文翻譯

[cite_start]威脅建模提供了一種系統化的方法，有助於識別系統資產、系統資產的安全需求、以及對這些系統資產的可能威脅，從而使有限的可用資源能集中在需要保護的事物上 [cite: 260][cite_start]。威脅建模有助於最小化暴露的攻擊面並緩解剩餘的漏洞 [cite: 261]。

[cite_start]**建議：** 威脅建模應在實作階段開始時進行，並應考慮到 IoT 裝置在定義的操作環境中的預期用途 [cite: 262]。

#### 👨‍💻 開發人員重點提醒

* **別等出事才補救：** 「嚴謹防禦」代表您需要主動預測威脅，而不是被動修補漏洞。本節要求您在「實作階段開始時」就進行威脅建模，也就是在您開始大量撰寫程式碼之前。
* **像駭客一樣思考：** 威脅建模就是站在攻擊者的角度來審視您的設計。您需要回答幾個關鍵問題：
    1.  **我要保護什麼？** (系統資產)：是韌體、金鑰、用戶數據，還是控制權？
    2.  **誰會來攻擊？** (威脅)：是腳本小子、專業駭客，還是能實體接觸到裝置的人？
    3.  **他們會怎麼攻擊？** (攻擊面)：是透過 Wi-Fi、藍牙、JTAG 偵錯埠，還是雲端 API？
* [cite_start]**不只是「功能開發」：** 您的任務不只是讓裝置「能動」，還要讓它「在被攻擊時也能安全」。威脅建模的結果（例如使用 STRIDE 模型 [cite: 357]）將直接轉化為您必須實作的安全需求。
* [cite_start]**情境決定一切：** 「預期用途」和「操作環境」是關鍵 [cite: 262]。一個安裝在公共場所（如路燈）的裝置，其面臨的實體威脅遠高於安裝在私人住宅內的裝置。您的安全設計必須符合這個情境。

---

### 6.3.2 Establish Root-of-Trust [4], [5] (建立信任根 [4], [5])

#### 📝 原文翻譯

[cite_start]信任根 (Root-of-Trust) 提供了一個防篡改的模組，用於儲存和保護裝置的金鑰，以便為其他安全機制建立堅實的基礎，從而透過信任鏈 (chain of trust) 實現更高的安全保證 [cite: 264]。

[cite_start]**建議：** 信任根應被建立並由關鍵系統元件（例如 IoT 閘道器和 IoT 平台）所利用，因為它們可能託管敏感資料並執行具影響力的操作 [cite: 265][cite_start]。例如，信任根可以基於嵌入在裝置中的信賴平台模組 (Trusted Platform Module, TPM) 晶片，或整合在裝置軟體內的虛擬安全元件 [cite: 266]。

#### 👨‍💻 開發人員重點提醒

* [cite_start]**什麼是信任根 (RoT)？** 簡單來說，RoT 是您裝置上一個「絕對可信」的起點。它通常是硬體（但也可能是軟體），其設計目的就是為了防篡改 [cite: 264]。
* **為何需要 RoT？** 如果您的金鑰（用來加密、驗證身份）和程式碼都儲存在一個可被輕易讀取或修改的地方（例如標準的 Flash 記憶體），那麼攻擊者一旦拿到裝置，就可以輕鬆提取金鑰、偽造身份、或刷入惡意韌體。
* [cite_start]**RoT 的核心工作：** 它的主要工作是「安全地儲存和保護金鑰」 [cite: 264][cite_start]。所有基於這個金鑰的後續安全操作（例如驗證韌體簽章、加密通訊）才能被信任，這就是「信任鏈」 [cite: 264]。
* **您的實作選項：**
    1.  [cite_start]**硬體 (高安全性)：** 您可以在電路板上加一顆獨立的安全晶片，如「TPM」 [cite: 266]。這提供了最強的實體防護，但成本也最高。
    2.  **整合 (中安全性)：** 許多現代微控制器 (MCU) 內部已包含硬體安全功能（例如 TrustZone、Secure Element、硬體加密引擎）。
    3.  [cite_start]**軟體 (低安全性)：** 指南提到了「虛擬安全元件」 [cite: 266]，這通常是在軟體層面透過混淆或其他技術來模擬安全儲存，其安全性遠低於硬體。
* [cite_start]**重點應用：** 指南特別點名「IoT 閘道器 (gateway)」和「IoT 平台」這類關鍵元件 [cite: 265]。如果您的裝置是閘道器或扮演類似角色的中樞設備，那麼使用 RoT 就非常重要。

---

### 6.3.3 Employ secure transport protocols [2] (採用安全的傳輸協定 [2])

#### 📝 原文翻譯

[cite_start]傳輸協定用於在系統內部和系統之間傳輸資料 [cite: 268][cite_start]。因此，確保安全版本的傳輸協定被正確配置，以有效保護傳輸中的資料，是至關重要的 [cite: 269]。

[cite_start]**建議：** 應盡可能採用經過驗證的傳輸協定，並正確啟動其安全控制 [cite: 270]。

經過驗證的傳輸協定的安全控制範例包括：
* [cite_start]TCP 負載使用 TLS [cite: 272]
* [cite_start]UDP 負載使用 DTLS [cite: 273]
* [cite_start]使用 MQTT 時採用 TLS [cite: 274]
* [cite_start]停用未經驗證的藍牙配對程序 [cite: 275]

#### 👨‍💻 開發人員重點提醒

* **別再裸傳資料：** 這是最基本也最關鍵的一點。您的裝置透過 Wi-Fi、乙太網路或行動網路傳送的任何資料，都**絕不能**以明文（未加密）形式傳輸。
* [cite_start]**加密「傳輸通道」：** 您的責任是加密「傳輸中」的資料 [cite: 269]。不要預設網路環境是安全的，您必須假設所有網路流量都可能被竊聽。
* **選對工具 (協定)：** 指南已經幫您劃好重點了：
    * [cite_start]**如果用 TCP (例如 HTTP API、MQTT)：** 請務必使用 **TLS** (Transport Layer Security) [cite: 272, 274]。這就是 HTTPS 中的 'S'。如果您在用 MQTT，請確保它運行在 TLS 之上 (MQTTS)。
    * [cite_start]**如果用 UDP (例如 CoAP 或自訂協定)：** 由於 UDP 是無連線的，您不能用 TLS。請使用 **DTLS** (Datagram TLS)，它是專為 UDP 設計的加密協定 [cite: 273]。
    * [cite_start]**如果用藍牙：** 不要使用最簡單、不需 PIN 碼或 PIN 碼為 '0000' 的配對方式。您應強制使用安全的配對程序，例如「LE Secure Connections」 [cite: 275]。
* [cite_start]**「啟用」是您的工作：** 很多開發套件 (SDK) 預設可能「不開啟」TLS，因為這需要憑證和額外設定。您必須在您的程式碼中「強制開啟並正確配置」這些安全控制 [cite: 270]。

---

### 6.4 Principle 3: Accountability (原則 3：問責性)

### 6.4.1 Enforce proper access controls [2], [5] (實施適當的存取控制 [2], [5])

#### 📝 原文翻譯

[cite_start]對系統資源的存取應在其整個生命週期中受到控制和管理，以最小化惡意行為者的機會 [cite: 278][cite_start]。預設密碼和弱密碼是最常被利用的漏洞 [cite: 279][cite_start]。使用多因子驗證 (MFA) 可為啟動者的身份提供更高的保證、增強問責性並減少錯誤 [cite: 280]。

[cite_start]**建議：** 必須對裝置、網路和資料實施適當的存取控制，包含網路和實體兩方面 [cite: 281]。基本的存取控制包括：
* [cite_start]更換所有預設密碼 [cite: 282]
* [cite_start]強制使用 7.2.1 節中規範的強密碼 [cite: 283]
* [cite_start]對具影響力的遠端操作強制使用多因子驗證 (MFA) [cite: 284]
* 保護對裝置及其服務埠的實體存取

#### 👨‍💻 開發人員重點提醒

* [cite_start]**零預設密碼：** 這是最嚴格的要求 [cite: 282]。您的裝置**絕不能**使用通用的預設密碼（例如 `admin`/`password`）。您必須在裝置首次啟動時，強制使用者設定一個唯一的、強式的新密碼。
* [cite_start]**實體安全也是您的責任：** 「存取控制」不只是指網路。指南明確提到「實體存取」 [cite: 281, 285][cite_start]。在您的最終產品上，是否還暴露著 JTAG、UART 等偵錯埠？ [cite: 285] 攻擊者只要能拿到裝置並接上這些埠，就可能完全繞過您的軟體防護。在量產時，這些埠必須被停用或以安全方式保護。
* [cite_start]**MFA 不是「可有可無」：** 對於「具影響力的遠端操作」（例如更新韌體、更改管理員密碼、開鎖等關鍵指令），指南要求「強制使用 MFA」 [cite: 284]。這不只是輸入密碼，您可能需要搭配一個手機 App，要求使用者做「第二次確認」（例如推播通知點選「核准」）。
* [cite_start]**密碼強度不是「建議」，是「規範」：** 您不能只是「建議」使用者使用強密碼，您必須「強制」執行 [cite: 283]。您的系統必須拒收弱密碼。指南要求您參照 7.2.1 節的具體規範（我們稍後會看到，例如長度和字元組合）。

---

### 6.4.2 Provide audit trails [1] (提供稽核軌跡 [1])

#### 📝 原文翻譯

[cite_start]即使有適當的存取控制措施，故意的濫用、繞過限制和錯誤配置仍然是潛在的風險 [cite: 286, 287][cite_start]。因此，擁有稽核軌跡非常重要 [cite: 287]。

[cite_start]**建議：** 應適當監控和記錄所有存取敏感資料和更改系統資源的嘗試 [cite: 294]。

#### 👨‍💻 開發人員重點提醒

* **什麼是稽核軌跡 (Audit Trails)？** 對裝置開發人員來說，這就是「日誌 (Logging)」。
* **為何要記錄日誌？** 這是「問責性」原則的核心。如果沒有日誌，裝置（或系統）被入侵或發生故障後，您將無法追查「發生了什麼」、「何時發生」以及「是誰（或哪個元件）做的」。
* [cite_start]**您必須記錄的內容：** 指南明確指出您必須記錄「所有存取敏感資料」和「更改系統資源」的**嘗試** [cite: 294]。這包括：
    * **成功的**登入。
    * **失敗的**登入嘗試（這對於發現駭客的暴力破解攻擊至關重要）。
    * 系統設定的重大更改（例如：更改管理員密碼、更改網路設定）。
    * 關鍵操作（例如：遠端開鎖、更新韌體）。
* **「嘗試」是關鍵字：** 不只記錄成功的操作，失敗的「嘗試」往往更有價值，因為它們是潛在攻擊的訊號。
* **資源考量：** IoT 裝置的儲存空間和運算能力通常很有限。您不能毫無節制地記錄所有日誌。您需要與系統架構師和客戶（用戶）協商，定義出哪些是「關鍵事件」，並確保這些事件的日誌能被安全地儲存或即時傳輸到後台日誌伺服器。

---

### 6.5 Principle 4: Resiliency (原則 4：韌性)

### 6.5.1 Guard against resource exhaustion [2] (防範資源耗盡 [2])

#### 📝 原文翻譯

[cite_start]IoT 系統容易受到資源耗盡攻擊 [cite: 297][cite_start]。攻擊者和被入侵的裝置可以持續向 IoT 裝置/網路/系統發送請求，以耗盡其資源並影響系統的可用性 [cite: 297]。

[cite_start]**建議：** 系統應採用機制來防禦惡意攻擊，例如 DDoS [cite: 298]。範例包括：
* [cite_start]監控系統/裝置資源足以維持服務 [cite: 299]。
* [cite_start]偵測資源耗盡以便及早介入 [cite: 300]。
* [cite_start]對資源密集型軟體進行特定控制 [cite: 301]。
* [cite_start]在 IoT 裝置上實施功耗閾值 [cite: 302]。
* [cite_start]限制並發會話 (concurrent sessions) 的數量 [cite: 303]。
* [cite_start]以剩餘容量 (excess capacity) 運行 [cite: 304]。

#### 👨‍💻 開發人員重點提醒

* [cite_start]**您的裝置也會被 DDoS：** 不要以為 DDoS 只是雲端伺服器要擔心的事。對您的裝置而言，攻擊者可能透過網路（例如不斷嘗試建立 TCP 連線）或無線方式（例如不斷發送藍牙連線請求）來轟炸您的裝置 [cite: 297]。
* **「韌性」代表「被打倒還能站起來」：** 您的裝置不能在面對這類攻擊時就當機或耗盡電力。您必須在軟體中建立防護機制。
* **您必須實作的防禦：**
    1.  [cite_start]**限制連線數 [cite: 303]：** 這是最重要的一點。您的裝置（例如 Web 伺服器或藍牙服務）能同時處理多少個連線？您必須在程式碼中設定一個**硬性上限**（例如：最多 3 個 TCP 連線）。當達到上限時，直接拒絕新的請求，而不是試圖處理它們直到記憶體耗盡。
    2.  [cite_start]**自我資源監控 [cite: 299]：** 您的程式（例如在 FreeRTOS 中）應該能監控自己的關鍵資源，像是「還剩下多少 Heap 記憶體？」、「CPU 負載是否過高？」。
    3.  [cite_start]**提早介入 [cite: 300]：** 當您偵測到資源（例如記憶體）即將耗盡時，不能坐以待斃。您必須採取行動，例如：主動拒絕新的連線、重新啟動網路模組，或進行一次安全的重開機 (safe reboot)。
    4.  [cite_start]**控制耗電 [cite: 302]：** 對於電池供電的裝置，攻擊者可能會故意保持網路連線，讓您的無線電模組 (Radio) 持續高功率運作以耗盡電力。您應設計超時機制，主動切斷閒置過久的連線。
    5.  [cite_start]**不要塞滿資源 [cite: 304]：** 在您選擇 MCU 或撰寫程式時，不要讓裝置在「正常運作」時就用掉 95% 的 RAM 或 CPU。您必須預留「剩餘容量」（Headroom），才能應對這種突發的攻擊流量。

---

### 7.1 Introduction (簡介)

#### 📝 原文翻譯

[cite_start]第 7 節為 IoT 用戶和 IoT 供應商在營運階段提供了一套基線安全建議 [cite: 309]。

[cite_start]這些建議是根據第 6 節中使用的相同的四個基本 IoT 安全設計原則來組織的 [cite: 310]。

[cite_start]雖然本文件提供的基線建議適用於大多數 IoT 系統，但 IoT 用戶和 IoT 供應商仍需要根據業務需求和相關法規要求，來決定這些建議對其預期系統/解決方案的適當性 [cite: 311]。

#### 👨‍💻 開發人員重點提醒

* **您的角色轉變：** 雖然本節主要針對「用戶」和「供應商」（營運方），但您（開發人員）開發的功能是**實現**這些營運建議的基礎。
* **思考「部署後」的世界：** 您的工作不只在「實作階段」結束。您在實作階段（第 6 節）所做的設計，將直接決定營運階段（第 7 節）是否能順利執行。
* **為營運方提供工具：** 營運方需要工具來管理裝置。例如，當 7.2.1 節要求「使用強密碼」時，您必須在實作階段就提供強制更改密碼和密碼強度驗證的**介面**。
* **持續的責任：** 營運階段的很多建議（如 7.4.1 的韌體更新）都需要您（原始開發商）持續提供支援（例如發布修補程式）。您必須從一開始就建立好這種支援機制。

---

### 7.2 Principle 1: Secure by defaults (原則 1：預設安全)

（此為原則標題，本身無內文）

### 7.2.1 Use strong credentials [2], [5] (使用強式憑證 [2], [5])

#### 📝 原文翻譯

[cite_start]弱憑證（例如，使用者識別碼和密碼）一直是首要的漏洞，容易受到暴力破解攻擊 [cite: 315]。

[cite_start]**建議：** 應避免使用預設憑證，且整個系統都應使用強密碼 [cite: 316][cite_start]。如果沒有法規要求，密碼的複雜性（強度）應遵循已發布的國際最佳實踐 [cite: 317][cite_start]。密碼應**最少**包含 8 個或更多字元，由字母和數字組成 [cite: 318][cite_start]。同時也鼓勵使用符號和大寫字元以增強密碼強度 [cite: 319]。

[cite_start]對於存取具影響力的資料和操作，應盡可能啟用多因子驗證 [cite: 320]。

#### 👨‍💻 開發人員重點提醒

* **這是「營運」階段，但根源在「實作」：** 這是營運階段的第一個建議，再次強調了「預設憑證」的危害。這意味著您在實作階段（第 6 節）的工作至關重要。
* **您的「實作」責任：**
    1.  [cite_start]**強制更改：** 您必須在實作階段就設計好「強制首次登入修改密碼」的流程 [cite: 316]。
    2.  [cite_start]**強制強度：** 您的系統**不能**接受弱密碼。您必須實作一個密碼驗證器，嚴格執行指南的「最低要求」：**8 個字元 + 字母 + 數字** [cite: 318]。
    3.  [cite_start]**提供更好選項：** 您應該「鼓勵」使用者加入符號和大小寫，例如在設定密碼的介面上提供強度提示 [cite: 319]。
* [cite_start]**MFA 支援：** 營運方（供應商）無法「啟用」MFA，如果您（開發人員）一開始就沒有開發這個功能的話。您必須在實作階段就把 MFA 功能（無論是 TOTP、簡訊驗證或推播）建置到您的裝置、App 和後台系統中 [cite: 320]。

---

### 7.3 Principle 2: Rigour in defence (原則 2：嚴謹防禦)

（此為原則標題，本身無內文）

### 7.3.1 Segment IoT and enterprise networks [2], [5] (分割 IoT 與企業網路 [2], [5])

#### 📝 原文翻譯

[cite_start]一個被入侵的裝置就可能成為入侵您企業系統的攻擊媒介 [cite: 324]。

[cite_start]**建議：** 應採用網路分段 (Network segmentation)，以便將屬於不同網路的 IoT 裝置彼此適當隔離，並與其他企業系統和網路隔離 [cite: 327][cite_start]。應盡可能實施防火牆和惡意軟體緩解方案來保護每個網路 [cite: 328]。

#### 👨‍💻 開發人員重點提醒

* **您的裝置被視為「高風險」：** 這是營運方的思維。在企業IT管理員眼中，您的 IoT 裝置（以及所有 IoT 裝置）都是「不被信任的」。他們最大的恐懼是，萬一您的裝置被駭，攻擊者就會以此為跳板，滲透到他們儲存核心資料（如財報、客戶資料）的「企業內網」。
* **您的設計決定了「隔離」的可行性：** 雖然執行「網路分段」（例如使用 VLAN 或防火牆）是IT管理員的工作，但您的**裝置設計**會直接影響他們能否成功。
* **您在實作階段必須考慮：**
    1.  **明確告知通訊需求：** 您的裝置需要存取哪些伺服器位址 (IP/Domain)？使用哪些通訊埠 (Ports) 和協定 (TCP/UDP)？您必須在技術文件中寫得一清二楚。IT管理員需要這些資訊來設定防火牆，只允許您的裝置「最小必要」的通訊。
    2.  **避免「廣播」或「內網探索」：** 盡量不要讓您的裝置依賴 mDNS、UPnP 或其他需要在整個區域網路 (LAN) 上廣播/探索服務的功能。在被嚴格分段的網路中，這些功能通常會失效。
    3.  **假定網路不友善：** 您的裝置必須能在一個被高度限制的網路環境中存活，例如它可能無法存取內網的其他裝置，也無法存取 NTP 伺服器（除非您明確指定）。
* **最終目標：** 您的設計必須讓 IT 管理員能輕鬆地把您的裝置「關進籠子裡」（一個獨立的 IoT 網段），確保就算裝置被駭，災情也能被控制在那個小網段內，不會擴散到主企業網路。

---

### 7.4 Principle 3: Accountability (原則 3：問責性)

### 7.4.1 Establish proper device management [5] (建立適當的裝置管理 [5])

#### 📝 原文翻譯

[cite_start]所有連網的裝置都可能暴露在惡意行為者面前 [cite: 331][cite_start]，並可能被利用，從而使網路攻擊者得以入侵整個 IoT 系統 [cite: 331][cite_start]。被盜的裝置可能被篡改、逆向工程，並被用來對付 IoT 系統 [cite: 332][cite_start]。過時和未修補的韌體/軟體可能包含已知漏洞，惡意行為者可以利用這些漏洞 [cite: 333][cite_start]。因此，對連網裝置的適當管理對於確保整個系統的安全至關重要 [cite: 334]。

[cite_start]**建議：** 應建立適當的裝置管理，包括韌體/軟體更新和修補 [cite: 335][cite_start]。應在整個「營運」生命週期階段保持一份連網裝置、軟體和韌體版本的清單，並套用最新的修補程式 [cite: 336][cite_start]。應嚴格執行存取控制，包括對 IoT 裝置的實體存取 [cite: 337][cite_start]。IoT 用戶和 IoT 供應商應酌情訂閱 IMDA 的 ISG-CERT 和新加坡網路安全局 (CSA) 的 SINGCERT 發布的通知和建議，以隨時了解新發現的 IoT 和 ICT 系統漏洞與威脅 [cite: 338]。

#### 👨‍💻 開發人員重點提醒

* [cite_start]**您是「安全更新」的唯一來源：** 這是營運階段最關鍵、也最能體現開發人員責任的一點。指南明確指出「過時和未修補的韌體」是重大威脅 [cite: 333]。
* **您在實作階段必須建置：**
    1.  [cite_start]**安全的 OTA (Over-The-Air) 更新機制：** 這是**必須**的功能，不是選配。營運方無法「套用修補程式」[cite: 336]，如果您（開發人員）沒有在實作階段打造一個安全、可靠、能驗證韌體簽章的 OTA 系統。
    2.  [cite_start]**版本回報機制：** 營運方如何「保持一份清單」[cite: 336]？您的裝置必須能在每次連線時，主動向後台回報自己目前的型號、硬體版本、韌體版本和軟體版本。
* [cite_start]**物理防護的再提醒：** 指南再次強調「實體存取」[cite: 337]。這呼應了 6.4.1 節的提醒，您在設計硬體時，必須移除或保護好偵錯埠。
* [cite_start]**您是漏洞修補的執行者：** 當 SINGCERT 發布新的漏洞警示時 [cite: 338]（例如，您使用的某個開源 TCP/IP 堆疊有漏洞），營運方只能「通知」您。您（開發人員）是唯一能修補這個漏洞、編譯新韌體、並透過 OTA 系統推送更新的人。您必須為這種「長期抗戰」做好準備。

---

### 7.5 Principle 4: Resilience (原則 4：韌性)

### 7.5.1 Recover from attacks [5] (從攻擊中恢復 [5])

#### 📝 原文翻譯

[cite_start]IoT 系統將會成為攻擊目標，尤其是當資產足夠有價值時 [cite: 343][cite_start]。隨著更精密的攻擊工具被開發出來，有決心的攻擊者總會找到方法入侵系統 [cite: 344][cite_start]。因此，有必要準備好安全地(fail safely)應對故障並從中恢復，尤其是當 IoT 系統的入侵會影響到人員或設施的安全時 [cite: 345]。

[cite_start]**建議：** 應定期進行系統資料（包含設定）的備份，以及系統的定期災難恢復演練 [cite: 346]。

#### 👨‍💻 開發人員重點提醒

* **您必須假設「裝置會被駭」：** 這是「韌性」原則的精髓。這不是問「會不會」被駭，而是問「被駭之後怎麼辦」。
* **您的「實作」責任：** 雖然「備份」和「災難恢復」聽起來主要是營運方 (IT) 的工作，但您的裝置必須提供**支援**這些工作的功能：
    1.  [cite_start]**安全的「恢復原廠設定」：** 這是您（開發人員）最重要的任務。您必須提供一個可靠且（最好是）實體的機制，讓裝置在被入侵後，能被重置 (reset) 回它出廠時的、已知的、安全的韌體狀態 [cite: 346]。
    2.  [cite_start]**支援「設定備份」：** 您的裝置或後台系統，是否允許營運方匯出(備份)該裝置的所有關鍵設定（例如網路配置、使用者清單等）？ [cite: 346] 如果裝置需要更換或重置，這將是恢復服務的關鍵。
    3.  [cite_start]**「安全地故障」(Fail Safely)：** 指南特別提到這點 [cite: 345]。如果您的裝置是（例如）智慧門鎖、瓦斯偵測器或醫療設備，當它偵測到自己被攻擊或處於異常狀態時，它**不能**只是當機。它的「預設故障模式」必須是**安全**的（例如：保持上鎖並發出警報、切斷瓦斯閥門），您必須在實作階段就定義好這個安全狀態。
    4.  [cite_start]**支援「重新部署」：** 您的裝置必須能支援「災難恢復演練」 [cite: 346]。這意味著它必須能被輕易地（在營運方驗證身份後）從系統中移除、重置、然後像新裝置一樣安全地重新註冊回系統中。

---

### 7.5.2 Conduct periodic assessments [7] (執行定期評估 [7])

#### 📝 原文翻譯

一個 IoT 系統可以是一個動態且複雜的系統。由於威脅總是在不斷演變，因此需要定期的滲透測試及/或漏洞評估來緩解安全風險。

**建議：** 應定期對 IoT 系統進行滲透測試及/或漏洞評估。威脅建模應作為漏洞評估的一部分來執行。

#### 👨‍💻 開發人員重點提醒

* **您是「被測試」的對象：** 營運方（用戶或供應商）會被要求「定期」找專業的白帽駭客（滲透測試團隊）來攻擊您的裝置和系統。
* **這不只是一次性的測試：** 即使您的裝置在「實作階段」通過了安全測試，也不代表一勞永逸。隨著新的攻擊手法（威脅）不斷演變，您在營運階段**必須**持續接受挑戰。
* **您的「實作」責任：**
    1.  **為測試做好準備：** 您（開發人員）必須有能力配合營運方進行這些評估。您可能需要提供測試裝置、技術文件、或建立一個專門的測試環境。
    2.  **修補漏洞的責任：** 當滲透測試團隊在「營運階段」發現您的裝置有新的漏洞時，您（開發人員）有責任修補它。這又回到了 7.4.1 節，您必須有能力開發修補程式，並透過 OTA 推送更新。
* **「威脅建模」是持續的：** 指南建議「威脅建模應作為漏洞評估的一部分」。這意味著，當營運方在評估時，他們會重新檢視您在實作階段（6.3.1 節）所做的威T脅建模，看看它是否仍然有效，或者是否出現了您當初沒有想到的新威脅。

---

### 8 Threat modelling checklist (威脅建模檢查表)

#### 📝 原文翻譯

[cite_start]本節提供了一份建議的威脅建模檢查表 [cite: 356][cite_start]。該檢查表可用於指導威脅建模過程，並確保其正確且系統地進行 [cite: 356]。

[cite_start]雖然 STRIDE（ Spoofing 欺騙, Tampering 篡改, Repudiation 否認, Information disclosure 資訊洩露, Denial of service 阻斷服務, Elevation of privilege 權限提升）是用於協助分析和發現系統威脅的模型 [cite: 357][cite_start]，但也應注意，還存在其他方法，並且它們可能更適合特定的使用案例 [cite: 358]。

[cite_start]請參閱附錄 B 中的案例研究，以了解威脅建模檢查表的應用範例 [cite: 359]。

#### 👨‍💻 開發人員重點提醒

* [cite_start]**這是一份「必做清單」：** 繼 6.3.1 節建議您「執行威脅建模」之後，本節直接給了您一份「怎麼做」的檢查表 [cite: 356]。這不是一份可選的參考文件，而是您在實作階段初期的行動指南。
* [cite_start]**STRIDE 是您的起點：** 指南明確推薦了 STRIDE 模型 [cite: 357]。在您設計裝置時，您必須系統性地思考：
    * **Spoofing (欺騙)：** 駭客能冒充我的裝置嗎？能冒充我的合法用戶或雲端伺服器吗？
    * **Tampering (篡改)：** 駭客能竄改我的韌體、儲存的資料，或傳輸中的命令嗎？
    * **Repudiation (否認)：** 駭客（或惡意用戶）能否在執行惡意操作（例如開鎖）後，否認是他們做的？（這呼應了 6.4.2 的稽核軌跡）。
    * **Information disclosure (資訊洩露)：** 駭客能竊取到金鑰、密碼、用戶隱私數據嗎？
    * **Denial of service (阻斷服務)：** 駭客能讓我的裝置當機、斷線或耗盡電力嗎？（這呼應了 6.5.1）。
    * **Elevation of privilege (權限提升)：** 駭客能否從一個普通用戶權限，提升為管理員權限？
* [cite_start]**工具不是唯一的：** 指南也提醒您，STRIDE 並非唯一解方 [cite: 358]。重點是您必須有一個「系統化」的流程來找出威脅，而不是隨意猜測。

---

### ID 1: Identify the potential target(s) to be protected (識別要保護的潛在目標)

#### 📝 原文翻譯 (來源 360)

"1. 識別要保護的潛在目標
    [cite_start]a. 定義其邊界以及需要與之互動的外部系統（包括使用者）[cite: 360]
    b. [cite_start]將目標分解為其子元件 [cite: 360]
    c. [cite_start]識別目標內部的資料流，以及來自外部系統的輸入和輸出 [cite: 360]
    d. [cite_start]識別敏感資料及其處理位置（靜態、傳輸中、使用中）[cite: 360]
    e. [cite_start]針對子元件和資料流，識別其安全需求（基於對機密性、完整性、可用性 (CIA 三元組) 的潛在衝擊）[cite: 360]
    f. [cite_start]識別正在使用的硬體、軟體和協定 [cite: 360]"

#### 👨‍💻 開發人員重點提醒

* **這一步是「畫地圖」：** 在您開始「防禦」之前，您必須先清楚知道您到底在「保護什麼」。ID 1 就是在要求您把整個系統的架構圖、資料流向圖畫出來。
* **您的重點工作：**
    * [cite_start]**(a, b) 拆解您的系統：** 您的「目標」（例如，您的 IoT 裝置）是由哪些「子元件」組成的？[cite: 360] 例如：
        * MCU
        * Wi-Fi 模組
        * 安全晶片 (Secure Element)
        * 感測器
        * JTAG/UART 埠
        * 裝置上的 Web 伺服器
        * MQTT 客戶端
    * [cite_start]**(c, d) 追蹤「敏感資料」的流向：** 這是最關鍵的一步。您必須像偵探一樣追蹤「敏感資料」（例如金鑰、密碼、韌體、用戶 PII）[cite: 360]。
        * [cite_start]**它在哪裡？** * **靜態 (at rest)：** 它儲存在 Flash 的哪個位置？是否加密？[cite: 360]
        * [cite_start]**傳輸中 (in transit)：** 它如何透過 Wi-Fi 傳到雲端？用什麼協定？是否用了 TLS？[cite: 360]
        * [cite_start]**使用中 (in use)：** 它載入到 RAM 中處理時，是否能被偵錯器讀取？[cite: 360]
    * [cite_start]**(e) 定義「安全需求」(CIA)：** 您要開始思考，如果這些資料流或元件出事了，會有多嚴重？[cite: 360]
        * **機密性 (C)：** 如果韌體被駭客**讀取**(洩露)了，嚴重嗎？
        * **完整性 (I)：** 如果韌體在傳輸中被駭客**竄改**(篡改)了，嚴重嗎？（絕對嚴重！）
        * **可用性 (A)：** 如果裝置被 DDoS 導致**無法連線**(阻斷服務)，嚴重嗎？
    * [cite_start]**(f) 列出您的「技術債」：** 清楚列出您用了哪些硬體晶片、作業系統 (RTOS)、第三方函式庫（例如 TCP/IP 堆疊、MQTT 函式庫）和通訊協定 [cite: 360]。這份清單（也稱為軟體物料清單, SBOM）在未來爆發漏洞時至關重要。

---

### ID 2: Define the security problem (定義安全問題)

#### 📝 原文翻譯 (來源 360)

"2. 定義安全問題
    a. 識別系統可存取性 (system accessibility)
        * 識別攻擊面
        * 決定操作環境
        * 決定系統 / 裝置生命週期和供應鏈
    b. 識別系統易受攻擊性 (system susceptibility) (又稱漏洞 vulnerabilities)
        * 決定已知漏洞
        * 列舉攻擊面的威脅（使用 STRIDE 作為指引）
        * 列舉操作環境的威脅（使用 STRIDE 作為指引）
        * 列舉系統 / 裝置生命週期和供應鏈各階段的威脅（使用 STRIDE 作為指引）
    c. 陳述任何假設"

#### 👨‍💻 開發人員重點提醒

* **這一步是「找出弱點」：** 在 ID 1 畫完地圖後，ID 2 要求您開始在這張地圖上標示出所有「危險區域」和「潛在的入侵路徑」。
* **您的重點工作：**
    * **(a) 識別攻擊面：** 這是最直接的工作。您必須列出**所有**攻擊者可能接觸到您裝置的「點」。例如：
        * **實體：** USB 埠、JTAG/UART 偵錯埠、外露的 Flash 晶片。
        * **無線電：** Wi-Fi、藍牙、Zigbee。
        * **網路：** 裝置上運行的 Web 伺服器、開啟的 TCP/UDP 埠。
        * **後台：** 雲端 API、手機 App。
    * **(a) 考慮「環境」和「生命週期」：**
        * **操作環境：** 裝置是安裝在「安全的」用戶家中，還是「不安全的」公共場所電線桿上？後者面臨的**實體攻擊**威脅天差地遠。
        * **生命週期/供應鏈：** 您的裝置在「生產製造」過程中是否安全？（例如，金鑰是否在工廠就被灌錄好？工廠是否可能洩漏您的金鑰？）裝置在「報廢」時如何處理？（這呼應了後續 10. CK-LP-10 的資料清除）。
    * [cite_start]**(b) 使用 STRIDE 掃描弱點：** 針對您剛找出的**每一個**攻擊面、**每一種**操作環境、**每一個**生命週期階段，您都要用 STRIDE 模型（欺騙、篡改、否認、資訊洩露、阻斷服務、權限提升）去掃描一遍，找出可能的威脅 [cite: 360, 357]。
        * **範例：**
            * 攻擊面 (JTAG 埠) + STRIDE (資訊洩露) = 威脅 (攻擊者可透過 JTAG 讀取記憶體，竊取金鑰)。
            * 操作環境 (公共場所) + STRIDE (篡改) = 威脅 (攻擊者可偷走裝置，竄改韌體後再裝回去)。
    * **(c) 坦誠您的「假設」：** 這是常被忽略但很關鍵的一步。您必須寫下您的安全設計是基於哪些「假設」。例如：「我們假設用戶的 Wi-Fi 密碼是安全的」、「我們假設雲端伺服器不會被駭」。一旦這些假設被推翻，您的安全設計可能就失效了。

---

### ID 3: Conduct risk assessment (執行風險評估)

#### 📝 原文翻譯 (來源 360)

"3. 執行風險評估
    * 評估威脅和漏洞對 CIA 三元組的衝擊，並與資產的安全需求進行匹配
    * 評估實現威脅所需的攻擊者能力
    * 評估風險發生的可能性
    * 對風險進行優先級排序以進行緩解，包括其他考量（例如金錢、安全、社會和易用性衝擊）"

#### 👨‍💻 開發人員重點提醒

* **這一步是「決定哪些火先救」：** 在 ID 2 中，您找出了一大堆潛在的威脅和弱點。但您的開發時間和成本是有限的，您不可能修復「所有」問題。ID 3 的目的就是幫您「排定優先級」。
* **您的重點工作（如何排序）：**
    1.  **評估「衝擊」(Impact)：** 這是最重要的。如果這個威脅真的發生了，後果有多嚴重？（這呼應了 ID 1e 的 CIA 評估）。
        * **高衝擊：** 遠端竊取金鑰、執行任意程式碼（RCE）、刷入惡意韌體。
        * **低衝擊：** 讓裝置 LED 燈號閃爍異常。
    2.  **評估「可能性」(Likelihood) & 「能力」(Capability)：** 這個威脅「多容易」被利用？
        * **高可能性：** 攻擊者只需在網路上掃描，就能利用的「預設密碼」漏洞。
        * **低可能性：** 攻擊者需要價值數百萬的實驗室設備、電子顯微鏡，並花費數個月才能解密的晶片級攻擊。
    3.  **排出優先級：** 您將使用一個矩陣來決定風險等級：
        * **（高衝擊 x 高可能性）= 優先級最高（必須立即修復）**
        * （高衝擊 x 低可能性）= 優先級中（應修復，但需考量成本）
        * （低衝擊 x 高可能性）= 優先級中/低（例如，阻斷服務）
        * （低衝擊 x 低可能性）= 優先級最低（可接受或忽略）
    4.  **考量「現實因素」：** 指南特別提醒您要考量「易用性衝擊」。例如，一個「超級安全」但「超級難用」的功能（例如每次開燈都要 MFA），用戶根本不會用，這反而會產生新的風險（用戶會想辦法繞過它）。您必須在安全性和易用性之間找到平衡點。

---

好的，我們接著處理威脅建模檢查表的第四個步驟。

---

### ID 4: Determine the security objectives (決定安全目標)

#### 📝 原文翻譯 (來源 360)

"4. 決定安全目標
    * 陳述安全目標。例如，OT（營運技術）系統強調安全 (safety)，其中系統完整性 (integrity) 優先於資料機密性 (confidentiality)"

#### 👨‍💻 開發人員重點提醒

* **這一步是「設定防禦的『為什麼』」：** 在 ID 3 中，您排定了風險的優先級。現在，ID 4 要求您根據這些風險，明確定義出您「到底要達成什麼樣的安全目標」。
* **您的重點工作：**
    * **陳述您的「安全宣言」：** 您的安全目標必須清晰明確。它將指導您在 ID 5 和 ID 6 中做出具體的設計決策。
    * **範例的啟示（OT vs. IT）：** 指南給了一個非常關鍵的 OT（營運技術）範例，這對 IoT 開發人員極具啟發性：
        * **IT 系統**（例如電子商務）通常最關心「機密性」(C)：不惜一切代價防止客戶資料外洩。
        * **OT 系統**（例如工廠、電力、醫療設備）則最關心「完整性」(I) 和「可用性」(A)，以及「人身安全」(Safety)。
    * **問自己：我的 IoT 裝置比較像 IT 還是 OT？**
        * 如果您的裝置是「智慧門鎖」：
            * **完整性**（命令不被竄改）和**可用性**（主人想開門時必須能開）絕對優先於**機密性**（「開鎖日誌」被竊取雖然不好，但遠不如「主人被關在門外」或「駭客能開鎖」嚴重）。
            * 您的安全目標就可能是：「*確保任何情況下，只有合法用戶能操作門鎖，且裝置必須能即時響應合法命令。*」
        * 如果您的裝置是「個人健康手環」：
            * **機密性**（用戶心率、睡眠數據）和**完整性**（數據不被竄改）就可能並駕齊驅，優先級非常高。
            * 您的安全目標可能是：「*確保用戶的健康數據在傳輸和儲存時都受到加密保護，防止洩露，並確保數據的準確性不被竄改。*」
* **目標指引取捨：** 當您在「安全性」和「易用性」之間掙扎時（ID 3 提過的），您設定的「安全目標」（ID 4）就是您做出最終決策的最高指導原則。

---

### ID 5: Define the security requirements (定義安全需求)

#### 📝 原文翻譯 (來源 363)

"5. 定義安全需求
    * 陳述為達成已識別的安全目標所必需的需求，無需深入探討其具體實作"

#### 👨‍💻 開發人員重點提醒

* **這一步是「把『目標』變成『規格』」：** 這是威脅建模中至關重要的一步，您將把 ID 4 中設定的「高階目標」（Why）轉換為 ID 5 的「具體需求」（What）。
* **重點是「What」，不是「How」：** 這一階段，您先不關心「如何實作」。您只關心「必須做到什麼」。
    * **（❌ 錯誤的 - "How"）：** "我們將使用 `mbedtls_aes_cmac` 搭配 `ESP32-WROOM-32` 的硬體加速器來實作..."
    * **（✔️ 正確的 - "What"）：** "系統**應**能驗證韌體更新包的真實性與完整性，在安裝前拒絕任何被篡改的韌體。"
* **您的重點工作：**
    * **將「目標」轉譯為「需求」：**
        * **ID 4 的目標（智慧門鎖）：** "確保只有合法用戶能操作門鎖。"
        * **ID 5 的需求（規格）：**
            * "系統**應**在接受任何開/關鎖命令前，對手機 App 和門鎖進行雙向身份驗證。"
            * "所有開/關鎖命令**應**受保護，能抵禦篡改和重放攻擊 (replay attacks)。"
            * "系統**應**拒絕來自未經驗證來源的韌體更新。"
    * **來自「風險」的需求：** 您的需求也直接對應您在 ID 3 中排定「高優先級」的風險。
        * **ID 3 的風險：** "攻擊者可透過 JTAG 讀取金鑰。"
        * **ID 5 的需求：** "在量產裝置上，JTAG 存取**應**被永久禁用。"
* **可測試性：** 您在這裡寫下的每一條「需求」，都應該是具體、明確、且「可被測試」的。這份清單（Security Requirements）將成為您的 QA 團隊在 ID 7（驗證）時的測試依據。

---

### ID 6: Design and implement the capabilities (設計並實作能力)

#### 📝 原文翻譯 (來源 363)

"6. 設計並實作能力"

#### 👨‍💻 開發人員重點提醒

* **這一步就是「開始動工」 (Coding & Engineering)：** 這可能是整份檢查表中原文最簡短、但您實際工作量最大的一步。
* **您的重點工作：**
    * **「實作」 (Implement)：** 您現在要開始真正撰寫程式碼、設計電路板、選擇晶片，去**實現**您在 ID 5 中定義的「所有安全需求」。
    * **「設計」 (Design)：** 這是「How」的階段。
        * **ID 5 的需求 (What)：** "系統**應**能驗證韌體更新包的真實性與完整性..."
        * **ID 6 的設計 (How)：** "我們將使用 `ed25519` 演算法進行數位簽章。私鑰儲存在安全的 CI/CD 伺服器，公鑰硬編碼 (hard-coded) 在裝置的 Bootloader 中。Bootloader 在刷入新韌體前，必須先用此公鑰驗證韌體簽章，驗證失敗則拒絕更新。"
    * **遵循安全準則：** 在實作的過程中，您必須遵循所有相關的安全開發準則（例如：安全的程式碼編寫實務，防範緩衝區溢位、使用經過驗證的加密庫而非自己實作）。
* **串聯前面所有工作：**
    * 您的實作必須能緩解 ID 3 中排定高優先級的風險。
    * 您的實作必須能達成 ID 4 中設定的安全目標。
    * 您的實作必須**完全滿足** ID 5 中定義的每一條安全需求。

---

### ID 7: Validate and verify that the capabilities address the security requirements adequately (驗證並核實能力是否充分滿足安全需求)

#### 📝 原文翻譯 (來源 363)

"7. 驗證並核實能力是否充分滿足安全需求"

#### 👨‍💻 開發人員重點提醒

* **這一步是「最終驗收」：** 您在 ID 6 中實作了所有功能，現在 ID 7 要求您回頭去「證明」您的實作確實滿足了 ID 5 中定義的「所有安全需求」。
* **「驗證 (Validate)」 vs. 「核實 (Verify)」：**
    * **核實 (Verify)：** 您是否「正確地」實作了功能？（例如：Bootloader 是否真的在檢查簽章？）
    * **驗證 (Validate)：** 您實作的功能是否「真正地」達成了安全目標？（例如：Bootloader 的簽章檢查是否*無法被繞過*？它是否能*真正地*抵禦駭客的篡改攻擊？）
* **您的重點工作：**
    1.  **測試，測試，再測試：** 這是 QA 和安全測試團隊的工作。他們會拿出您在 ID 5 中定義的「安全需求清單」，逐一設計測試案例。
    2.  **攻擊性測試 (PENTEST)：** 這不只是「功能測試」，而是「安全測試」。
        * **ID 5 需求：** "JTAG 存取**應**被永久禁用。"
        * **ID 7 測試：** 測試人員會*嘗試*用各種手段（例如電壓 glitching）重新啟用 JTAG。如果他們成功了，就代表您的 ID 6 實作「未充分滿足」ID 5 的需求。
    3.  **回溯威脅：** 測試團隊也會回頭看 ID 3 的「高風險威脅」。
        * **ID 3 風險：** "攻擊者可透過 Wi-Fi 暴力破解密碼。"
        * **ID 7 測試：** 測試人員會*真的*執行暴力破解攻擊，來驗證您的防護機制（例如 6.5.1 提到的限制連線數、6.4.1 提到的登入延遲）是否有效。
* **威脅建模是一個循環：** 如果您在 ID 7 驗證失敗了（例如，測試人員繞過了您的防禦），您就必須退回到 ID 3 (重新評估風險)、ID 5 (修改需求) 和 ID 6 (重新設計實作)，然後再回來 ID 7 重新驗證。

---

### 9 Vendor disclosure checklist (供應商揭露檢查表)

#### 📝 原文翻譯 (來源 366-372)

[cite_start]本節提供了一份非詳盡的安全問題清單，企業解決方案供應商可將其用於自我揭露 [cite: 367][cite_start]。它識別了供應商應關注的可能的重要安全能力/服務，同時也讓用戶能更好地評估和比較不同供應商所提出的 IoT 解決方案/系統的安全方面 [cite: 368][cite_start]。因此，這份檢查表有助於溝通、實現 IoT 解決方案間安全性的公平比較，並促進實施更好的安全性 [cite: 369]。

[cite_start]儘管檢查表有上述用途，但應注意的是，該檢查表僅為常見安全考量的模板 [cite: 370][cite_start]。用戶需要根據其用途和業務需求，來決定檢查表項目的適當性和適用性，以便對其進行增加、刪除及/或調整 [cite: 371]。

[cite_start]請參閱附錄 B 中的案例研究，以了解供應商揭露檢查表的應用範例 [cite: 372]。

#### 👨‍💻 開發人員重點提醒

* **這是您的「安全履歷」：** 這份檢查表是您的客戶（企業用戶）在採購時，會拿來「面試」您的表格。您（作為供應商/開發人員）如何回答這些問題，將直接決定您是否能贏得標案。
* **「自我揭露」的壓力：** 您必須主動、誠實地揭露您的裝置具備哪些安全能力。如果您對很多項目都回答「N」(No) 或「NA」(Not applicable)，您的產品競爭力將會很低。
* **您的「開發指南」：** 您可以反過來利用這份清單。在您開始「實作階段」時（第 6 節），就應該把這份檢查表當作您的「開發規格書」。您的目標應該是讓您的產品在未來能對這裡的每一個問題都回答「Y」(Yes)。
* **不是模板，是基準：** 雖然指南說這只是「模板」，但它實際上為企業用戶設定了一個評估「及格線」的基準。您的產品必須以滿足這些項目為目標。

---

### 1. Cryptographic support (密碼學支援)

#### 📝 原文翻譯 (來源 373)

"**ID: CK-CS-01**
[cite_start]您的裝置和系統是否適當地利用了業界公認的密碼學技術和最佳實踐？[cite: 373]
最佳實踐的範例包括：
* [cite_start]使用經批准的演算法及其正確的實作和應用 [cite: 373]
* [cite_start]足夠的金鑰長度 [cite: 373]
* [cite_start]使用經批准的隨機數生成器 [cite: 373]
* [cite_start]建議的密碼學週期 [cite: 373]
* [cite_start]建議的熵源 [cite: 373]
* [cite_start]使用可更新的密碼學 [cite: 373]"

"**ID: CK-CS-02**
[cite_start]您是否採用了適當的金鑰管理（生成、交換、儲存、使用、銷毀、替換等）技術？[cite: 373]"

#### 👨‍💻 開發人員重點提醒

* [cite_start]**這是對第 6.2.1 節的直接驗收：** 客戶在問的 **CK-CS-01**，幾乎逐字逐句來自您在實作階段（第 6.2.1 節）的基線建議。您是否有使用標準演算法？金鑰長度是否足夠？您是否有能力更新加密演算法？[cite: 245, 247-251]
* **您必須回答「Y」：** 如果您對 CK-CS-01 回答「N」，基本上等於承認您的產品不符合本指南的基線要求，這在企業採購中非常致命。
* **CK-CS-02 深入探討金鑰的「生命週期」：**
    * [cite_start]您的裝置如何**安全地生成**金鑰？（是否使用了好的隨機數生成器？）[cite: 373]
    * [cite_start]您的裝置如何**安全地儲存**金鑰？（是否用了 6.3.2 節提到的「信任根」？）[cite: 264, 373]
    * [cite_start]您的裝置如何**安全地更新/替換**金鑰？（例如憑證過期時）[cite: 373]
* **「支援」是最低要求：** 作為開發人員，您的工作就是確保您的裝置和系統具備**所有**這些能力，以便您在面對這份檢查表時，能自信地回答「Y」，並提供「Supporting materials」（支援材料）來證明您的說法（例如，您使用的加密庫、您的金鑰管理白皮書等）。

---

### 2. Security function protection (安全功能保護)

#### 📝 原文翻譯 (來源 373)

"**ID: CK-FP-01**
您是否建立了信任根 (Root-of-Trust)？"

"**ID: CK-FP-02**
您是否採用了安全啟動 (Secure Boot)？"

#### 👨‍💻 開發人員重點提醒

* [cite_start]**這是對第 6.3.2 節的直接驗收：** **CK-FP-01** 直接詢問您是否實作了 6.3.2 節的核心建議 [cite: 263][cite_start]。您是否使用了 TPM、Secure Element 或 MCU 內建的安全功能來保護金鑰？[cite: 266] 如果沒有，您將無法建立「信任鏈」。
* **CK-FP-02 (安全啟動) 是「信任鏈」的實踐：**
    * **什麼是安全啟動？** 這是信任根 (RoT) 的第一個、也是最重要的工作。當您的裝置一上電，RoT 會先啟動，並用它「安全儲存」的公鑰去**驗證**下一階段程式（例如 Bootloader）的**數位簽章**。
    * **為何重要？** 如果 Bootloader 被驗證是可信的，Bootloader 接著會去驗證主程式（您的韌體）的簽章。這個「一環驗一環」的過程就叫「信任鏈」。
    * [cite_start]**您的責任：** 如果您不實作安全啟動，攻擊者就能輕易地在您的裝置上刷入惡意韌體 [cite: 333]。能回答「Y」，代表您能向客戶證明，您的裝置**只會運行您（開發商）簽署過的可信程式碼**。
* **沒有 RoT 就沒有安全啟動：** 這兩項是綁定在一起的。您必須先有 CK-FP-01 (信任根) 才能實作出 CK-FP-02 (安全啟動)。這是您裝置抵禦韌體篡改的第一道防線。

---

### 3. Identification and authentication (身份識別與驗證)

#### 📝 原文翻譯 (來源 373)

"**ID: CK-IA-01**
您的客戶端（使用者、裝置、閘道器、應用程式）和伺服器是否採用了唯一的、不可修改的且可被驗證的身份？"

"**ID: CK-IA-02**
您是否採用了雙向驗證 (mutual authentication)？例如，在建立連線之前和預定的時間間隔之後。"

#### 👨‍💻 開發人員重點提醒

* **CK-IA-01 (裝置的「數位 DNA」)：**
    * 這是超越「密碼」的層級。客戶在問的是您的**裝置本身**是否有一個無法被複製的「身份」。
    * **唯一的 (Unique)：** 您的每台裝置在出廠時，是否都有一個獨一無二的 ID（例如，一個燒錄在晶片中的裝置憑證）？還是您所有的裝置都共用同一個 API 金鑰？（後者是致命錯誤）。
    * [cite_start]**不可修改的 (Non-modifiable)：** 這個「身份」是否儲存在安全的地方（例如 6.3.2 節的「信任根」）？ [cite: 263] 還是它只是一個儲存在 Flash 檔案系統中的設定檔（駭客可以輕易讀取並複製）？
    * **可被驗證的 (Verifiable)：** 雲端伺服器是否有辦法透過密碼學（例如，挑戰-回應機制）來「驗證」這個裝置真的是它所聲稱的那台裝置？
* **CK-IA-02 (雙向驗證，mTLS)：**
    * **這是在防範「中間人攻擊」(MITM)。**
    * **單向驗證**（標準 HTTPS）：**您的裝置** (Client) 會驗證**伺服器** (Server) 的身份（"你好，你是真的 Google 嗎？"）。
    * **雙向驗證 (Mutual Auth)**：不只如此，**伺服器**也會反過來驗證**您的裝置**的身份（"很好，我是真的 Google。那麼，你是我的合法裝置嗎？"）。
    * **您的責任：** 您必須實作「雙向 TLS」(mTLS)。您的裝置在連線時，必須出示它自己的「客戶端憑證」（這就是 CK-IA-01 提到的那個「唯一身份」），而您的伺服器必須設定為「只接受」持有合法憑證的裝置連線。

---

### 4. Network protection (網路保護)

#### 📝 原文翻譯 (來源 373, 377)

"**ID: CK-NP-01**
[cite_start]您是否實施了網路存取控制？ [cite: 373]
[cite_start]例如，確保加入新網路及/或允許遠端存取時需有明確的授權。 [cite: 373]"

"**ID: CK-NP-02**
[cite_start]您是否採用了經過驗證的傳輸協定，並正確啟動其安全控制？ [cite: 373]
範例包括：
* [cite_start]TCP 負載使用 TLS。 [cite: 373]
* [cite_start]UDP 負載使用 DTLS。 [cite: 373]"

"**ID: CK-NP-03**
[cite_start]您是否採用了業界最佳實踐來確保連線安全？ [cite: 373]
業界最佳實踐的範例：
* [cite_start]使用 VPN 或專線。 [cite: 373]
* [cite_start]當使用公共行動電信網路時，使用電信營運商的私有行動 APN。 [cite: 377]
* [cite_start]使用 DNS 綁定 (DNS pinning) 以防止 DNS 欺騙。 [cite: 377]
* [cite_start]基於類型、埠和目標進行流量過濾。 [cite: 377]
* [cite_start]使用憑證綁定 (Certificate pinning)。 [cite: 377]
* [cite_start]使用 MQTT 時採用 TLS。 [cite: 377]
* [cite_start]掃描開放的網路埠。 [cite: 377]
* [cite_start]使用白名單來建立或拒絕來自非信任來源的連線。此外，IETF RFC 8520 製造商使用描述 (MUD) 可以作為裝置向網路提供此資訊的標準機制。 [cite: 377]"

"**ID: CK-NP-04**
[cite_start]您是否將來自受信任端點的通訊通道與來自非受信任端點的通訊通道進行了隔離？ [cite: 377]
範例包括：
* [cite_start]使用 VLAN。 [cite: 377]
* [cite_start]使用防火牆建立 DMZ。 [cite: 377]
* [cite_start]使用單向安全閘道器。 [cite: 377]
* [cite_start]使用網路分段或微分段。 [cite: 377]
* [cite_start]實體隔離。 [cite: 377]"

#### 👨‍💻 開發人員重點提醒

* **這是對您「網路行為」的全面審查：** 客戶不僅關心您的裝置「說什麼」（資料），還關心它「如何說」以及「在哪裡說」（網路）。
* **CK-NP-01 (存取控制)：**
    * **加入網路：** 您的裝置是否支援 WPA2/WPA3 Enterprise 等安全的 Wi-Fi 驗證方式？還是只能用簡單的共享密碼？
    * [cite_start]**遠端存取：** 您的裝置是否預設開啟了 SSH、Telnet 或 Web 管理介面？如果是，它們的存取權限是否受到 6.4.1 節（強密碼、MFA）的嚴格保護？ [cite: 278, 281]
* **CK-NP-02 (加密通道)：**
    * [cite_start]這是對 6.3.3 節的再次驗收 [cite: 267][cite_start]。您**必須**為所有 TCP 和 UDP 通訊（包括 MQTT [cite: 377][cite_start]）加上 TLS/DTLS [cite: 373]。如果您回答「N」，代表您的裝置在網路上「裸奔」，這是不可接受的。
* **CK-NP-03 (最佳實踐)：**
    * 這份清單是「加分項」，也是高安全等級客戶（如企業、政府、醫療）的「必備項」。
    * **憑證/DNS 綁定 (Pinning)：** 這是防止中間人攻擊 (MITM) 的進階手段。您的裝置應內建伺服器憑證或公鑰的指紋，拒絕與任何「偽造的」伺服器通訊。
    * [cite_start]**MUD (製造商使用描述)：** 這是一個很重要的概念。您的裝置應有能力「主動告訴」企業防火牆（例如透過 MUD 檔案）：「我只會跟 `api.mycloud.com` 的 443 埠通訊，其他所有流量都是非法的」。這能極大協助 7.3.1 節的網路分段 [cite: 323]。
    * **掃描開放埠口：** 您的意思是，您（開發人員）在出廠前已經掃描並關閉了所有不必要的埠口。
* **CK-NP-04 (支援分段)：**
    * [cite_start]這呼應了 7.3.1 節（營運方的責任） [cite: 323]。客戶在問：您的系統**是否能配合**網路分段？
    * [cite_start]範例：如果您的系統包含一個閘道器 (Gateway) 和多個感測器 (Sensor)，您（開發人員）是否在閘道器上就主動使用了 VLAN，將感測器網路和企業網路隔離開來 [cite: 377]？
    * 您的設計應**最小化**對「區域網內互相通訊」的依賴，這能讓營運方的分段工作更簡單。

---

您是否同意以上的翻譯和提醒？如果同意，請確認，我將接著處理檢查表中的**類別 5** (Data protection)。