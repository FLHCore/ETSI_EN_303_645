Singapore IMDA Internet of Things (IoT) Cyber Security Guide 
===

### 1 Introduction (簡介)

#### 📝 原文翻譯 (來源 43-62)

 物聯網 (IoT) 將實體環境與各式各樣的物件匯集在一起，使它們能透過資訊與通訊 (ICT) 系統無縫地互動。  它涵蓋了許多支援技術，例如感測與控制技術、網路技術、資訊技術和軟體技術。  所有這些技術共同使感測器、致動器、中介軟體、資料與通訊網路以及應用程式能夠互連，形成一個 IoT 生態系統。

 隨著消費者、企業和政府對 IoT 解決方案的採用日益增加，IoT 經濟影響的重要性已廣為記載並日益顯著。  範例包括連網穿戴裝置、智慧家庭、智慧建築、連網車輛、影像監控與分析。

 隨著人員和裝置變得更加互聯，保護資料和管理網路安全威脅的相關議題變得日益重要。  IoT 裝置可以收集大量關於其使用者及其環境的資訊，包括個人可識別、商業機密及/或敏感資料。  例如，穿戴裝置可以追蹤個人的步數、心率和睡眠模式，而商業感測器和致動器則可能使企業控制系統暴露於資料外洩、甚至更嚴重攻擊的風險中。  需要採取措施來保護這數量龐大且不斷增長的感測器和敏感資料。

 不幸的是，早期的 IoT 裝置有幾個易於被利用的漏洞，使它們成為網路安全攻擊的輕易目標。  例如，被入侵的裝置可被殭屍網路控制，並被用來參與對其他組織的分散式阻斷服務 (DDoS) 攻擊。  安全性一直是阻礙使用者採用的首要顧慮。  另一方面，業界回饋，要遵循那些並非為 IoT 設計的現有標準，既耗時、昂貴，且對於 IoT 動態演變的技術和應用而言不切實際。

 保護組織和個人免受日益增加的網路威脅，是一項國家優先事項，也是一個經濟機會。  它是確保新加坡在數位經濟中保持網路安全、並擁有一套可信賴的基礎設施來支持我們「智慧國家」倡議的不可或缺的一部分。

 與任何系統一樣，一個 IoT 系統的安全性取決於其最弱的環節。  因此，確保在部署任何 IoT 系統的實作和營運階段，都已妥善考量並實施適當的安全措施，是至關重要的。  本文件旨在為採購、部署和營運 IoT 裝置/系統的使用者和企業提供指導，同時使解決方案提供商能夠透過提供包括基線建議、基礎概念和檢查表在內的實用指引，來驗證其解決方案的安全狀態。  本文採用了基於風險和系統導向的方法來識別和緩解對 IoT 解決方案的威脅。  企業用戶及其供應商將被引導在 IoT 系統的整個生命週期中共同合作，以確保其安全。

#### 👨‍💻 開發人員重點提醒

* **您的角色至關重要：** 本節開宗明義就指出，IoT 正在快速普及 ，但「安全性」是阻礙其發展的**首要顧慮** 。這意味著您（作為開發人員）的工作，是決定 IoT 產業能否成功跨越鴻溝的關鍵。
* **風險真實且嚴重：** 您的裝置不再是單純的硬體。它現在是企業控制系統（可能導致嚴重攻擊） 和個人敏感資料（心率、睡眠模式） 的入口。您的安全疏失會直接導致嚴重的資料外洩或系統風險。
* **別重蹈覆轍：** 指南明確提到「早期的 IoT 裝置」留下了許多安全漏洞，例如成為 DDoS 殭屍網路的幫兇 。本指南的出現，就是要確保您不會再開發出那樣「輕易被利用」的裝置。
* **別成為「最弱環節」：** 這是整份指南的核心精神 。一個系統的安全性，就看它最爛的部分。您必須確保您開發的裝置、App 或後台，**絕不**是那個最弱的環節。
* **本指南是您的「工具包」：** 指南的目的就是為了解決「現有標準不切實際」的痛點 ，提供一套「實用的指引」（基線建議、檢查表）。您應該把這份文件（特別是第 8 和第 9 節的檢查表）當作您開發流程的必備工具，用它來與您的客戶（企業用戶）建立共同的安全語言 。

---

### 2 Scope (範圍)

#### 📝 原文翻譯 (來源 66-78, 97)

 本文件是為打算部署 IoT 解決方案的企業用戶（及其供應商）提供的一份實務指南，提供基線建議¹、基礎概念和檢查表，重點關注 IoT 系統在獲取、開發、營運和維護方面的安全議題。  它主要側重於系統層級的建議，並建立在 ITSC TR 64：「智慧國物聯網安全指南」中介紹的概念之上，並透過案例研究提供有關 IoT 安全實作的進一步細節。

 本指南可供以下人員使用：
 1. 想要設計、開發和部署安全 IoT 產品和系統的 IoT 開發人員。  開發人員的範例包括解決方案架構師、程式設計師、製造商和系統整合商。
 2. 需要安全地推出、配置、營運、維護和停用 IoT 系統的 IoT 供應商。  供應商的範例包括網路營運商、平台供應商、資料分析師和服務交付經理。
 3. 想要採購和與 IoT 系統互動的 IoT 用戶。  在系統互動方面，IoT 用戶可以是真人或軟體代理程式。

 關於 IoT 系統的生命週期，IoT 開發人員主要參與實作階段，該階段涵蓋設計、開發、部署、整合和測試等階段，而 IoT 供應商則參與營運階段，該階段涵蓋營運、支援、維護、升級和淘汰等階段。  IoT 用戶可能參與實作和營運兩個階段。  應該注意的是，隨著 IoT 系統在整個生命週期中引入新功能，實作和營運階段可能會發生多次循環。

 圖 1 描述了本文件相對於 ITU-T X.1052 中定義的 ITU 資訊安全管理框架的兩個重點領域。

 ¹ 本指南不涵蓋隱私 (privacy) 領域。有關隱私的指引可在個人資料保護委員會 (PDPC) 的網站 [https://www.pdpc.gov.sg/Legislation-and-Guidelines/Guidelines](https://www.google.com/search?q=https://www.pdpc.gov.sg/Legislation-and-Guidelines/Guidelines) 上找到。

#### 👨‍💻 開發人員重點提醒

  * [cite\_start]**您的角色被明確定義：** 本指南清楚地將您（開發人員）列為三大目標受眾之一 [cite\_start]。您的職責是「設計、開發和部署」安全的 IoT 產品 。
  * [cite\_start]**您的主場：「實作階段」：** 指南將生命週期分為兩大塊。您的主要職責集中在「實作階段」（Implementation phase），這包括了設計、開發、部署、整合和測試 。
  * [cite\_start]**這不只是「建議」，而是「實務」：** 這是一份「實務指南」(practical guide) ，提供了您在開發時可以具體參照的「基線建議」和「檢查表」（我們稍後會看到的第 8、9 節）。
  * [cite\_start]**重點在「系統層級」：** 您的安全思維不能只停留在「單一裝置」，而必須擴展到「系統層級」(system-level) 。
  * [cite\_start]**⚠️ 重點排除事項：「隱私」：** 本指南在註腳中**非常明確**地指出，它「不涵蓋隱私 (privacy)」議題 [cite\_start]。這對您至關重要，代表您在處理個人資料（例如第 1 節提到的心率、睡眠模式）時 ，**必須**另外去查閱 PDPC 的隱私規範，本指南在隱私方面無法給您指引。

-----

### 6.1 Introduction (簡介)

#### 📝 原文翻譯

第 6 節為 IoT 用戶和 IoT 開發人員在實作階段提供了一套基線安全建議 。

這些建議涵蓋了四個基本的 IoT 安全設計原則（詳情請參閱附錄 A）：
1.  預設安全 (Secure by defaults) 
2.  嚴謹防禦 (Rigour in defence) 
3.  問責性 (Accountability) 
4.  韌性 (Resiliency) 

單一產品被用來實作一個系統，而該系統在組織的流程、政策和人員的背景下運行 。從產品到系統、最終到組織的整合層級不斷提高，需要額外的考量，因為整體的安全狀態取決於其最弱的環節 。總體而言，這些建議是系統化地、在 IoT 系統整個生命週期中保護它的基礎 。

雖然本文件提供的基線建議適用於大多數 IoT 系統，但 IoT 用戶和 IoT 開發人員仍需要根據業務需求和相關法規要求，來決定這些建議對其預期系統/解決方案的適當性 。

#### 👨‍💻 開發人員重點提醒

* **您的責任重大：** 這整節（第 6 節）明確指出是為您（開發人員）在「實作階段」準備的 。
* **跳脫「單一產品」思維：** 您不能只考慮您開發的「單一產品」。您必須意識到，您的裝置會被整合到一個更大的「系統」和「組織」中 。
* **別當「最弱環節」：** 系統的整體安全取決於最弱的部分 。您開發的裝置絕對不能成為那個最弱的環節。
* **安全非一體適用：** 您需要和您的客戶（IoT 用戶）一起評估，哪些建議是他們業務真正需要的，以及是否有特定法規必須遵守 。

---

好的，我們接著處理 6.2 節及其子節 6.2.1。

---

### 6.2 Principle 1: Secure by defaults (原則 1：預設安全)

### 6.2.1 Employ strong cryptography  (採用強式密碼學 )

#### 📝 原文翻譯

強大的密碼學能力是確保資料交易安全的基礎構建模組，包括 IoT 裝置之間的身份驗證和感測數據交換 。密碼學能力的用法範例包括數位簽章和加密 。

**建議：** 應在 IoT 系統中適當且足夠地應用業界公認的密碼學技術和最佳實踐 。

最佳實踐的範例包括：
* 使用經批准的演算法 
* 足夠的金鑰長度 
* 使用經批准的隨機數生成器 
* 建議的密碼學週期 
* 建議的熵源 (entropy sources) 
* 使用可更新的密碼學 

#### 👨‍💻 開發人員重點提醒

* **「安全」是出廠標配，不是選配：** 「預設安全」原則意味著您的裝置一出廠就必須是安全的。您不能預期用戶會自己去開啟安全功能。
* **別自創加密法：** 絕對不要自己發明加密演算法。指南明確要求使用「業界公認的」和「經批准的」技術 。這意味著您應該使用像 AES、RSA 這類經過嚴格審查的標準演算法。
* **金鑰管理是關鍵：** 演算法再強，金鑰管不好也沒用。您必須注意金鑰的長度（例如，不要用過短的金鑰）、金鑰的來源（需要好的隨機數和熵源），以及金鑰的生命週期（多久該更換一次）。
* **為未來做準備：** 「使用可更新的密碼學」 是一個關鍵提醒。現在安全的演算法未來可能被破解。您的裝置必須有能力透過韌體更新 (OTA) 來升級加密演算法或更換金鑰，否則它在未來將成為安全隱患。

---

### 6.2.2 Protect impactful data ,  (保護具影響力的資料 , )

#### 📝 原文翻譯

IoT 系統的具影響力資料（Impactful data）可指金鑰、憑證、程式碼/韌體、個人資料、輸入/命令和感測數據等 。存取具影響力的資料應要求保證及/或驗證其源自真實的來源，並應受到保護，免於遭未經授權方篡改、修改及/或洩露 。所有進出 IoT 裝置的敏感通訊都應被加密 。

**建議：** 具影響力的資料應檢查其真實性，並受到保護，免於遭未經授權方洩露和修改 。所有進出 IoT 裝置的敏感通訊都應被加密 。

#### 👨‍💻 開發人員重點提醒

* **不只是「用戶資料」：** 您必須擴大對「敏感資料」的定義。它不只是用戶的個人資訊，還包括您裝置的**韌體 (firmware)**、用於驗證的**金鑰**和**憑證**，以及接收到的**控制命令** 。如果這些東西被竄改，後果不堪設想。
* **資料保護三態：** 您需要保護所有狀態下的資料：
    1.  **傳輸中 (In transit)：** 裝置與雲端或 App 之間的所有通訊都必須加密 。這呼應了上一節的 TLS/DTLS。
    2.  **靜態 (At rest)：** 資料儲存在裝置的記憶體（例如 Flash）時，是否需要加密？如果攻擊者能實體接觸到裝置並讀取記憶體，他們是否能輕易竊取金鑰、憑證或用戶資料？
    3.  **使用中 (In use)：** 資料在 RAM 中處理時，也要考慮保護。
* **驗證來源 (真實性)：** 光加密不夠，您還必須驗證資料來源。當您的裝置收到一個（例如「開鎖」或「更新韌體」）的命令時，您必須 100% 確定這個命令是來自合法的主機或用戶，而不是攻擊者偽造的 。

---

### 6.3 Principle 2: Rigour in defence (原則 2：嚴謹防禦)

### 6.3.1 Conduct threat modelling  (執行威脅建模 )

#### 📝 原文翻譯

威脅建模提供了一種系統化的方法，有助於識別系統資產、系統資產的安全需求、以及對這些系統資產的可能威脅，從而使有限的可用資源能集中在需要保護的事物上 。威脅建模有助於最小化暴露的攻擊面並緩解剩餘的漏洞 。

**建議：** 威脅建模應在實作階段開始時進行，並應考慮到 IoT 裝置在定義的操作環境中的預期用途 。

#### 👨‍💻 開發人員重點提醒

* **別等出事才補救：** 「嚴謹防禦」代表您需要主動預測威脅，而不是被動修補漏洞。本節要求您在「實作階段開始時」就進行威脅建模，也就是在您開始大量撰寫程式碼之前。
* **像駭客一樣思考：** 威脅建模就是站在攻擊者的角度來審視您的設計。您需要回答幾個關鍵問題：
    1.  **我要保護什麼？** (系統資產)：是韌體、金鑰、用戶數據，還是控制權？
    2.  **誰會來攻擊？** (威脅)：是腳本小子、專業駭客，還是能實體接觸到裝置的人？
    3.  **他們會怎麼攻擊？** (攻擊面)：是透過 Wi-Fi、藍牙、JTAG 偵錯埠，還是雲端 API？
* **不只是「功能開發」：** 您的任務不只是讓裝置「能動」，還要讓它「在被攻擊時也能安全」。威脅建模的結果（例如使用 STRIDE 模型 ）將直接轉化為您必須實作的安全需求。
* **情境決定一切：** 「預期用途」和「操作環境」是關鍵 。一個安裝在公共場所（如路燈）的裝置，其面臨的實體威脅遠高於安裝在私人住宅內的裝置。您的安全設計必須符合這個情境。

---

### 6.3.2 Establish Root-of-Trust ,  (建立信任根 , )

#### 📝 原文翻譯

信任根 (Root-of-Trust) 提供了一個防篡改的模組，用於儲存和保護裝置的金鑰，以便為其他安全機制建立堅實的基礎，從而透過信任鏈 (chain of trust) 實現更高的安全保證 。

**建議：** 信任根應被建立並由關鍵系統元件（例如 IoT 閘道器和 IoT 平台）所利用，因為它們可能託管敏感資料並執行具影響力的操作 。例如，信任根可以基於嵌入在裝置中的信賴平台模組 (Trusted Platform Module, TPM) 晶片，或整合在裝置軟體內的虛擬安全元件 。

#### 👨‍💻 開發人員重點提醒

* **什麼是信任根 (RoT)？** 簡單來說，RoT 是您裝置上一個「絕對可信」的起點。它通常是硬體（但也可能是軟體），其設計目的就是為了防篡改 。
* **為何需要 RoT？** 如果您的金鑰（用來加密、驗證身份）和程式碼都儲存在一個可被輕易讀取或修改的地方（例如標準的 Flash 記憶體），那麼攻擊者一旦拿到裝置，就可以輕鬆提取金鑰、偽造身份、或刷入惡意韌體。
* **RoT 的核心工作：** 它的主要工作是「安全地儲存和保護金鑰」 。所有基於這個金鑰的後續安全操作（例如驗證韌體簽章、加密通訊）才能被信任，這就是「信任鏈」 。
* **您的實作選項：**
    1.  **硬體 (高安全性)：** 您可以在電路板上加一顆獨立的安全晶片，如「TPM」 。這提供了最強的實體防護，但成本也最高。
    2.  **整合 (中安全性)：** 許多現代微控制器 (MCU) 內部已包含硬體安全功能（例如 TrustZone、Secure Element、硬體加密引擎）。
    3.  **軟體 (低安全性)：** 指南提到了「虛擬安全元件」 ，這通常是在軟體層面透過混淆或其他技術來模擬安全儲存，其安全性遠低於硬體。
* **重點應用：** 指南特別點名「IoT 閘道器 (gateway)」和「IoT 平台」這類關鍵元件 。如果您的裝置是閘道器或扮演類似角色的中樞設備，那麼使用 RoT 就非常重要。

---

### 6.3.3 Employ secure transport protocols  (採用安全的傳輸協定 )

#### 📝 原文翻譯

傳輸協定用於在系統內部和系統之間傳輸資料 。因此，確保安全版本的傳輸協定被正確配置，以有效保護傳輸中的資料，是至關重要的 。

**建議：** 應盡可能採用經過驗證的傳輸協定，並正確啟動其安全控制 。

經過驗證的傳輸協定的安全控制範例包括：
* TCP 負載使用 TLS 
* UDP 負載使用 DTLS 
* 使用 MQTT 時採用 TLS 
* 停用未經驗證的藍牙配對程序 

#### 👨‍💻 開發人員重點提醒

* **別再裸傳資料：** 這是最基本也最關鍵的一點。您的裝置透過 Wi-Fi、乙太網路或行動網路傳送的任何資料，都**絕不能**以明文（未加密）形式傳輸。
* **加密「傳輸通道」：** 您的責任是加密「傳輸中」的資料 。不要預設網路環境是安全的，您必須假設所有網路流量都可能被竊聽。
* **選對工具 (協定)：** 指南已經幫您劃好重點了：
    * **如果用 TCP (例如 HTTP API、MQTT)：** 請務必使用 **TLS** (Transport Layer Security) 。這就是 HTTPS 中的 'S'。如果您在用 MQTT，請確保它運行在 TLS 之上 (MQTTS)。
    * **如果用 UDP (例如 CoAP 或自訂協定)：** 由於 UDP 是無連線的，您不能用 TLS。請使用 **DTLS** (Datagram TLS)，它是專為 UDP 設計的加密協定 。
    * **如果用藍牙：** 不要使用最簡單、不需 PIN 碼或 PIN 碼為 '0000' 的配對方式。您應強制使用安全的配對程序，例如「LE Secure Connections」 。
* **「啟用」是您的工作：** 很多開發套件 (SDK) 預設可能「不開啟」TLS，因為這需要憑證和額外設定。您必須在您的程式碼中「強制開啟並正確配置」這些安全控制 。

---

### 6.4 Principle 3: Accountability (原則 3：問責性)

### 6.4.1 Enforce proper access controls ,  (實施適當的存取控制 , )

#### 📝 原文翻譯

對系統資源的存取應在其整個生命週期中受到控制和管理，以最小化惡意行為者的機會 。預設密碼和弱密碼是最常被利用的漏洞 。使用多因子驗證 (MFA) 可為啟動者的身份提供更高的保證、增強問責性並減少錯誤 。

**建議：** 必須對裝置、網路和資料實施適當的存取控制，包含網路和實體兩方面 。基本的存取控制包括：
* 更換所有預設密碼 
* 強制使用 7.2.1 節中規範的強密碼 
* 對具影響力的遠端操作強制使用多因子驗證 (MFA) 
* 保護對裝置及其服務埠的實體存取

#### 👨‍💻 開發人員重點提醒

* **零預設密碼：** 這是最嚴格的要求 。您的裝置**絕不能**使用通用的預設密碼（例如 `admin`/`password`）。您必須在裝置首次啟動時，強制使用者設定一個唯一的、強式的新密碼。
* **實體安全也是您的責任：** 「存取控制」不只是指網路。指南明確提到「實體存取」 。在您的最終產品上，是否還暴露著 JTAG、UART 等偵錯埠？  攻擊者只要能拿到裝置並接上這些埠，就可能完全繞過您的軟體防護。在量產時，這些埠必須被停用或以安全方式保護。
* **MFA 不是「可有可無」：** 對於「具影響力的遠端操作」（例如更新韌體、更改管理員密碼、開鎖等關鍵指令），指南要求「強制使用 MFA」 。這不只是輸入密碼，您可能需要搭配一個手機 App，要求使用者做「第二次確認」（例如推播通知點選「核准」）。
* **密碼強度不是「建議」，是「規範」：** 您不能只是「建議」使用者使用強密碼，您必須「強制」執行 。您的系統必須拒收弱密碼。指南要求您參照 7.2.1 節的具體規範（我們稍後會看到，例如長度和字元組合）。

---

### 6.4.2 Provide audit trails  (提供稽核軌跡 )

#### 📝 原文翻譯

即使有適當的存取控制措施，故意的濫用、繞過限制和錯誤配置仍然是潛在的風險 。因此，擁有稽核軌跡非常重要 。

**建議：** 應適當監控和記錄所有存取敏感資料和更改系統資源的嘗試 。

#### 👨‍💻 開發人員重點提醒

* **什麼是稽核軌跡 (Audit Trails)？** 對裝置開發人員來說，這就是「日誌 (Logging)」。
* **為何要記錄日誌？** 這是「問責性」原則的核心。如果沒有日誌，裝置（或系統）被入侵或發生故障後，您將無法追查「發生了什麼」、「何時發生」以及「是誰（或哪個元件）做的」。
* **您必須記錄的內容：** 指南明確指出您必須記錄「所有存取敏感資料」和「更改系統資源」的**嘗試** 。這包括：
    * **成功的**登入。
    * **失敗的**登入嘗試（這對於發現駭客的暴力破解攻擊至關重要）。
    * 系統設定的重大更改（例如：更改管理員密碼、更改網路設定）。
    * 關鍵操作（例如：遠端開鎖、更新韌體）。
* **「嘗試」是關鍵字：** 不只記錄成功的操作，失敗的「嘗試」往往更有價值，因為它們是潛在攻擊的訊號。
* **資源考量：** IoT 裝置的儲存空間和運算能力通常很有限。您不能毫無節制地記錄所有日誌。您需要與系統架構師和客戶（用戶）協商，定義出哪些是「關鍵事件」，並確保這些事件的日誌能被安全地儲存或即時傳輸到後台日誌伺服器。

---

### 6.5 Principle 4: Resiliency (原則 4：韌性)

### 6.5.1 Guard against resource exhaustion  (防範資源耗盡 )

#### 📝 原文翻譯

IoT 系統容易受到資源耗盡攻擊 。攻擊者和被入侵的裝置可以持續向 IoT 裝置/網路/系統發送請求，以耗盡其資源並影響系統的可用性 。

**建議：** 系統應採用機制來防禦惡意攻擊，例如 DDoS 。範例包括：
* 監控系統/裝置資源足以維持服務 。
* 偵測資源耗盡以便及早介入 。
* 對資源密集型軟體進行特定控制 。
* 在 IoT 裝置上實施功耗閾值 。
* 限制並發會話 (concurrent sessions) 的數量 。
* 以剩餘容量 (excess capacity) 運行 。

#### 👨‍💻 開發人員重點提醒

* **您的裝置也會被 DDoS：** 不要以為 DDoS 只是雲端伺服器要擔心的事。對您的裝置而言，攻擊者可能透過網路（例如不斷嘗試建立 TCP 連線）或無線方式（例如不斷發送藍牙連線請求）來轟炸您的裝置 。
* **「韌性」代表「被打倒還能站起來」：** 您的裝置不能在面對這類攻擊時就當機或耗盡電力。您必須在軟體中建立防護機制。
* **您必須實作的防禦：**
    1.  **限制連線數 ：** 這是最重要的一點。您的裝置（例如 Web 伺服器或藍牙服務）能同時處理多少個連線？您必須在程式碼中設定一個**硬性上限**（例如：最多 3 個 TCP 連線）。當達到上限時，直接拒絕新的請求，而不是試圖處理它們直到記憶體耗盡。
    2.  **自我資源監控 ：** 您的程式（例如在 FreeRTOS 中）應該能監控自己的關鍵資源，像是「還剩下多少 Heap 記憶體？」、「CPU 負載是否過高？」。
    3.  **提早介入 ：** 當您偵測到資源（例如記憶體）即將耗盡時，不能坐以待斃。您必須採取行動，例如：主動拒絕新的連線、重新啟動網路模組，或進行一次安全的重開機 (safe reboot)。
    4.  **控制耗電 ：** 對於電池供電的裝置，攻擊者可能會故意保持網路連線，讓您的無線電模組 (Radio) 持續高功率運作以耗盡電力。您應設計超時機制，主動切斷閒置過久的連線。
    5.  **不要塞滿資源 ：** 在您選擇 MCU 或撰寫程式時，不要讓裝置在「正常運作」時就用掉 95% 的 RAM 或 CPU。您必須預留「剩餘容量」（Headroom），才能應對這種突發的攻擊流量。

---

### 7.1 Introduction (簡介)

#### 📝 原文翻譯

第 7 節為 IoT 用戶和 IoT 供應商在營運階段提供了一套基線安全建議 。

這些建議是根據第 6 節中使用的相同的四個基本 IoT 安全設計原則來組織的 。

雖然本文件提供的基線建議適用於大多數 IoT 系統，但 IoT 用戶和 IoT 供應商仍需要根據業務需求和相關法規要求，來決定這些建議對其預期系統/解決方案的適當性 。

#### 👨‍💻 開發人員重點提醒

* **您的角色轉變：** 雖然本節主要針對「用戶」和「供應商」（營運方），但您（開發人員）開發的功能是**實現**這些營運建議的基礎。
* **思考「部署後」的世界：** 您的工作不只在「實作階段」結束。您在實作階段（第 6 節）所做的設計，將直接決定營運階段（第 7 節）是否能順利執行。
* **為營運方提供工具：** 營運方需要工具來管理裝置。例如，當 7.2.1 節要求「使用強密碼」時，您必須在實作階段就提供強制更改密碼和密碼強度驗證的**介面**。
* **持續的責任：** 營運階段的很多建議（如 7.4.1 的韌體更新）都需要您（原始開發商）持續提供支援（例如發布修補程式）。您必須從一開始就建立好這種支援機制。

---

### 7.2 Principle 1: Secure by defaults (原則 1：預設安全)

（此為原則標題，本身無內文）

### 7.2.1 Use strong credentials ,  (使用強式憑證 , )

#### 📝 原文翻譯

弱憑證（例如，使用者識別碼和密碼）一直是首要的漏洞，容易受到暴力破解攻擊 。

**建議：** 應避免使用預設憑證，且整個系統都應使用強密碼 。如果沒有法規要求，密碼的複雜性（強度）應遵循已發布的國際最佳實踐 。密碼應**最少**包含 8 個或更多字元，由字母和數字組成 。同時也鼓勵使用符號和大寫字元以增強密碼強度 。

對於存取具影響力的資料和操作，應盡可能啟用多因子驗證 。

#### 👨‍💻 開發人員重點提醒

* **這是「營運」階段，但根源在「實作」：** 這是營運階段的第一個建議，再次強調了「預設憑證」的危害。這意味著您在實作階段（第 6 節）的工作至關重要。
* **您的「實作」責任：**
    1.  **強制更改：** 您必須在實作階段就設計好「強制首次登入修改密碼」的流程 。
    2.  **強制強度：** 您的系統**不能**接受弱密碼。您必須實作一個密碼驗證器，嚴格執行指南的「最低要求」：**8 個字元 + 字母 + 數字** 。
    3.  **提供更好選項：** 您應該「鼓勵」使用者加入符號和大小寫，例如在設定密碼的介面上提供強度提示 。
* **MFA 支援：** 營運方（供應商）無法「啟用」MFA，如果您（開發人員）一開始就沒有開發這個功能的話。您必須在實作階段就把 MFA 功能（無論是 TOTP、簡訊驗證或推播）建置到您的裝置、App 和後台系統中 。

---

### 7.3 Principle 2: Rigour in defence (原則 2：嚴謹防禦)

（此為原則標題，本身無內文）

### 7.3.1 Segment IoT and enterprise networks ,  (分割 IoT 與企業網路 , )

#### 📝 原文翻譯

一個被入侵的裝置就可能成為入侵您企業系統的攻擊媒介 。

**建議：** 應採用網路分段 (Network segmentation)，以便將屬於不同網路的 IoT 裝置彼此適當隔離，並與其他企業系統和網路隔離 。應盡可能實施防火牆和惡意軟體緩解方案來保護每個網路 。

#### 👨‍💻 開發人員重點提醒

* **您的裝置被視為「高風險」：** 這是營運方的思維。在企業IT管理員眼中，您的 IoT 裝置（以及所有 IoT 裝置）都是「不被信任的」。他們最大的恐懼是，萬一您的裝置被駭，攻擊者就會以此為跳板，滲透到他們儲存核心資料（如財報、客戶資料）的「企業內網」。
* **您的設計決定了「隔離」的可行性：** 雖然執行「網路分段」（例如使用 VLAN 或防火牆）是IT管理員的工作，但您的**裝置設計**會直接影響他們能否成功。
* **您在實作階段必須考慮：**
    1.  **明確告知通訊需求：** 您的裝置需要存取哪些伺服器位址 (IP/Domain)？使用哪些通訊埠 (Ports) 和協定 (TCP/UDP)？您必須在技術文件中寫得一清二楚。IT管理員需要這些資訊來設定防火牆，只允許您的裝置「最小必要」的通訊。
    2.  **避免「廣播」或「內網探索」：** 盡量不要讓您的裝置依賴 mDNS、UPnP 或其他需要在整個區域網路 (LAN) 上廣播/探索服務的功能。在被嚴格分段的網路中，這些功能通常會失效。
    3.  **假定網路不友善：** 您的裝置必須能在一個被高度限制的網路環境中存活，例如它可能無法存取內網的其他裝置，也無法存取 NTP 伺服器（除非您明確指定）。
* **最終目標：** 您的設計必須讓 IT 管理員能輕鬆地把您的裝置「關進籠子裡」（一個獨立的 IoT 網段），確保就算裝置被駭，災情也能被控制在那個小網段內，不會擴散到主企業網路。

---

### 7.4 Principle 3: Accountability (原則 3：問責性)

### 7.4.1 Establish proper device management  (建立適當的裝置管理 )

#### 📝 原文翻譯

所有連網的裝置都可能暴露在惡意行為者面前 ，並可能被利用，從而使網路攻擊者得以入侵整個 IoT 系統 。被盜的裝置可能被篡改、逆向工程，並被用來對付 IoT 系統 。過時和未修補的韌體/軟體可能包含已知漏洞，惡意行為者可以利用這些漏洞 。因此，對連網裝置的適當管理對於確保整個系統的安全至關重要 。

**建議：** 應建立適當的裝置管理，包括韌體/軟體更新和修補 。應在整個「營運」生命週期階段保持一份連網裝置、軟體和韌體版本的清單，並套用最新的修補程式 。應嚴格執行存取控制，包括對 IoT 裝置的實體存取 。IoT 用戶和 IoT 供應商應酌情訂閱 IMDA 的 ISG-CERT 和新加坡網路安全局 (CSA) 的 SINGCERT 發布的通知和建議，以隨時了解新發現的 IoT 和 ICT 系統漏洞與威脅 。

#### 👨‍💻 開發人員重點提醒

* **您是「安全更新」的唯一來源：** 這是營運階段最關鍵、也最能體現開發人員責任的一點。指南明確指出「過時和未修補的韌體」是重大威脅 。
* **您在實作階段必須建置：**
    1.  **安全的 OTA (Over-The-Air) 更新機制：** 這是**必須**的功能，不是選配。營運方無法「套用修補程式」，如果您（開發人員）沒有在實作階段打造一個安全、可靠、能驗證韌體簽章的 OTA 系統。
    2.  **版本回報機制：** 營運方如何「保持一份清單」？您的裝置必須能在每次連線時，主動向後台回報自己目前的型號、硬體版本、韌體版本和軟體版本。
* **物理防護的再提醒：** 指南再次強調「實體存取」。這呼應了 6.4.1 節的提醒，您在設計硬體時，必須移除或保護好偵錯埠。
* **您是漏洞修補的執行者：** 當 SINGCERT 發布新的漏洞警示時 （例如，您使用的某個開源 TCP/IP 堆疊有漏洞），營運方只能「通知」您。您（開發人員）是唯一能修補這個漏洞、編譯新韌體、並透過 OTA 系統推送更新的人。您必須為這種「長期抗戰」做好準備。

---

### 7.5 Principle 4: Resilience (原則 4：韌性)

### 7.5.1 Recover from attacks  (從攻擊中恢復 )

#### 📝 原文翻譯

IoT 系統將會成為攻擊目標，尤其是當資產足夠有價值時 。隨著更精密的攻擊工具被開發出來，有決心的攻擊者總會找到方法入侵系統 。因此，有必要準備好安全地(fail safely)應對故障並從中恢復，尤其是當 IoT 系統的入侵會影響到人員或設施的安全時 。

**建議：** 應定期進行系統資料（包含設定）的備份，以及系統的定期災難恢復演練 。

#### 👨‍💻 開發人員重點提醒

* **您必須假設「裝置會被駭」：** 這是「韌性」原則的精髓。這不是問「會不會」被駭，而是問「被駭之後怎麼辦」。
* **您的「實作」責任：** 雖然「備份」和「災難恢復」聽起來主要是營運方 (IT) 的工作，但您的裝置必須提供**支援**這些工作的功能：
    1.  **安全的「恢復原廠設定」：** 這是您（開發人員）最重要的任務。您必須提供一個可靠且（最好是）實體的機制，讓裝置在被入侵後，能被重置 (reset) 回它出廠時的、已知的、安全的韌體狀態 。
    2.  **支援「設定備份」：** 您的裝置或後台系統，是否允許營運方匯出(備份)該裝置的所有關鍵設定（例如網路配置、使用者清單等）？  如果裝置需要更換或重置，這將是恢復服務的關鍵。
    3.  **「安全地故障」(Fail Safely)：** 指南特別提到這點 。如果您的裝置是（例如）智慧門鎖、瓦斯偵測器或醫療設備，當它偵測到自己被攻擊或處於異常狀態時，它**不能**只是當機。它的「預設故障模式」必須是**安全**的（例如：保持上鎖並發出警報、切斷瓦斯閥門），您必須在實作階段就定義好這個安全狀態。
    4.  **支援「重新部署」：** 您的裝置必須能支援「災難恢復演練」 。這意味著它必須能被輕易地（在營運方驗證身份後）從系統中移除、重置、然後像新裝置一樣安全地重新註冊回系統中。

---

### 7.5.2 Conduct periodic assessments  (執行定期評估 )

#### 📝 原文翻譯

一個 IoT 系統可以是一個動態且複雜的系統。由於威脅總是在不斷演變，因此需要定期的滲透測試及/或漏洞評估來緩解安全風險。

**建議：** 應定期對 IoT 系統進行滲透測試及/或漏洞評估。威脅建模應作為漏洞評估的一部分來執行。

#### 👨‍💻 開發人員重點提醒

* **您是「被測試」的對象：** 營運方（用戶或供應商）會被要求「定期」找專業的白帽駭客（滲透測試團隊）來攻擊您的裝置和系統。
* **這不只是一次性的測試：** 即使您的裝置在「實作階段」通過了安全測試，也不代表一勞永逸。隨著新的攻擊手法（威脅）不斷演變，您在營運階段**必須**持續接受挑戰。
* **您的「實作」責任：**
    1.  **為測試做好準備：** 您（開發人員）必須有能力配合營運方進行這些評估。您可能需要提供測試裝置、技術文件、或建立一個專門的測試環境。
    2.  **修補漏洞的責任：** 當滲透測試團隊在「營運階段」發現您的裝置有新的漏洞時，您（開發人員）有責任修補它。這又回到了 7.4.1 節，您必須有能力開發修補程式，並透過 OTA 推送更新。
* **「威脅建模」是持續的：** 指南建議「威脅建模應作為漏洞評估的一部分」。這意味著，當營運方在評估時，他們會重新檢視您在實作階段（6.3.1 節）所做的威T脅建模，看看它是否仍然有效，或者是否出現了您當初沒有想到的新威脅。

---

### 8 Threat modelling checklist (威脅建模檢查表)

#### 📝 原文翻譯

本節提供了一份建議的威脅建模檢查表 。該檢查表可用於指導威脅建模過程，並確保其正確且系統地進行 。

雖然 STRIDE（ Spoofing 欺騙, Tampering 篡改, Repudiation 否認, Information disclosure 資訊洩露, Denial of service 阻斷服務, Elevation of privilege 權限提升）是用於協助分析和發現系統威脅的模型 ，但也應注意，還存在其他方法，並且它們可能更適合特定的使用案例 。

請參閱附錄 B 中的案例研究，以了解威脅建模檢查表的應用範例 。

#### 👨‍💻 開發人員重點提醒

* **這是一份「必做清單」：** 繼 6.3.1 節建議您「執行威脅建模」之後，本節直接給了您一份「怎麼做」的檢查表 。這不是一份可選的參考文件，而是您在實作階段初期的行動指南。
* **STRIDE 是您的起點：** 指南明確推薦了 STRIDE 模型 。在您設計裝置時，您必須系統性地思考：
    * **Spoofing (欺騙)：** 駭客能冒充我的裝置嗎？能冒充我的合法用戶或雲端伺服器吗？
    * **Tampering (篡改)：** 駭客能竄改我的韌體、儲存的資料，或傳輸中的命令嗎？
    * **Repudiation (否認)：** 駭客（或惡意用戶）能否在執行惡意操作（例如開鎖）後，否認是他們做的？（這呼應了 6.4.2 的稽核軌跡）。
    * **Information disclosure (資訊洩露)：** 駭客能竊取到金鑰、密碼、用戶隱私數據嗎？
    * **Denial of service (阻斷服務)：** 駭客能讓我的裝置當機、斷線或耗盡電力嗎？（這呼應了 6.5.1）。
    * **Elevation of privilege (權限提升)：** 駭客能否從一個普通用戶權限，提升為管理員權限？
* **工具不是唯一的：** 指南也提醒您，STRIDE 並非唯一解方 。重點是您必須有一個「系統化」的流程來找出威脅，而不是隨意猜測。

---

### ID 1: Identify the potential target(s) to be protected (識別要保護的潛在目標)

#### 📝 原文翻譯 (來源 360)

"1. 識別要保護的潛在目標
    a. 定義其邊界以及需要與之互動的外部系統（包括使用者）
    b. 將目標分解為其子元件 
    c. 識別目標內部的資料流，以及來自外部系統的輸入和輸出 
    d. 識別敏感資料及其處理位置（靜態、傳輸中、使用中）
    e. 針對子元件和資料流，識別其安全需求（基於對機密性、完整性、可用性 (CIA 三元組) 的潛在衝擊）
    f. 識別正在使用的硬體、軟體和協定 "

#### 👨‍💻 開發人員重點提醒

* **這一步是「畫地圖」：** 在您開始「防禦」之前，您必須先清楚知道您到底在「保護什麼」。ID 1 就是在要求您把整個系統的架構圖、資料流向圖畫出來。
* **您的重點工作：**
    * **(a, b) 拆解您的系統：** 您的「目標」（例如，您的 IoT 裝置）是由哪些「子元件」組成的？ 例如：
        * MCU
        * Wi-Fi 模組
        * 安全晶片 (Secure Element)
        * 感測器
        * JTAG/UART 埠
        * 裝置上的 Web 伺服器
        * MQTT 客戶端
    * **(c, d) 追蹤「敏感資料」的流向：** 這是最關鍵的一步。您必須像偵探一樣追蹤「敏感資料」（例如金鑰、密碼、韌體、用戶 PII）。
        * **它在哪裡？** * **靜態 (at rest)：** 它儲存在 Flash 的哪個位置？是否加密？
        * **傳輸中 (in transit)：** 它如何透過 Wi-Fi 傳到雲端？用什麼協定？是否用了 TLS？
        * **使用中 (in use)：** 它載入到 RAM 中處理時，是否能被偵錯器讀取？
    * **(e) 定義「安全需求」(CIA)：** 您要開始思考，如果這些資料流或元件出事了，會有多嚴重？
        * **機密性 (C)：** 如果韌體被駭客**讀取**(洩露)了，嚴重嗎？
        * **完整性 (I)：** 如果韌體在傳輸中被駭客**竄改**(篡改)了，嚴重嗎？（絕對嚴重！）
        * **可用性 (A)：** 如果裝置被 DDoS 導致**無法連線**(阻斷服務)，嚴重嗎？
    * **(f) 列出您的「技術債」：** 清楚列出您用了哪些硬體晶片、作業系統 (RTOS)、第三方函式庫（例如 TCP/IP 堆疊、MQTT 函式庫）和通訊協定 。這份清單（也稱為軟體物料清單, SBOM）在未來爆發漏洞時至關重要。

---

### ID 2: Define the security problem (定義安全問題)

#### 📝 原文翻譯 (來源 360)

"2. 定義安全問題
    a. 識別系統可存取性 (system accessibility)
        * 識別攻擊面
        * 決定操作環境
        * 決定系統 / 裝置生命週期和供應鏈
    b. 識別系統易受攻擊性 (system susceptibility) (又稱漏洞 vulnerabilities)
        * 決定已知漏洞
        * 列舉攻擊面的威脅（使用 STRIDE 作為指引）
        * 列舉操作環境的威脅（使用 STRIDE 作為指引）
        * 列舉系統 / 裝置生命週期和供應鏈各階段的威脅（使用 STRIDE 作為指引）
    c. 陳述任何假設"

#### 👨‍💻 開發人員重點提醒

* **這一步是「找出弱點」：** 在 ID 1 畫完地圖後，ID 2 要求您開始在這張地圖上標示出所有「危險區域」和「潛在的入侵路徑」。
* **您的重點工作：**
    * **(a) 識別攻擊面：** 這是最直接的工作。您必須列出**所有**攻擊者可能接觸到您裝置的「點」。例如：
        * **實體：** USB 埠、JTAG/UART 偵錯埠、外露的 Flash 晶片。
        * **無線電：** Wi-Fi、藍牙、Zigbee。
        * **網路：** 裝置上運行的 Web 伺服器、開啟的 TCP/UDP 埠。
        * **後台：** 雲端 API、手機 App。
    * **(a) 考慮「環境」和「生命週期」：**
        * **操作環境：** 裝置是安裝在「安全的」用戶家中，還是「不安全的」公共場所電線桿上？後者面臨的**實體攻擊**威脅天差地遠。
        * **生命週期/供應鏈：** 您的裝置在「生產製造」過程中是否安全？（例如，金鑰是否在工廠就被灌錄好？工廠是否可能洩漏您的金鑰？）裝置在「報廢」時如何處理？（這呼應了後續 10. CK-LP-10 的資料清除）。
    * **(b) 使用 STRIDE 掃描弱點：** 針對您剛找出的**每一個**攻擊面、**每一種**操作環境、**每一個**生命週期階段，您都要用 STRIDE 模型（欺騙、篡改、否認、資訊洩露、阻斷服務、權限提升）去掃描一遍，找出可能的威脅 。
        * **範例：**
            * 攻擊面 (JTAG 埠) + STRIDE (資訊洩露) = 威脅 (攻擊者可透過 JTAG 讀取記憶體，竊取金鑰)。
            * 操作環境 (公共場所) + STRIDE (篡改) = 威脅 (攻擊者可偷走裝置，竄改韌體後再裝回去)。
    * **(c) 坦誠您的「假設」：** 這是常被忽略但很關鍵的一步。您必須寫下您的安全設計是基於哪些「假設」。例如：「我們假設用戶的 Wi-Fi 密碼是安全的」、「我們假設雲端伺服器不會被駭」。一旦這些假設被推翻，您的安全設計可能就失效了。

---

### ID 3: Conduct risk assessment (執行風險評估)

#### 📝 原文翻譯 (來源 360)

"3. 執行風險評估
    * 評估威脅和漏洞對 CIA 三元組的衝擊，並與資產的安全需求進行匹配
    * 評估實現威脅所需的攻擊者能力
    * 評估風險發生的可能性
    * 對風險進行優先級排序以進行緩解，包括其他考量（例如金錢、安全、社會和易用性衝擊）"

#### 👨‍💻 開發人員重點提醒

* **這一步是「決定哪些火先救」：** 在 ID 2 中，您找出了一大堆潛在的威脅和弱點。但您的開發時間和成本是有限的，您不可能修復「所有」問題。ID 3 的目的就是幫您「排定優先級」。
* **您的重點工作（如何排序）：**
    1.  **評估「衝擊」(Impact)：** 這是最重要的。如果這個威脅真的發生了，後果有多嚴重？（這呼應了 ID 1e 的 CIA 評估）。
        * **高衝擊：** 遠端竊取金鑰、執行任意程式碼（RCE）、刷入惡意韌體。
        * **低衝擊：** 讓裝置 LED 燈號閃爍異常。
    2.  **評估「可能性」(Likelihood) & 「能力」(Capability)：** 這個威脅「多容易」被利用？
        * **高可能性：** 攻擊者只需在網路上掃描，就能利用的「預設密碼」漏洞。
        * **低可能性：** 攻擊者需要價值數百萬的實驗室設備、電子顯微鏡，並花費數個月才能解密的晶片級攻擊。
    3.  **排出優先級：** 您將使用一個矩陣來決定風險等級：
        * **（高衝擊 x 高可能性）= 優先級最高（必須立即修復）**
        * （高衝擊 x 低可能性）= 優先級中（應修復，但需考量成本）
        * （低衝擊 x 高可能性）= 優先級中/低（例如，阻斷服務）
        * （低衝擊 x 低可能性）= 優先級最低（可接受或忽略）
    4.  **考量「現實因素」：** 指南特別提醒您要考量「易用性衝擊」。例如，一個「超級安全」但「超級難用」的功能（例如每次開燈都要 MFA），用戶根本不會用，這反而會產生新的風險（用戶會想辦法繞過它）。您必須在安全性和易用性之間找到平衡點。

---

好的，我們接著處理威脅建模檢查表的第四個步驟。

---

### ID 4: Determine the security objectives (決定安全目標)

#### 📝 原文翻譯 (來源 360)

"4. 決定安全目標
    * 陳述安全目標。例如，OT（營運技術）系統強調安全 (safety)，其中系統完整性 (integrity) 優先於資料機密性 (confidentiality)"

#### 👨‍💻 開發人員重點提醒

* **這一步是「設定防禦的『為什麼』」：** 在 ID 3 中，您排定了風險的優先級。現在，ID 4 要求您根據這些風險，明確定義出您「到底要達成什麼樣的安全目標」。
* **您的重點工作：**
    * **陳述您的「安全宣言」：** 您的安全目標必須清晰明確。它將指導您在 ID 5 和 ID 6 中做出具體的設計決策。
    * **範例的啟示（OT vs. IT）：** 指南給了一個非常關鍵的 OT（營運技術）範例，這對 IoT 開發人員極具啟發性：
        * **IT 系統**（例如電子商務）通常最關心「機密性」(C)：不惜一切代價防止客戶資料外洩。
        * **OT 系統**（例如工廠、電力、醫療設備）則最關心「完整性」(I) 和「可用性」(A)，以及「人身安全」(Safety)。
    * **問自己：我的 IoT 裝置比較像 IT 還是 OT？**
        * 如果您的裝置是「智慧門鎖」：
            * **完整性**（命令不被竄改）和**可用性**（主人想開門時必須能開）絕對優先於**機密性**（「開鎖日誌」被竊取雖然不好，但遠不如「主人被關在門外」或「駭客能開鎖」嚴重）。
            * 您的安全目標就可能是：「*確保任何情況下，只有合法用戶能操作門鎖，且裝置必須能即時響應合法命令。*」
        * 如果您的裝置是「個人健康手環」：
            * **機密性**（用戶心率、睡眠數據）和**完整性**（數據不被竄改）就可能並駕齊驅，優先級非常高。
            * 您的安全目標可能是：「*確保用戶的健康數據在傳輸和儲存時都受到加密保護，防止洩露，並確保數據的準確性不被竄改。*」
* **目標指引取捨：** 當您在「安全性」和「易用性」之間掙扎時（ID 3 提過的），您設定的「安全目標」（ID 4）就是您做出最終決策的最高指導原則。

---

### ID 5: Define the security requirements (定義安全需求)

#### 📝 原文翻譯 (來源 363)

"5. 定義安全需求
    * 陳述為達成已識別的安全目標所必需的需求，無需深入探討其具體實作"

#### 👨‍💻 開發人員重點提醒

* **這一步是「把『目標』變成『規格』」：** 這是威脅建模中至關重要的一步，您將把 ID 4 中設定的「高階目標」（Why）轉換為 ID 5 的「具體需求」（What）。
* **重點是「What」，不是「How」：** 這一階段，您先不關心「如何實作」。您只關心「必須做到什麼」。
    * **（❌ 錯誤的 - "How"）：** "我們將使用 `mbedtls_aes_cmac` 搭配 `ESP32-WROOM-32` 的硬體加速器來實作..."
    * **（✔️ 正確的 - "What"）：** "系統**應**能驗證韌體更新包的真實性與完整性，在安裝前拒絕任何被篡改的韌體。"
* **您的重點工作：**
    * **將「目標」轉譯為「需求」：**
        * **ID 4 的目標（智慧門鎖）：** "確保只有合法用戶能操作門鎖。"
        * **ID 5 的需求（規格）：**
            * "系統**應**在接受任何開/關鎖命令前，對手機 App 和門鎖進行雙向身份驗證。"
            * "所有開/關鎖命令**應**受保護，能抵禦篡改和重放攻擊 (replay attacks)。"
            * "系統**應**拒絕來自未經驗證來源的韌體更新。"
    * **來自「風險」的需求：** 您的需求也直接對應您在 ID 3 中排定「高優先級」的風險。
        * **ID 3 的風險：** "攻擊者可透過 JTAG 讀取金鑰。"
        * **ID 5 的需求：** "在量產裝置上，JTAG 存取**應**被永久禁用。"
* **可測試性：** 您在這裡寫下的每一條「需求」，都應該是具體、明確、且「可被測試」的。這份清單（Security Requirements）將成為您的 QA 團隊在 ID 7（驗證）時的測試依據。

---

### ID 6: Design and implement the capabilities (設計並實作能力)

#### 📝 原文翻譯 (來源 363)

"6. 設計並實作能力"

#### 👨‍💻 開發人員重點提醒

* **這一步就是「開始動工」 (Coding & Engineering)：** 這可能是整份檢查表中原文最簡短、但您實際工作量最大的一步。
* **您的重點工作：**
    * **「實作」 (Implement)：** 您現在要開始真正撰寫程式碼、設計電路板、選擇晶片，去**實現**您在 ID 5 中定義的「所有安全需求」。
    * **「設計」 (Design)：** 這是「How」的階段。
        * **ID 5 的需求 (What)：** "系統**應**能驗證韌體更新包的真實性與完整性..."
        * **ID 6 的設計 (How)：** "我們將使用 `ed25519` 演算法進行數位簽章。私鑰儲存在安全的 CI/CD 伺服器，公鑰硬編碼 (hard-coded) 在裝置的 Bootloader 中。Bootloader 在刷入新韌體前，必須先用此公鑰驗證韌體簽章，驗證失敗則拒絕更新。"
    * **遵循安全準則：** 在實作的過程中，您必須遵循所有相關的安全開發準則（例如：安全的程式碼編寫實務，防範緩衝區溢位、使用經過驗證的加密庫而非自己實作）。
* **串聯前面所有工作：**
    * 您的實作必須能緩解 ID 3 中排定高優先級的風險。
    * 您的實作必須能達成 ID 4 中設定的安全目標。
    * 您的實作必須**完全滿足** ID 5 中定義的每一條安全需求。

---

### ID 7: Validate and verify that the capabilities address the security requirements adequately (驗證並核實能力是否充分滿足安全需求)

#### 📝 原文翻譯 (來源 363)

"7. 驗證並核實能力是否充分滿足安全需求"

#### 👨‍💻 開發人員重點提醒

* **這一步是「最終驗收」：** 您在 ID 6 中實作了所有功能，現在 ID 7 要求您回頭去「證明」您的實作確實滿足了 ID 5 中定義的「所有安全需求」。
* **「驗證 (Validate)」 vs. 「核實 (Verify)」：**
    * **核實 (Verify)：** 您是否「正確地」實作了功能？（例如：Bootloader 是否真的在檢查簽章？）
    * **驗證 (Validate)：** 您實作的功能是否「真正地」達成了安全目標？（例如：Bootloader 的簽章檢查是否*無法被繞過*？它是否能*真正地*抵禦駭客的篡改攻擊？）
* **您的重點工作：**
    1.  **測試，測試，再測試：** 這是 QA 和安全測試團隊的工作。他們會拿出您在 ID 5 中定義的「安全需求清單」，逐一設計測試案例。
    2.  **攻擊性測試 (PENTEST)：** 這不只是「功能測試」，而是「安全測試」。
        * **ID 5 需求：** "JTAG 存取**應**被永久禁用。"
        * **ID 7 測試：** 測試人員會*嘗試*用各種手段（例如電壓 glitching）重新啟用 JTAG。如果他們成功了，就代表您的 ID 6 實作「未充分滿足」ID 5 的需求。
    3.  **回溯威脅：** 測試團隊也會回頭看 ID 3 的「高風險威脅」。
        * **ID 3 風險：** "攻擊者可透過 Wi-Fi 暴力破解密碼。"
        * **ID 7 測試：** 測試人員會*真的*執行暴力破解攻擊，來驗證您的防護機制（例如 6.5.1 提到的限制連線數、6.4.1 提到的登入延遲）是否有效。
* **威脅建模是一個循環：** 如果您在 ID 7 驗證失敗了（例如，測試人員繞過了您的防禦），您就必須退回到 ID 3 (重新評估風險)、ID 5 (修改需求) 和 ID 6 (重新設計實作)，然後再回來 ID 7 重新驗證。

---

### 9 Vendor disclosure checklist (供應商揭露檢查表)

#### 📝 原文翻譯 (來源 366-372)

本節提供了一份非詳盡的安全問題清單，企業解決方案供應商可將其用於自我揭露 。它識別了供應商應關注的可能的重要安全能力/服務，同時也讓用戶能更好地評估和比較不同供應商所提出的 IoT 解決方案/系統的安全方面 。因此，這份檢查表有助於溝通、實現 IoT 解決方案間安全性的公平比較，並促進實施更好的安全性 。

儘管檢查表有上述用途，但應注意的是，該檢查表僅為常見安全考量的模板 。用戶需要根據其用途和業務需求，來決定檢查表項目的適當性和適用性，以便對其進行增加、刪除及/或調整 。

請參閱附錄 B 中的案例研究，以了解供應商揭露檢查表的應用範例 。

#### 👨‍💻 開發人員重點提醒

* **這是您的「安全履歷」：** 這份檢查表是您的客戶（企業用戶）在採購時，會拿來「面試」您的表格。您（作為供應商/開發人員）如何回答這些問題，將直接決定您是否能贏得標案。
* **「自我揭露」的壓力：** 您必須主動、誠實地揭露您的裝置具備哪些安全能力。如果您對很多項目都回答「N」(No) 或「NA」(Not applicable)，您的產品競爭力將會很低。
* **您的「開發指南」：** 您可以反過來利用這份清單。在您開始「實作階段」時（第 6 節），就應該把這份檢查表當作您的「開發規格書」。您的目標應該是讓您的產品在未來能對這裡的每一個問題都回答「Y」(Yes)。
* **不是模板，是基準：** 雖然指南說這只是「模板」，但它實際上為企業用戶設定了一個評估「及格線」的基準。您的產品必須以滿足這些項目為目標。

---

### 1. Cryptographic support (密碼學支援)

#### 📝 原文翻譯 (來源 373)

"**ID: CK-CS-01**
您的裝置和系統是否適當地利用了業界公認的密碼學技術和最佳實踐？
最佳實踐的範例包括：
* 使用經批准的演算法及其正確的實作和應用 
* 足夠的金鑰長度 
* 使用經批准的隨機數生成器 
* 建議的密碼學週期 
* 建議的熵源 
* 使用可更新的密碼學 "

"**ID: CK-CS-02**
您是否採用了適當的金鑰管理（生成、交換、儲存、使用、銷毀、替換等）技術？"

#### 👨‍💻 開發人員重點提醒

* **這是對第 6.2.1 節的直接驗收：** 客戶在問的 **CK-CS-01**，幾乎逐字逐句來自您在實作階段（第 6.2.1 節）的基線建議。您是否有使用標準演算法？金鑰長度是否足夠？您是否有能力更新加密演算法？[cite: 245, 247-251]
* **您必須回答「Y」：** 如果您對 CK-CS-01 回答「N」，基本上等於承認您的產品不符合本指南的基線要求，這在企業採購中非常致命。
* **CK-CS-02 深入探討金鑰的「生命週期」：**
    * 您的裝置如何**安全地生成**金鑰？（是否使用了好的隨機數生成器？）
    * 您的裝置如何**安全地儲存**金鑰？（是否用了 6.3.2 節提到的「信任根」？）
    * 您的裝置如何**安全地更新/替換**金鑰？（例如憑證過期時）
* **「支援」是最低要求：** 作為開發人員，您的工作就是確保您的裝置和系統具備**所有**這些能力，以便您在面對這份檢查表時，能自信地回答「Y」，並提供「Supporting materials」（支援材料）來證明您的說法（例如，您使用的加密庫、您的金鑰管理白皮書等）。

---

### 2. Security function protection (安全功能保護)

#### 📝 原文翻譯 (來源 373)

"**ID: CK-FP-01**
您是否建立了信任根 (Root-of-Trust)？"

"**ID: CK-FP-02**
您是否採用了安全啟動 (Secure Boot)？"

#### 👨‍💻 開發人員重點提醒

* **這是對第 6.3.2 節的直接驗收：** **CK-FP-01** 直接詢問您是否實作了 6.3.2 節的核心建議 。您是否使用了 TPM、Secure Element 或 MCU 內建的安全功能來保護金鑰？ 如果沒有，您將無法建立「信任鏈」。
* **CK-FP-02 (安全啟動) 是「信任鏈」的實踐：**
    * **什麼是安全啟動？** 這是信任根 (RoT) 的第一個、也是最重要的工作。當您的裝置一上電，RoT 會先啟動，並用它「安全儲存」的公鑰去**驗證**下一階段程式（例如 Bootloader）的**數位簽章**。
    * **為何重要？** 如果 Bootloader 被驗證是可信的，Bootloader 接著會去驗證主程式（您的韌體）的簽章。這個「一環驗一環」的過程就叫「信任鏈」。
    * **您的責任：** 如果您不實作安全啟動，攻擊者就能輕易地在您的裝置上刷入惡意韌體 。能回答「Y」，代表您能向客戶證明，您的裝置**只會運行您（開發商）簽署過的可信程式碼**。
* **沒有 RoT 就沒有安全啟動：** 這兩項是綁定在一起的。您必須先有 CK-FP-01 (信任根) 才能實作出 CK-FP-02 (安全啟動)。這是您裝置抵禦韌體篡改的第一道防線。

---

### 3. Identification and authentication (身份識別與驗證)

#### 📝 原文翻譯 (來源 373)

"**ID: CK-IA-01**
您的客戶端（使用者、裝置、閘道器、應用程式）和伺服器是否採用了唯一的、不可修改的且可被驗證的身份？"

"**ID: CK-IA-02**
您是否採用了雙向驗證 (mutual authentication)？例如，在建立連線之前和預定的時間間隔之後。"

#### 👨‍💻 開發人員重點提醒

* **CK-IA-01 (裝置的「數位 DNA」)：**
    * 這是超越「密碼」的層級。客戶在問的是您的**裝置本身**是否有一個無法被複製的「身份」。
    * **唯一的 (Unique)：** 您的每台裝置在出廠時，是否都有一個獨一無二的 ID（例如，一個燒錄在晶片中的裝置憑證）？還是您所有的裝置都共用同一個 API 金鑰？（後者是致命錯誤）。
    * **不可修改的 (Non-modifiable)：** 這個「身份」是否儲存在安全的地方（例如 6.3.2 節的「信任根」）？  還是它只是一個儲存在 Flash 檔案系統中的設定檔（駭客可以輕易讀取並複製）？
    * **可被驗證的 (Verifiable)：** 雲端伺服器是否有辦法透過密碼學（例如，挑戰-回應機制）來「驗證」這個裝置真的是它所聲稱的那台裝置？
* **CK-IA-02 (雙向驗證，mTLS)：**
    * **這是在防範「中間人攻擊」(MITM)。**
    * **單向驗證**（標準 HTTPS）：**您的裝置** (Client) 會驗證**伺服器** (Server) 的身份（"你好，你是真的 Google 嗎？"）。
    * **雙向驗證 (Mutual Auth)**：不只如此，**伺服器**也會反過來驗證**您的裝置**的身份（"很好，我是真的 Google。那麼，你是我的合法裝置嗎？"）。
    * **您的責任：** 您必須實作「雙向 TLS」(mTLS)。您的裝置在連線時，必須出示它自己的「客戶端憑證」（這就是 CK-IA-01 提到的那個「唯一身份」），而您的伺服器必須設定為「只接受」持有合法憑證的裝置連線。

---

### 4. Network protection (網路保護)

#### 📝 原文翻譯 (來源 373, 377)

"**ID: CK-NP-01**
您是否實施了網路存取控制？ 
例如，確保加入新網路及/或允許遠端存取時需有明確的授權。 "

"**ID: CK-NP-02**
您是否採用了經過驗證的傳輸協定，並正確啟動其安全控制？ 
範例包括：
* TCP 負載使用 TLS。 
* UDP 負載使用 DTLS。 "

"**ID: CK-NP-03**
您是否採用了業界最佳實踐來確保連線安全？ 
業界最佳實踐的範例：
* 使用 VPN 或專線。 
* 當使用公共行動電信網路時，使用電信營運商的私有行動 APN。 
* 使用 DNS 綁定 (DNS pinning) 以防止 DNS 欺騙。 
* 基於類型、埠和目標進行流量過濾。 
* 使用憑證綁定 (Certificate pinning)。 
* 使用 MQTT 時採用 TLS。 
* 掃描開放的網路埠。 
* 使用白名單來建立或拒絕來自非信任來源的連線。此外，IETF RFC 8520 製造商使用描述 (MUD) 可以作為裝置向網路提供此資訊的標準機制。 "

"**ID: CK-NP-04**
您是否將來自受信任端點的通訊通道與來自非受信任端點的通訊通道進行了隔離？ 
範例包括：
* 使用 VLAN。 
* 使用防火牆建立 DMZ。 
* 使用單向安全閘道器。 
* 使用網路分段或微分段。 
* 實體隔離。 "

#### 👨‍💻 開發人員重點提醒

* **這是對您「網路行為」的全面審查：** 客戶不僅關心您的裝置「說什麼」（資料），還關心它「如何說」以及「在哪裡說」（網路）。
* **CK-NP-01 (存取控制)：**
    * **加入網路：** 您的裝置是否支援 WPA2/WPA3 Enterprise 等安全的 Wi-Fi 驗證方式？還是只能用簡單的共享密碼？
    * **遠端存取：** 您的裝置是否預設開啟了 SSH、Telnet 或 Web 管理介面？如果是，它們的存取權限是否受到 6.4.1 節（強密碼、MFA）的嚴格保護？ 
* **CK-NP-02 (加密通道)：**
    * 這是對 6.3.3 節的再次驗收 。您**必須**為所有 TCP 和 UDP 通訊（包括 MQTT ）加上 TLS/DTLS 。如果您回答「N」，代表您的裝置在網路上「裸奔」，這是不可接受的。
* **CK-NP-03 (最佳實踐)：**
    * 這份清單是「加分項」，也是高安全等級客戶（如企業、政府、醫療）的「必備項」。
    * **憑證/DNS 綁定 (Pinning)：** 這是防止中間人攻擊 (MITM) 的進階手段。您的裝置應內建伺服器憑證或公鑰的指紋，拒絕與任何「偽造的」伺服器通訊。
    * **MUD (製造商使用描述)：** 這是一個很重要的概念。您的裝置應有能力「主動告訴」企業防火牆（例如透過 MUD 檔案）：「我只會跟 `api.mycloud.com` 的 443 埠通訊，其他所有流量都是非法的」。這能極大協助 7.3.1 節的網路分段 。
    * **掃描開放埠口：** 您的意思是，您（開發人員）在出廠前已經掃描並關閉了所有不必要的埠口。
* **CK-NP-04 (支援分段)：**
    * 這呼應了 7.3.1 節（營運方的責任） 。客戶在問：您的系統**是否能配合**網路分段？
    * 範例：如果您的系統包含一個閘道器 (Gateway) 和多個感測器 (Sensor)，您（開發人員）是否在閘道器上就主動使用了 VLAN，將感測器網路和企業網路隔離開來 ？
    * 您的設計應**最小化**對「區域網內互相通訊」的依賴，這能讓營運方的分段工作更簡單。

---

### 5. Data protection (資料保護)

#### 📝 原文翻譯 (來源 377)

"**ID: CK-DP-01**
您是否保護了敏感資料的機密性和完整性？
* 傳輸中 (in transit)
* 使用中 (in use)
* 靜態 (at rest)"

"**ID: CK-DP-02**
您是否保護了您的程式碼和韌體的真實性和完整性？
* 傳輸中 (in transit)
* 使用中 (in use)
* 靜態 (at rest)"

"**ID: CK-DP-03**
您是否確保了您的資料（例如輸入、命令和感測資料）的真實性和完整性？
* 傳輸中 (in transit)
* 使用中 (in use)
* 靜態 (at rest)
範例包括：
* 驗證傳入的內容類型 (content-types)。 
* 驗證回應類型 (response types)。 
* 驗證 HTTP 方法 (HTTP methods) 是否符合授權憑證。 
* 白名單允許的 HTTP 方法。 
* 定義可接受的字元集（例如 UTF-8）。 
* 驗證輸入的字元是可接受的。 
* 對輸入和輸出進行編碼/跳脫 (Encode/escape)。 "

"**ID: CK-DP-04**
您是否實施了存取控制以偵測和防止未經授權的資料存取和外洩，並過濾您的輸出？ "

#### 👨‍💻 開發人員重點提醒

* **這是對第 6.2.2 節的全面驗收：** 第 6.2.2 節要求您「保護具影響力的資料」，而本類別（DP-01, 02, 03）則詳細追問您如何保護「所有狀態」下的「所有類型」資料。

* **CK-DP-01 (敏感資料)：**
    * **傳輸中：** 這再次呼應 CK-NP-02，您是否使用了 TLS/DTLS？
    * **靜態：** 您的裝置是否對儲存在 Flash 上的敏感資料（如 Wi-Fi 密碼、用戶 PII）進行了加密？
    * **使用中：** 資料在 RAM 中處理時，是否能被其他非特權應用程式讀取？

* **CK-DP-02 (韌體/程式碼)：**
    * **靜態：** 儲存在 Flash 上的韌體是否加密？（這能防止駭客透過 JTAG 輕易讀出並逆向工程）。
    * **傳輸中：** 您的 OTA 韌體更新是否透過加密通道 (TLS) 下載？
    * **使用中：** 這呼應了 CK-FP-02 (安全啟動) 。您的系統是否在「使用」（運行）韌體之前，先驗證了它的「真實性和完整性」（即數位簽章）？

* **CK-DP-03 (輸入/命令)：**
    * 這點至關重要，是防範「注入式攻擊」(Injection Attacks) 的關鍵。
    * **您的責任：** 您**永遠不能**信任來自外部的任何輸入。客戶在問，您是否有對所有傳入的資料（例如來自雲端或 App 的 JSON/HTTP 命令）進行嚴格的「輸入驗證」。
    * **範例清單的意義：** 您是否只接受 `POST` 方法？您是否驗證了 `Content-Type` 是 `application/json`？您是否檢查了輸入字串中是否包含惡意的 `SQL` 或 `shell` 命令字元？
    * **「真實性」與「完整性」：** 您如何確保收到的命令（例如 "開鎖"）真的是來自合法的伺服器（真實性），並且在傳輸中沒有被竄改（完整性）？這需要數位簽章或 HMAC。

* **CK-DP-04 (防止外洩)：**
    * 您的裝置或後台系統，是否會不小心在「錯誤訊息」或「日誌」中洩漏了敏感資料（例如，輸出 "連線至 `admin:pa55w0rd@1.2.3.4` 失敗"）？
    * 您的系統是否有存取控制，確保只有被授權的 App/使用者才能讀取到特定的資料？

---

### 6. Access protection (存取保護)

#### 📝 原文翻譯 (來源 377, 379)

"**ID: CK-AP-01**
您是否採用了機制來管理和保護本地及/或遠端存取？
範例機制包括：
* 自動登出 (auto logoff)。
* 螢幕鎖定 (screen lock)。
* 登入嘗試之間設有延遲，並對重複的未經授權嘗試進行鎖定 (lock-out)。
* 強制重新授權 (forced re-authorisation)。"

"**ID: CK-AP-02**
您是否會針對具影響力的操作及/或警報（例如：憑證重設、安全更新失敗）發送頻外 (out-of-band) 通知？"

"**ID: CK-AP-03**
您是否實施了存取控制，以防止對系統介面、系統檔案和可移動媒體的未經授權存取？"

"**ID: CK-AP-04**
您是否採用了防篡改 (anti-tamper) 機制以進行抵抗、取證、偵測及/或回應？"

"**ID: CK-AP-05**
您是否支援對具影響力的操作（例如：憑證重設）進行多因子驗證 (multi-factor authentication)？"

#### 👨‍💻 開發人員重點提醒

* **這是對第 6.4.1 節的全面驗收：** 整個類別都在深入探討您如何實作 6.4.1 節的「適當存取控制」。
* **CK-AP-01 (防暴力破解)：**
    * 客戶在問：您的系統（無論是裝置上的 Web 介面，還是雲端登入頁面）是否有基本的防護機制？
    * **您的責任：** 您必須實作「登入失敗計數器」。在偵測到（例如）5 次連續失敗的登入嘗試後，您的系統必須「鎖定」該帳號或該 IP 位址一段時間（例如 15 分鐘）。這是防範暴力破解攻擊的**基本要求**。
* **CK-AP-02 (主動通知)：**
    * **什麼是「頻外 (out-of-band)」通知？** 這意味著通知是透過「獨立於主操作」的通道發送的。最常見的例子：當您在網站上重設密碼時，您的手機會收到一封電子郵件或簡訊。
    * **您的責任：** 您的後台系統必須與通知服務（Email, SMS, App 推播）整合。當發生「憑證重設」或「安全更新失敗」這類高風險事件時，您的系統必須能「主動通知」用戶，讓他們知道發生了什麼事。
* **CK-AP-03 (保護介面與檔案)：**
    * **系統介面：** 這再次呼應 6.4.1 節，您的 JTAG/UART 偵錯埠是否受到保護？
    * **系統檔案：** 您的裝置是否允許攻擊者讀取 `/etc/shadow` 或其他包含敏感設定的檔案？您是否實作了適當的檔案系統權限？
* **CK-AP-04 (防篡改)：**
    * 這更進一步。您的裝置硬體是否有（例如）外殼開啟偵測器？如果偵測到外殼被打開，裝置是否會自動清除金鑰？這在金流或高安全性設備上很常見。
* **CK-AP-05 (MFA)：**
    * 這再次呼應 6.4.1 節和 7.2.1 節。客戶在問：您是否「支援」MFA？ 作為開發人員，您必須在您的系統中（App、後台）建置好這個功能，營運方才有可能啟用它。

---

### 7. Security management (安全管理)

#### 📝 原文翻譯 (來源 379)

"**ID: CK-MT-01**
您是否採用了適當的使用者與密碼管理？
範例包括：
* 實施強密碼策略。
* 實施無預設密碼。
* 指定密碼過期時間。
* 確保密碼恢復和重設機制是安全的。"

"**ID: CK-MT-02**
您是否對管理功能實施了適當的存取控制？
範例包括：
* 實施最小權限原則 (least privilege policy)。
* 使用屬性型存取控制 (ABAC) 或角色型存取控制 (RBAC)。
* 對金鑰管理保護實施雙重控制 (dual control)，以防止單一不良行為者危害金鑰材料。
* 支援每個使用者和每個應用程式的精細存取權限 (granular access permissions)。
* 對金鑰管理系統實施職責分離 (separation of duties)，以防止單一不良行為者/管理員危害系統。"

"**ID: CK-MT-03**
您是否採用了惡意軟體緩解機制？
範例包括：
* 使用加密雜湊 (cryptographic hash) 確保檔案完整性。
* 建立「正常」行為的基線。
* 偵測未經授權的軟體。
* 監控裝置和流量。
* 掃描備份映像檔。
* 禁止不安全的開機載入程式 (bootloaders)。"

"**ID: CK-MT-04**
您是否確保了裝置（包括感測器閘道器）的遠端管理是安全的？
範例包括：
* 支援裝置應用程式和設定的安全 OTA (Over-The-Air) 更新。
* 支援使用密碼學安全方法的軟體及/或韌體更新。
* 支援平台完整性檢查，例如測量啟動 (measured boot) 機制或驗證韌體完整性。
* 限制遠端管理只能在安全的網路上進行。"

#### 👨‍💻 開發人員重點提醒

* **CK-MT-01 (密碼管理)：**
    * 這是對 6.4.1  和 7.2.1  節的再次驗收。客戶在問，您是否**強制**執行了強密碼策略（長度、複雜度），並且**絕不**使用預設密碼 。
    * **您的責任：** 您還必須實作「安全的」密碼重設機制（例如，透過頻外通知 ），並考慮加入「密碼過期」的強制輪換功能。

* **CK-MT-02 (權限管理)：**
    * **最小權限原則：** 這是核心。您的系統（裝置和後台）是否預設給予所有使用者「管理員」權限？或者，您是否實作了「角色」（RBAC）？例如，一個「訪客」角色只能查看，「使用者」角色可以操作，而「管理員」角色才能更改設定。
    * **精細權限：** 您的系統是否支援精細的權限？例如，管理員 A 只能管理裝置 1-10，管理員 B 只能管理裝置 11-20。
    * **金鑰管理：** 對於最高權限（例如存取金鑰），您是否實作了「雙重控制」？（例如，需要兩位管理員同時批准才能執行）。

* **CK-MT-03 (惡意軟體防護)：**
    * **禁止不安全的 Bootloader：** 這再次呼應 CK-FP-02 (安全啟動)。您的 Bootloader 必須是鎖定的，不能被用來載入惡意軟體。
    * **完整性檢查：** 您的裝置是否會在開機時，使用雜湊值 (hash) 檢查關鍵系統檔案或韌體是否被竄改？
    * **行為偵測：** 您的裝置或後台是否有能力建立一個「正常行為」的基線（例如，平均每小時傳輸 1KB 資料），並在偵測到異常行為（例如，突然開始每秒傳輸 1MB 資料到一個陌生 IP）時發出警報？

* **CK-MT-04 (安全 OTA)：**
    * 這是對 7.4.1 節的直接驗收 。客戶在問：您的 OTA 更新機制是否安全？
    * **您的責任：**
        1.  **加密傳輸：** OTA 更新包是否透過 TLS 下載？
        2.  **簽章驗證：** 裝置在安裝更新前，是否會驗證韌體的數位簽章（這呼應了 CK-FP-02 和 CK-DP-02）？
        3.  **平台完整性：** 您的裝置是否使用「測量啟動」（安全啟動的進階版），確保從開機到應用程式的每一步都是可信的？

---

### 8. Resiliency support (韌性支援)

#### 📝 原文翻譯 (來源 382)

"**ID: CK-RS-01**
您的裝置是否支援關鍵功能的完整性自我測試、錯誤偵測和校正，並能回復到安全狀態 (safe state)？"

"**ID: CK-RS-02**
您是否能防護一台被入侵的裝置，使其無法危害整個系統？
範例包括：
* 使用完美前向保密 (Perfect Forward Secrecy, PFS) 進行安全通訊。
* 為每台裝置使用不同的秘密金鑰。"

"**ID: CK-RS-03**
您是否採用了機制來應對因資源耗盡及/或惡意攻擊（如 DDoS）引起的故障？
範例包括：
* 監控以確保雲端資源足以維持服務。
* 偵測資源耗盡，以便及早採取預防或糾正措施。
* 控制資源密集型軟體的執行。
* 實施功率閾值。
* 限制並發會話 (concurrent sessions) 的數量。
* 以剩餘容量 (excess capacity) 運行。"

"**ID: CK-RS-04**
您是否定期執行系統資料（包括設定）的備份？"

#### 👨‍💻 開發人員重點提醒

* **這是對第 6.5 節和 7.5 節的全面驗收：** 客戶在問，您的系統是否真的具備「韌性」，也就是在遭受攻擊或發生故障時，是否還能「安全地運作」並「從中恢復」。
* **CK-RS-01 (安全地故障 Fail-Safely)：**
    * 這呼應了 7.5.1 節的「安全地應對故障」。客戶在問：您的裝置是否有「自我檢查」能力？
    * **您的責任：** 您必須實作例如「看門狗」(Watchdog Timer)、關鍵設定的「CRC/Checksum 檢查」。當裝置偵測到自身（例如韌體或記憶體）已損毀時，它**絕不能**繼續錯誤地運行（例如，門鎖不應在此時意外打開）。它必須能進入一個預先定義好的「安全狀態」（例如，保持上鎖並發出警報）。
* **CK-RS-02 (限制災損範圍)：**
    * 這是高階安全要求。客戶在問：如果我的一台裝置被駭，是否會導致我的整個系統崩潰？
    * **為每台裝置使用不同金鑰：** 這是**基本要求**。您必須為每台裝置都配置一個「唯一的」身份和金鑰（呼應 CK-IA-01）。如果您所有裝置都共用同一組金鑰，那麼駭客只要破解一台，就能偽造所有裝置。
    * **PFS：** 這是進階的密碼學功能。它能確保，即使駭客**今天**偷走了您裝置的長期金鑰，他也**無法**解密他**昨天**竊聽到的通訊流量。您（開發人員）的責任是確保您選用的 TLS 函式庫支援並啟用了 PFS 加密套件。
* **CK-RS-03 (防 DDoS)：**
    * 這是對 6.5.1 節的直接驗收 。客戶在問：您是否真的實作了防範資源耗盡的機制？
    * **您的責任：** 您的裝置軟體**必須**實作「限制並發會話的數量」（例如，Web 伺服器或 TCP 連線的上限）。您的系統也**必須**有「剩餘容量」，不能在正常運作時就佔用 95% 的 CPU 或 RAM。
* **CK-RS-04 (備份)：**
    * 這呼應了 7.5.1 節 。雖然「定期執行」是營運方的責任，但您（開發人員）**必須提供「能夠」備份的功能**。您的後台系統或閘道器是否提供了 API 或介面，讓營運方可以輕鬆地「匯出」(備份) 和「匯入」(還原) 所有系統和裝置的設定檔？ 

---

### 9. Security audit (安全稽核)

#### 📝 原文翻譯 (來源 382)

"**ID: CK-AU-01**
您的裝置和系統是否在稽核日誌中記錄了足夠的資訊（例如：誰、在何時、做了什麼）並標記重大事件？
事件範例包括：
* 使用者登入、登出和不成功的身份驗證嘗試。
* 連線、中斷連線嘗試和不成功的連線嘗試。
* 不成功的授權嘗試。
* 存取敏感資料。
* 從可移動媒體匯入和匯出資料。
* 存取權限的任何變更。
* 使用者建立、修改和刪除資料。
* 具影響力的操作。
* 遠端操作。
* 安全更新失敗。
* 可能的話，實體存取嘗試。
* 可能的話，緊急存取。"

"**ID: CK-AU-02**
您的稽核日誌是否受到保護，免於修改、刪除、實體篡改和敏感資料洩露？"

#### 👨‍💻 開發人員重點提醒

* **這是對第 6.4.2 節的直接驗收：** 第 6.4.2 節「提供稽核軌跡」是一個高階建議 ，而本類別則是客戶用來檢驗您「到底有沒有做到」的具體標準。
* **CK-AU-01 (該記什麼)：**
    * 客戶在問：您的日誌是否「足夠」？指南的範例清單就是「足夠」的最低標準。
    * **您的責任：** 您必須在實作階段就設計好日誌系統。您的程式碼**必須**在偵測到這些「重大事件」時，主動寫入一筆日誌。
    * **關鍵事件：** 「不成功的嘗試」（登入、連線、授權）對於偵測駭客活動至關重要。「具影響力的操作」（例如 6.4.1 提到的）和「安全更新失敗」（例如 7.4.1 提到的）也必須被記錄。
* **CK-AU-02 (如何保護日誌)：**
    * 記錄日誌只是第一步，保護日誌才是「問責性」的關鍵。如果駭客能輕易刪除或修改日誌，那日誌就毫無意義。
    * **您的責任：**
        1.  **防修改/刪除：** 裝置上的日誌應以「僅附加」(Append-Only) 模式寫入。最好的做法是將日誌「即時」且「安全地」（透過 TLS）傳輸到一個獨立的、高安全性的遠端日誌伺服器，裝置本身不儲存或只儲存暫存日誌。
        2.  **防洩露：** 日誌本身可能包含敏感資料（例如 IP 位址、使用者帳號）。因此，日誌在傳輸中必須加密（呼應 CK-NP-02），在遠端儲存時也應受嚴格的存取控制保護。

---

### 10. Lifecycle protection (生命週期保護)

#### 📝 原文翻譯 (來源 382, 384)

"**ID: CK-LP-01**
您是否已執行威脅建模，以識別、分析和緩解對系統的威脅？" 

"**ID: CK-LP-02**
您是否使用安全的系統工程方法來設計和開發系統？" 

"**ID: CK-LP-03**
您是否使用來自安全供應鏈的元件來實作和維護系統，確保沒有已知的未緩解漏洞？" 

"**ID: CK-LP-04**
您是否以簡單的語言及時地提供、傳達和更新安全資訊（服務條款、功能、指引、說明和通知等）？
安全資訊的範例包括：
* 安全政策。
* 安全更新。
* 裝置/媒體淨化 (sanitisation) 說明。
* 產品壽命終止 (End-of-life) 通知。
* 階段性淘汰 (Phase out) 計畫。" 

"**ID: CK-LP-05**
您是否確保系統在進入「營運」生命週期階段之前已經過強化 (hardened)？
系統強化的範例包括：
* 移除所有後門。
* 從發布版本中移除所有偵錯程式碼。
* 更改預設配置並停用不必要的服務。
* 在部署前移除或用防篡改覆蓋 JTAG、不需要的序列埠和通訊埠。
* 適當地強化 VM 主機，包括停用 VM 之間的記憶體共享。
* 移除預設和硬編碼 (hardcoded) 的密碼。" 

"**ID: CK-LP-06**
您是否在整個「營運」生命週期階段，維護一份連網裝置、軟體和韌體版本、已應用的修補程式和更新的清單？" 

"**ID: CK-LP-07**
您是否定期執行滲透測試及/或漏洞評估，並在每次重大發布前執行？" 

"**ID: CK-LP-08**
您是否建立了適當的漏洞揭露和管理機制？
範例包括：
* 確保供應鏈有能力提供升級和修補程式。
* 提供漏洞揭露機制，以及時追蹤和回應的流程。
* 及時為發現的漏洞提供韌體和軟體修補程式/更新。
* 採用適當的變更管理流程來管理安全修補或更新。
* 在適當情況下，通知及/或允許使用者批准/拒絕更新、以及對使用者設定的變更。
* 揭露最低支援期限。" 

"**ID: CK-LP-09**
您是否確保身份、憑證和秘密（secrets）在整個生命週期（例如：建立、配置、更新和撤銷）中都是安全的？" 

"**ID: CK-LP-10**
您是否在裝置和系統進入「重複使用或丟棄」生命週期階段之前，清除了其中的安全資料和敏感使用者資料？" 

#### 👨‍💻 開發人員重點提醒

* **這是對您（開發商）「整個營運成熟度」的總體檢。** 客戶在問：您是否有一套完整、專業、且貫穿始終的安全流程？
* **CK-LP-01 (威脅建模)：** 這是對第 8 節的直接驗收。您是否在開發之初就執行了威脅建模？  如果回答「N」，代表您的安全設計可能是隨機且不可靠的。
* **CK-LP-03 (安全供應鏈)：** 您的責任不僅在於您「自己寫的程式碼」。您是否有管理您使用的「第三方函式庫」和「硬體元件」？您是否知道您用的 Wi-Fi 晶片或 TCP/IP 堆疊有已知的漏洞？
* **CK-LP-05 (系統強化)：** 這是您（開發人員）在裝置「出廠前」的最後一道防線。您**必須**移除所有偵錯工具。
    * **移除 JTAG/UART：** 這是 6.4.1 節「實體存取」的具體實作。 
    * **移除偵錯程式碼/後門：** 這是基本要求。
    * **移除預設/硬編碼密碼：** 這是 6.4.1 和 7.2.1 節的最核心要求。 
* **CK-LP-06 (資產清單)：** 這是 7.4.1 節「裝置管理」的基礎。  您的後台系統**必須**有能力追蹤每一台裝置的韌體版本，否則您將無法管理更新。 
* **CK-LP-07 (定期滲透測試)：** 這是 7.5.2 節的驗收。  客戶在問您是否會「主動」且「定期」地測試自己，而不是被動等待被駭。 
* **CK-LP-08 (漏洞管理)：** 這是您作為開發商的「售後承諾」。
    * **揭露最低支援期限：** 這是對客戶最重要的一點。您必須誠實地承諾：「本產品自上市起，我保證提供安全更新至少 X 年。」
    * **及時提供修補程式：** 這是 7.4.1 節的具體實踐。 
* **CK-LP-09 (金鑰生命週期)：** 這是 CK-CS-02 的再次強調。您是否在裝置「生產時」安全地灌錄金鑰？在裝置「報廢時」安全地「撤銷」其憑證？ 
* **CK-LP-10 (資料清除)：** 這是 7.5.1 節「恢復」的延伸。您的裝置是否提供了一個可靠的「恢復原廠設定」功能，能「徹底清除」所有使用者資料和金鑰，以便裝置可以被安全地丟棄或轉售？ 


