## 5.3 – 保持軟體更新 (KEEP SOFTWARE UPDATED)

### 條款 7.3-6 (Provision 7.3-6)

若家庭閘道器 (HG) 明確支援第三方軟體的安裝，則必須向管理者顯示清晰的警告，並要求取得管理者的同意。

預設情況下，配置中不得啟用第三方軟體的安裝功能。

#### 最低要求 (Minimum Requirements)

* 設備的配置預設**不得**允許安裝第三方軟體。
* 若啟用此配置，設備必須清楚顯示以下內容：
    * 向管理者發出關於安裝第三方軟體風險的**警告 (Warning)**。
    * 請求管理者的**同意 (Consent)**。
    * 在安裝前要求輸入管理者的同意（例如：點擊確認、輸入密碼等）。
* 路由器必須具備**還原功能 (restore functionality)**，該功能將完全移除所有第三方軟體及其配置與數據，同時確保原始的使用者設定檔與安全性修補程式得以保留。

#### 佐證證據 (Supporting Evidence)

* 開發商應提供證據（例如：路由器 GUI 入口網站的截圖或影片、使用者手冊等），顯示安裝第三方軟體的功能在配置中**預設是未啟用**的。
* 開發商應提供證據（例如：路由器 GUI 入口網站的截圖或影片、使用者手冊等），顯示若使用者試圖安裝第三方軟體，路由器會清楚呈現**給管理者的警告**、**請求管理者同意**，以及在安裝前**要求輸入同意**。
    * 此警告的範例包括但不限於：
        * 彈出式通知 (Pop-up notification)。
        * 橫幅通知 (Banner notification)。
        * 確認對話方塊 (Confirmation dialog box)。
* 開發商亦應提供證據（例如：路由器 GUI 入口網站的截圖或影片、使用者手冊等）展示**還原功能**，證明其能完全移除所有第三方軟體，同時確保原始使用者設定檔與安全性修補程式得以保留。

#### 評估 (Assessment)

* 評估人員將檢查第三方軟體的安裝是否預設為停用。
* 評估人員將檢查在安裝第三方軟體之前，路由器是否清楚呈現給管理者的警告、請求管理者同意，以及在安裝前要求輸入同意。
* 評估人員將檢查還原功能是否滿足必要的要求（即移除第三方軟體但保留原始設定）。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款主要針對支援 **Docker 容器**、**LXC**、或 **OpenWrt 套件 (OPKG)** 等擴充功能的進階閘道器。如果您的設備是功能固定的封閉式系統（無法安裝 App 或 Plugin），此條款通常不適用。

1.  **預設關閉與風險告知**：這類似 Android 的「安裝未知來源應用程式」權限。廠商不能假設使用者知道安裝第三方套件的風險（如後門、挖礦程式），必須設立明確的 UI 阻力（Friction）。
2.  **特殊的「還原」邏輯**：這是技術上最困難的一點。標準的「恢復原廠設定 (Factory Reset)」會清除所有數據（包含使用者設定的 PPPoE 帳號、Wi-Fi 密碼）。但這裡要求的是一種**「部分重置 (Partial Reset)」**——只殺掉第三方外掛，但保留使用者原本的上網設定。這需要精細的檔案系統管理。

#### 具體落地實現方案建議

* **系統設計與架構調整**：
    * **檔案系統隔離 (Filesystem Isolation)**：
        * 建議利用 **OverlayFS** 或獨立的 **Partition** 來存放第三方軟體。
        * 當執行「移除第三方軟體」功能時，只需卸載並格式化該 Overlay 層或 Partition，而不影響存放 `/etc/config/` 的主要使用者設定層。
    * **安裝流程 UI/UX**：
        * 設計一個「啟用第三方支援」的總開關。
        * 當使用者將開關從 OFF 切到 ON 時，彈出全螢幕或模態視窗 (Modal)，列出免責聲明，並要求使用者勾選「我了解風險」並點擊「確認啟用」。

* **證據收集策略**：
    * **警告視窗截圖**：這很直觀，截取上述的風險告知視窗即可。
    * **「部分重置」的驗證影片**：
        * 由於「還原」功能涉及前後狀態的變化，建議錄製影片：
            1.  展示目前已安裝一個第三方 App (如 AdGuard)。
            2.  展示目前 Wi-Fi SSID 為 "MyHome"。
            3.  執行「移除第三方軟體」功能。
            4.  重開機後，展示 AdGuard 不見了，但 Wi-Fi SSID 仍然是 "MyHome"（證明使用者設定未遺失）。

* **測試與驗證**：
    * **破壞性測試**：QA 安裝一個會佔用大量 CPU 或寫入大量 Log 的惡意第三方軟體，然後執行此還原功能，確認系統能乾淨地恢復到「乾淨但已設定好網路」的狀態。

---
[回到 5.3 – 保持軟體更新 (KEEP SOFTWARE UPDATED)](./5.3-keep-software-updated.md)
