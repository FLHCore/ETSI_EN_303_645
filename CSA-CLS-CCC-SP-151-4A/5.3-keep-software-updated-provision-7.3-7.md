## 5.3 – 保持軟體更新 (KEEP SOFTWARE UPDATED)

### 條款 7.3-7 (Provision 7.3-7)

家庭閘道器 (HG) 的製造商與軟體供應商在向公眾發布更新套件之前，必須對其進行簽章 (sign)。

#### 最低要求 (Minimum Requirements)

* Home Gateways 的製造商與軟體供應商在將更新套件提供給大眾之前，必須使用其密碼學簽章對更新套件進行**數位簽章 (digitally sign)**。
* 更新必須使用數位簽章進行簽章，且需採用 **NIST SP 800-131A** 中提及的**認可密碼學演算法**（例如：RSA-4096-SHA512 等）。

#### 佐證證據 (Supporting Evidence)

* 開發商應宣告在發布更新套件給公眾之前，用於簽署該套件的**密碼學演算法**。

#### 評估 (Assessment)

* 評估人員將檢查開發商宣告的密碼學演算法是否**未被棄用 (not deprecated)**，且符合 NIST SP 800-131A。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款與 **Provision 7.3-1 (預載公鑰)** 是成對的。7.3-1 要求設備端要有鎖頭（公鑰），而本條款 (7.3-7) 則要求開發端必須打造對應的鑰匙（私鑰簽章）。

1.  **程式碼簽章 (Code Signing) 的強制性**：這不再是選配功能。所有釋出的韌體映像檔 (Firmware Image) 或更新包 (Patch)，都必須經過私鑰簽署。
2.  **演算法強度要求**：
    * 必須符合 **NIST SP 800-131A**。
    * **禁止使用**：MD5, SHA-1, RSA-1024。
    * **推薦使用**：RSA-3072 或更高 (如 RSA-4096)，ECDSA P-256 或更高，搭配 SHA-256 或 SHA-512。
3.  **供應鏈安全的意涵**：這意味著您的 Build Server 或 Release Pipeline 必須整合簽章流程，且私鑰必須受到嚴格保護（如存放在 HSM 或限制存取的 CI/CD 環境中）。

#### 具體落地實現方案建議

* **系統設計與流程建立**：
    * **簽章工具**：使用業界標準工具如 OpenSSL 或 GPG。
    * **指令範例 (OpenSSL)**：
      `openssl dgst -sha512 -sign private_key.pem -out firmware.sig firmware.bin`
    * **演算法選擇**：為了長久合規，建議直接採用 **RSA-4096** 搭配 **SHA-512**。這在佐證證據中會是非常強而有力的宣告。
    * **版本發布流程**：
        1.  編譯韌體。
        2.  計算 Hash。
        3.  使用私鑰對 Hash 加密（簽章）。
        4.  將簽章附加在韌體檔尾或作為獨立檔案發布。

* **證據收集策略**：
    * **演算法宣告書**：由於此條款的佐證證據主要是「宣告 (Declare)」，建議準備一份正式的 PDF 文件，標題為 "Cryptographic Algorithms Declaration for Firmware Updates"。
    * **內容範例**：
        > "We hereby declare that all firmware update packages for Model X are digitally signed using **RSA-4096** with **SHA-512** hashing algorithm, which complies with NIST SP 800-131A."
    * **補充證據 (加分項)**：雖然未強制，但提供一張 Build Server 的 Log 截圖，顯示 `openssl dgst -sign ...` 的執行過程，能增加可信度。

* **測試與驗證**：
    * **驗證簽章有效性**：QA 應使用對應的公鑰手動驗證簽章檔。
      `openssl dgst -sha512 -verify public_key.pem -signature firmware.sig firmware.bin`
    * **確保輸出 "Verified OK"**。這證明了簽章流程是正確運作的。

---
[回到 5.3 – 保持軟體更新 (KEEP SOFTWARE UPDATED)](./5.3-keep-software-updated.md)
