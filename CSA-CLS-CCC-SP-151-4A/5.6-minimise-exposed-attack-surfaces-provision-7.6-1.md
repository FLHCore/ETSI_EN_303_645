## 5.6 - 最小化暴露的攻擊面 (MINIMISE EXPOSED ATTACK SURFACES)

### 條款 7.6-1 (Provision 7.6-1)

在交付前，任何開發期間用於除錯目的的實體介面，必須從設備上永久停用（或實體移除）。

#### 最低要求 (Minimum Requirements)

* 開發商必須確保任何開發期間用於除錯目的的實體介面，在交付前已從設備上停用。

#### 佐證證據 (Supporting Evidence)

* 開發商應宣告用於除錯目的的實體介面清單，並描述在交付前如何將其停用（實體或邏輯上）或移除。
* 範例包括但不限於：
    * 實體移除除錯介面（例如：熔斷 JTAG 保險絲）。
    * 保險絲或一次性可程式化 (OTP) 位元。
    * 韌體或 BIOS 配置。
    * 透過軟體手段。

#### 評估 (Assessment)

* 評估人員將檢查用於除錯目的的實體介面清單是否完整，並確認其在交付前是否已被停用（實體或邏輯上）或移除。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款針對的是**硬體除錯介面 (Hardware Debug Interfaces)**，如 **UART (Serial Console)** 和 **JTAG**。

1.  **駭客的實體後門**：
    * 對於攻擊者來說，拆開外殼接上 UART 是取得 Root Shell 最快的方法。如果您的產品在 PCB 板上還留著 4-pin 排針 (VCC, RX, TX, GND) 且一開機就吐出 U-Boot Log 甚至直接進入 Shell，這絕對是不合規的。
2.  **永久停用 (Permanently Disabled)**：
    * 條款強調「永久」。這意味著不能只是一個「隱藏開關」。
    * 最佳解法是**物理移除**（PCB 上不焊排針）加上**邏輯封鎖**（軟體不輸出）。

#### 具體落地實現方案建議

* **硬體設計調整**：
    * **不打件 (DNP - Do Not Populate)**：在生產 BOM 表中，將 UART/JTAG 的排針接頭設為 DNP。PCB 上只留焊盤 (Pad) 或測試點 (Test Point)，不要焊上公母頭。
    * **線路切斷**：更進階的做法是在 PCB Layout 時，將除錯訊號線路設計為需透過特定電阻連接（0歐姆電阻），量產時不焊該電阻。

* **軟體/韌體調整**：
    * **U-Boot/Bootloader**：設定 `bootdelay=0` 或 `-2` (禁止中斷開機)，並關閉 Console 輸出 (`silent=1`)。
    * **Linux Kernel**：在 Cmdline 中移除 `console=ttyS0`，確保 Kernel Log 不會吐出，且不會生成登入 Shell (`getty`)。
    * **SoC 安全設定**：利用 eFuse 將 JTAG 功能永久燒斷 (JTAG Disable Bit)。這是防禦硬體層級除錯的最強手段。

* **證據收集策略**：
    * **PCB 高清照片**：拍攝 PCBA 的正反面，特寫 UART/JTAG 區域，證明上面沒有焊接排針。
    * **啟動錄影/Log**：
        * QA 嘗試焊接線材到 UART 測試點，接上電腦。
        * 錄影顯示：開啟電源後，終端機畫面**一片漆黑**（無任何輸出），或者輸出全是亂碼（加密/混淆）。

* **測試與驗證**：
    * **JTAG 探測**：使用 J-Link 等工具嘗試連接 CPU，應顯示連接失敗或無法識別目標 (Target not found)。

---
[回到 5.6 Minimise Exposed Attack Surfaces](./5.6-minimise-exposed-attack-surfaces.md)