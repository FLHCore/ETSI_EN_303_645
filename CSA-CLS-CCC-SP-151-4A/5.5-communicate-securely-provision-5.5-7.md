## 5.5 – 安全通訊 (COMMUNICATE SECURELY)

### 條款 5.5-7 (Provision 5.5-7)

消費型物聯網設備必須保護透過遠端可存取網路介面通訊的關鍵安全參數之機密性。

(若設備不具備遠端存取功能，則本條款不適用。)

#### 最低要求 (Minimum Requirements)

* 對於具備遠端存取功能的設備，通訊（傳輸）必須透過 **TLS 1.2** 或更高版本進行，並搭配可接受的加密套件（參考 NIST SP 800-52）。
* 對於 **Wi-Fi 路由器**，設備的遠端存取功能必須**預設停用 (disabled by default)**（即：當使用者首次開啟設備電源時，此功能應為停用狀態）。
    * 若 Wi-Fi 路由器需要遠端存取功能（例如：TR-069 等）才能運作/操作，開發商必須取得 **IMDA 的豁免 (waiver)**。
    * 當這些功能啟用時，其通訊必須透過 **TLS 1.2** 或更高版本進行。

#### 建議 (Recommendation)

* 即使在 CLS(IoT) 下並非強制要求（Wi-Fi 路由器除外），仍建議將遠端存取功能**預設停用**。

#### 佐證證據 (Supporting Evidence)

* 對於具備遠端存取功能的設備，開發商應提供證據（例如：**Wireshark 截圖**等），顯示通訊是透過搭配可接受加密套件的 TLS 1.2 或更高版本進行（參考 NIST SP 800-52）。
* 對於 Wi-Fi 路由器，開發商應宣告設備的遠端存取（例如：TR-069 等）是否預設為停用。
    * 若必須啟用遠端存取功能才能運作，開發商應提交從 **IMDA 取得的豁免**。
* 此外，對於 Wi-Fi 路由器，開發商應提供證據（例如：**Wireshark 截圖**等），顯示設備的遠端存取功能是透過搭配可接受加密套件的 TLS 1.2 或更高版本進行通訊（參考 NIST SP 800-52）。
* 關於 TLS 的實作，請參考 **Annex B** 以獲得更多資訊。

#### 評估 (Assessment)

* 評估人員將檢查遠端存取通訊是否至少透過 TLS 1.2 進行，並使用可接受的加密套件。
* 對於 Wi-Fi 路由器，評估人員將檢查遠端存取功能是否預設為停用。
    * 若必須啟用以利設備運作，評估人員將檢查開發商是否已取得 IMDA 的豁免。
* 此外，對於 Wi-Fi 路由器，評估人員將檢查設備的遠端存取功能是否透過搭配可接受加密套件的 TLS 1.2 或更高版本進行通訊。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款針對的是 **WAN 端管理 (Remote Management)** 的安全性。

1.  **預設關閉 WAN Access**：
    * 這是家用路由器最常見的攻擊向量。駭客掃描全網 IP 的 Port 80/443，嘗試登入暴露在公網的管理介面。
    * **合規紅線**：市售版路由器出廠時，**WAN Port 的 HTTP/HTTPS/SSH 服務必須是關閉的**。使用者必須在 LAN 端登入後，手動勾選「啟用遠端管理」才能開啟。
2.  **ISP 設備的兩難與豁免**：
    * 如同 7.3-4 提到的，ISP 設備通常需要 TR-069 預設開啟以便維運。
    * 這與「預設停用」的要求衝突。因此，如果您是做 ISP 案子，請務必提醒 PM 去申請 **IMDA Waiver**。沒有這張紙，產品無法過關。
3.  **加密強度不打折**：
    * 即使使用者手動開啟了遠端管理，該介面也**必須強制走 HTTPS (TLS 1.2+)**。絕不允許在 WAN 端暴露明文的 HTTP 管理介面。

#### 具體落地實現方案建議

* **系統設計與防火牆規則**：
    * **ACL 綁定介面**：
        * Web Server (uhttpd/nginx) 的 Listener 預設應只綁定 LAN Bridge IP (如 `192.168.1.1`)，而不綁定 WAN IP。
        * 或者，透過 iptables 在 WAN INPUT Chain 預設 DROP Port 80/443/22。
    * **UI 防呆設計**：
        * 當使用者嘗試開啟「遠端管理」時，系統應強制要求更改預設密碼（如果還沒改過），並強烈建議使用高強度密碼，因為這將直接面對網際網路的攻擊。

* **證據收集策略**：
    * **預設狀態驗證**：
        * **步驟**：Factory Reset 後，從 WAN 端 (模擬外部網路) 用 Nmap 掃描 WAN IP。
        * **截圖**：顯示 Port 80/443/8080 都是 `Closed` 或 `Filtered`。這是證明「預設停用」最強力的證據。
    * **TLS 抓包**：
        * 手動開啟遠端管理後，從外部網路連線，並使用 Wireshark 抓包。
        * 截取 `Client Hello` / `Server Hello`，證明協定是 TLS 1.2/1.3。

* **測試與驗證**：
    * **Shodan 模擬測試**：
        * 想像您的設備被 Shodan 掃描。QA 應確保在預設設定下，設備不會回應任何 Banner 資訊，完全「隱形」。
    * **證書檢查**：
        * 對於遠端管理介面，由於沒有固定 Domain，通常使用自簽憑證。確保這個自簽憑證的 Key Length 足夠 (RSA-2048+)，否則會違反 Cipher Suite 的要求。