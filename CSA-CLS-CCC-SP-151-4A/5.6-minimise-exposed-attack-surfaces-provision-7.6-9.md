## 5.6 - 最小化暴露的攻擊面 (MINIMISE EXPOSED ATTACK SURFACES)

### 條款 7.6-9 (Provision 7.6-9)

若家庭閘道器 (HG) 支援 Wi-Fi 與訪客 Wi-Fi 的存取控制 (access control)，則存取控制列表 (access control lists, ACLs) 必須由本地管理者或遠端 ISP 管理者進行管理。

#### 最低要求 (Minimum Requirements)

* 主機 Wi-Fi 與訪客 Wi-Fi 的存取控制列表配置，必須**僅限**由已認證的本地管理者或遠端 ISP 管理者存取。

#### 佐證證據 (Supporting Evidence)

* 開發商應提供證據（例如：截圖、影片、使用者手冊等），顯示僅有已認證的本地管理者或遠端 ISP 管理者有能力管理 Wi-Fi 與訪客 Wi-Fi 的存取控制列表。
* 證據應透過下列介面/管道展示（但不限於）：
    * 家庭閘道器的 Web GUI
    * 行動應用程式
    * 技術文件

#### 評估 (Assessment)

* 評估人員將檢查並確認主機 Wi-Fi 與訪客 Wi-Fi 的 ACL 配置，僅限由已認證的本地管理者或遠端 ISP 管理者存取。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款針對的是 **MAC 過濾 (MAC Filtering)** 或 **黑白名單 (Block/Allow List)** 功能的權限保護。

1.  **防止權限繞過**：
    * 如果您的路由器允許「家長監護 (Parental Control)」或「封鎖裝置」功能。
    * **情境**：被封鎖的小孩（或訪客）不應該能夠進入管理頁面把自己「解鎖」。
    * **合規要求**：這些名單的「新增/刪除/修改」API，必須嚴格檢查 Admin 權限。
2.  **訪客網路的管理權**：
    * 訪客網路的使用者（Guest）通常沒有管理權限。因此，他們不應該能看到「誰連在訪客網路上」，更不能踢掉其他訪客。這項權利保留給 Router 的 Owner (Admin)。

#### 具體落地實現方案建議

* **系統設計與 API 保護**：
    * **API 權限檢查**：
        * 針對 `/api/wireless/acl` 或 `/api/parental_control` 的 POST/DELETE 請求。
        * 必須驗證 `Session Token` 有效且 `Role == Admin`。
    * **App 端設計**：
        * 如果您的 App 支援「遠端管理」，確保 App 與 Cloud 之間的驗證機制（如 OAuth2 Token）具備足夠的權限分級。

* **證據收集策略**：
    * **管理介面截圖**：
        * 截取 Web GUI 中的「存取控制」或「MAC 過濾」頁面。
        * 重點在於畫面必須包含「登出」按鈕或右上角的「Admin」字樣，證明這是在登入狀態下才能看到的。
    * **權限測試截圖**：
        * 嘗試在未登入狀態下直接存取該頁面的 URL（例如 `/wireless_acl.html`）。
        * 截取被導回登入頁或顯示 "Access Denied" 的畫面。

* **測試與驗證**：
    * **越權刪除測試**：
        * QA 先用 Admin 帳號設定一個 MAC 黑名單。
        * 登出 Admin。
        * 嘗試用 Guest 權限（或未登入）發送刪除該 MAC 的 API 請求。
        * **預期結果**：Server 回傳 403 Forbidden，且黑名單未被刪除。