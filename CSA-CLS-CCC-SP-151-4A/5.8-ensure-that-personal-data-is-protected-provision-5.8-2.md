## 5.8 – 確保個人數據受保護 (ENSURE THAT PERSONAL DATA IS PROTECTED)

### 條款 5.8-2 (Provision 5.8-2)

在設備與相關服務之間傳輸的敏感個人數據 (sensitive personal data)，其機密性必須受到保護，並使用符合技術屬性與使用情境的適當密碼學技術。

#### 最低要求 (Minimum Requirements)

* 設備與相關服務之間的敏感使用者數據通訊，必須透過 **TLS 1.2** 或更高版本進行，並搭配可接受的加密套件（參考 NIST SP 800-52）。

#### 佐證證據 (Supporting Evidence)

* 開發商應提供一份清單，列出所有可能傳輸敏感使用者數據的管道，並提供證據（例如：**Wireshark 截圖**等）顯示該通訊是安全的。
    * 在可能的情況下，開發商應標明來源與目的 IP 位址。
* 此外，開發商亦應宣告用於加密所收集和/或傳輸數據的**密碼學演算法**。
* 關於 TLS 的實作，請參考 **Annex B** 以獲得更多資訊。

#### 評估 (Assessment)

* 評估人員將檢查用於傳輸設備所收集數據的通訊（傳輸通道）是否安全。
* 評估人員亦將檢查用於加密敏感使用者數據的密碼學演算法是否符合 NIST SP 800-131A。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款將安全通訊的要求範圍，從「憑證（密碼）」擴大到了**「敏感個人數據」**。這是一個關鍵的轉折點，因為它要求開發者重新審視所有傳輸的資料內容。

1.  **什麼是「敏感個人數據」？**
    * 在 IoT 情境下，這不僅限於 PII (如姓名、電話)，還包含能反映使用者生活模式的數據：
        * **即時影像/音訊** (Video/Audio Streams)
        * **設備使用紀錄** (Telemetry: 什麼時候開燈、什麼時候開門)
        * **位置資訊** (GPS 座標)
        * **健康數據** (心率、步數)
    * **核心要求**：所有這些資料在傳輸到雲端或 App 時，都必須如同傳輸密碼一樣，強制使用 **TLS 1.2+** 加密。
2.  **不只 HTTP，所有協定都要加密**：
    * 許多開發者習慣將 Web API 加上 HTTPS，但對於影像串流 (RTSP) 或輕量級訊息 (MQTT/CoAP) 卻忽略了。
    * **紅線**：明文的 RTSP、明文的 MQTT (Port 1883)、明文的 UDP Log Upload，在此條款下皆屬違規。

#### 具體落地實現方案建議

* **系統設計與協定選擇**：
    * **影像串流安全化**：
        * 若使用 RTSP，必須升級為 **RTSPS** (RTSP over TLS)。
        * 若使用 WebRTC，天生已強制加密 (DTLS-SRTP)，符合要求。
        * 若使用 P2P 方案 (如 TUTK, Kalay)，需確認其底層通道是否使用 AES-128 以上加密。
    * **遙測數據 (Telemetry) 通道**：
        * 確保所有上傳 Log 的 Agent (如 Fluentd, Logstash client) 配置了 SSL/TLS 憑證。

* **證據收集策略**：
    * **數據流盤點表 (Data Flow Inventory)**：
        * 建立一份表格，列出所有數據類型及其傳輸方式。
        * 範例：`Video Stream` -> `RTSPS (TLS 1.2)` -> `AES-128`.
    * **Wireshark 驗證截圖**：
        * 針對每一種敏感數據流進行抓包。
        * **關鍵畫面**：證明傳輸協定顯示為 `TLSv1.2` 或 `TLSv1.3`，且 Payload 是無法辨識的亂碼 (Application Data)。
        * **IP 標示**：截圖中需標註 Source IP (Device) 與 Destination IP (Cloud Server)，證明這是正確的通訊流。

* **測試與驗證**：
    * **中間人攻擊 (MitM) 模擬**：
        * QA 架設一個未加密的接收伺服器 (如 Mock Server)。
        * 修改設備 DNS 或 Config，使其指向該偽造伺服器。
        * **預期結果**：設備應拒絕連線，因為 Handshake 失敗或憑證無效。
    * **混合內容檢查 (Mixed Content)**：
        * 檢查 App 或 Web 頁面，是否在 HTTPS 頁面中嵌入了 HTTP 的圖片或 API 請求（這會導致瀏覽器警告並違反此條款）。