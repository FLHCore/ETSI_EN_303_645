## 5.1 – 禁用通用預設密碼 (NO UNIVERSAL DEFAULT PASSWORDS)

### 條款 5.1-1 (Provision 5.1-1)

在任何非出廠預設的狀態下，若有使用密碼，所有消費型物聯網設備的密碼應為每台設備獨一無二 (unique per device)，或由使用者自行定義。

對於家庭閘道器 (Home Gateway, HG)，若 Wi-Fi® 或管理者密碼是在出廠預設中預先配置的，這些預先配置的密碼必須是每台 HG 獨一無二的。

#### 最低要求 (Minimum Requirements)

* 用於認證介面（例如：Telnet、FTP、SSH、設備管理者入口網站、行動應用程式等）的出廠預載/預配置密碼/PIN 碼必須是**每台設備獨一無二**的，亦即同一型號的不同單元擁有不同的出廠預載密碼/PIN 碼。
* 如果出廠預載/預配置密碼/PIN 碼**不是**獨一無二的，設備必須**強制**使用者在初始化時定義新的密碼/PIN 碼。
    * 在更改出廠預載密碼/PIN 碼之前，設備**不得**進入可操作狀態。
* 如果設備沒有預載/預配置密碼/PIN 碼，設備應保持在禁用（非功能性）狀態，直到使用者定義密碼/PIN 碼為止。
* 對於 HG，密碼應符合 **IMDA TS RG-SEC** 定義的密碼要求。要求如下：
    * 密碼長度至少應為 **10**，且必須滿足以下 4 項複雜度規則中的至少 2 項：
        1.  至少 1 個大寫字元 (A-Z)
        2.  至少 1 個小寫字元 (a-z)
        3.  至少 1 個數字 (0-9)
        4.  至少 1 個特殊字元（標點符號和/或空白）
    * 密碼不得有連續相同的字元。
    * 登入 ID 和密碼中使用的值不得相同。
    > (註：這些要求適用於在 IMDA 註冊並打算在新加坡銷售的 HG。否則，HG 應符合 NIST SP 800-63B 數位身分指引中定義的密碼要求。)

#### 佐證證據 (Supporting Evidence)

* 開發商應列出設備所有的認證機制（例如：Telnet、FTP、透過乙太網路埠的 SSH、設備管理者入口網站、行動應用程式、藍牙等）。
* 開發商亦應提供 **NMAP 掃描**結果，以顯示設備上所有開啟的連接埠（適用於 LAN 和 WAN 介面）及相關服務。
    * 連接埠掃描可使用 `nmap -sT -sU -A -p- <ip address>` 執行。
* 開發商應提供證據（例如：使用者手冊、截圖、影片等）以展示或描述設備的設定流程，以及提供給使用者以完成設備初始化的指引（例如：帳號註冊/建立、新增或配對設備等）。

#### 評估 (Assessment)

* 評估人員將檢查 NMAP 掃描結果（適用於 LAN 和 WAN 介面），以判斷開發商提供的認證機制清單是否準確。
* 對於具有非獨一無二預載密碼/PIN 碼的設備，評估人員將檢查設備是否要求使用者在初始化時定義新的密碼/PIN 碼。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

這一條款是許多 IoT 設備最常失敗的地方，特別是針對「新加坡市場」的特殊合規性。

1.  **徹底告別 `admin/admin`**：這是絕對紅線。您有兩條路可選：
    * **路徑 A（硬體成本較高）**：每台機器燒錄不同的隨機密碼，並印在機身貼紙上（Unique per device）。
    * **路徑 B（軟體邏輯較嚴）**：出廠使用通用密碼（或無密碼），但 **首次開機 (OOBE)** 必須強制使用者改密碼，否則機器功能全鎖。
2.  **IMDA 特有的密碼複雜度**：請特別注意，這裡要求 **最少 10 個字元**。這比許多通用的 8 字元要求更嚴格。如果您的 App 前端或 Gateway 後台還在用 `min-length=8` 的檢查邏輯，在新加坡這關會直接 Fail。
3.  **「誠實」的端口管理**：評估方法明確要求使用 `NMAP` 進行全端口掃描 (`-p-` 掃描 1-65535 port)。這意味著開發者不能抱持僥倖心態隱藏 Debug Port (如 Telnet/SSH)。任何被掃出來 Open 的 Port，都必須解釋其認證機制。

#### 具體落地實現方案建議

* **系統設計調整方向**：
    * **強制重置流程 (Forced Reset UI)**：
        * 設計一個「初始化狀態 (Uninitialized State)」。在此狀態下，任何 API call (除了改密碼 API) 都應回傳錯誤（例如 HTTP 403/412），直到密碼被修改。
        * Web GUI 或 App 必須攔截此狀態，並跳出強制修改密碼的視窗，且**不能有「略過」按鈕**。
    * **密碼強度驗證器 (Validator)**：
        * 更新您前端 (App/Web) 與後端 (Gateway Firmware) 的 Regex 規則。
        * 規則範例（需同時滿足）：
            1.  `length >= 10`
            2.  包含 (大寫, 小寫, 數字, 特殊符號) 中的兩項。
            3.  檢查連續字元 (如 `aa`, `11` 不允許)。
            4.  檢查 `Password != UserID`。

* **資料流程與權限設計重點**：
    * **生產線燒錄 (Provisioning)**：如果選擇「每機一密」，需調整產線流程，產生隨機字串 -> 寫入 Flash -> 生成對應 QR Code/貼紙 -> 貼上外殼。資料庫需記錄這組對應關係以備客服查詢（需注意這涉及資安風險，通常不建議雲端明文儲存）。

* **技術與測試配套措施**：
    * **自我掃描**：在提交審查前，QA 團隊**務必**使用與規範相同的指令 `nmap -sT -sU -A -p- <Device_IP>` 掃描您的設備。
        * 確認沒有遺留的工廠測試 Port (如 ADB, Telnet)。
        * 確認開啟的服務 (如 port 80, 443, 8080) 都有對應的密碼保護，且符合上述密碼策略。
    * **證據準備**：
        * 截取「輸入 `123456` 顯示失敗」的畫面。
        * 截取「輸入符合複雜度要求的密碼顯示成功」的畫面。
        * 截取 `NMAP` 的原始 Log 檔。

---
[回到 5.1 No Universal Default Passwords ](./5.1-no-universal-default-passwords.md)
