## 5.3 – 保持軟體更新 (KEEP SOFTWARE UPDATED)

### 條款 5.3-16 (Provision 5.3-16)

消費型物聯網設備的型號名稱必須清晰可辨，可透過設備上的標籤或實體介面識別。

軟體版本號**僅限**由管理者或區域網路 (LAN) 上的已認證使用者檢索。

#### 最低要求 (Minimum Requirements)

* 產品標籤必須清楚顯示設備的**型號名稱**（例如：品牌、產品名稱、型號、產品編號等）。
* 設備必須具備**唯一識別碼 (unique identifier)**，讓使用者能將該設備與相似設備區分開來。
* 設備必須具備**存取控制策略 (access control policies)**，確保只有管理者或 LAN 上的已認證使用者（**Wi-Fi 訪客除外**）可以檢索軟體版本號。

#### 佐證證據 (Supporting Evidence)

* 開發商應提供證據，形式為**截圖、照片或圖片**，清楚顯示產品標籤上的產品型號名稱。
* 開發商應提供證據（例如：截圖、影片等）展示下列事項：
    * 管理者或已認證使用者**可以**檢索設備軟體版本號。
    * 未授權使用者或訪客使用者**無法**檢索設備軟體版本號。

#### 評估 (Assessment)

* 評估人員將檢查提供的產品標籤，以判斷其是否清楚顯示設備的型號名稱。
* 評估人員將驗證軟體版本號是否**僅限**由管理者或 LAN 上的已認證使用者檢索，且無法由任何其他使用者角色（若存在）以及 Wi-Fi 訪客網路上的使用者檢索。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款包含兩個層面：**硬體標示**與**資訊洩漏防護 (Information Disclosure)**。

1.  **硬體標籤 (Labeling)**：這看似基本，但很多白牌或代工產品容易忽略。標籤上必須要有明確的 Model Number，這與申請書上的型號必須一致。
2.  **隱藏版本號 (Hide Version Number)**：這是資安上的關鍵要求。
    * **為什麼要藏？** 駭客攻擊的第一步是「情蒐」。如果登入頁面就直接顯示 "Firmware v1.2.3"，駭客可以立刻去 CVE 資料庫查詢該版本有哪些已知漏洞（如 RCE），然後發動精準攻擊。
    * **嚴格的存取控制**：這意味著在**登入前 (Pre-auth)** 的任何頁面、API 回應、或是 HTTP Header 中，都**絕對不能**出現版本號。

#### 具體落地實現方案建議

* **系統設計與 UI 調整**：
    * **登入頁面淨化**：
        * 檢查 Web GUI 的 Login Page HTML。很多舊式 Router 習慣在頁尾 (Footer) 顯示 "Firmware Version: x.x.x"。**必須移除**。
    * **API 回應過濾**：
        * 檢查 `/api/system/info` 或 `/api/status` 這類通常不需驗證的 API。確保它們**不回傳** `sw_version` 欄位，或者要求附帶 Session Token 才能讀取。
    * **HTTP Headers 檢查**：
        * 檢查 Web Server (uhttpd/nginx) 的 Config。
        * 避免回傳如 `Server: uhttpd/1.0.0` 這種暴露底層軟體版本的 Header。建議改為通用的 `Server: WebServer` 或隱藏該 Header。
    * **訪客網路隔離 (Guest Network Isolation)**：
        * 確保 Guest Wi-Fi 的防火牆規則 (iptables) 禁止存取 Gateway 的管理 IP (如 192.168.1.1 的 Port 80/443)。如果連首頁都連不上，自然看不到版本號。

* **證據收集策略**：
    * **機身貼紙照片**：拍攝清晰的產品底部標籤，需能看清 Model No. 與 Serial No. (Unique Identifier)。
    * **登入前 vs 登入後對照圖**：
        * **圖 1 (未授權)**：截取登入畫面，證明畫面上**沒有**版本號。
        * **圖 2 (已授權)**：輸入密碼登入後，截取「系統狀態」頁面，證明畫面上**有**版本號。
    * **訪客測試圖**：
        * 連線到 Guest Wi-Fi。
        * 嘗試 Ping Gateway 或瀏覽 Gateway IP。
        * 截取 "Request Timed Out" 或 "Connection Refused" 的畫面，證明訪客無法接觸管理介面。

* **測試與驗證**：
    * **原始碼搜尋**：在前端程式碼 (HTML/JS) 中搜尋 "version", "ver", "v1." 等關鍵字，確保沒有註解掉但未刪除的版本資訊。
    * **Nmap 版本偵測**：使用 `nmap -sV <Device_IP>` 掃描，確認開啟的服務（如 SSH, Web）不會在 Banner 中主動報出詳細版本號。

---
[回到 5.3 – 保持軟體更新 (KEEP SOFTWARE UPDATED)](./5.3-keep-software-updated.md)
