## 5.4 – 安全地儲存敏感安全參數 (SECURELY STORE SENSITIVE SECURITY PARAMETERS)

### [此條款僅對 ISP 管理的設備為強制性] 條款 7.4-2 (Provision 7.4-2)

存取 ISP 管理者憑證 (ISP administrator credentials) 的權限，必須限制僅能由家庭閘道器 (HG) 的已認證 ISP 管理者存取。

#### 最低要求 (Minimum Requirements)

* 設備必須確保只有 HG 的**已認證 ISP 管理者**有權存取 ISP 管理者憑證。

#### 佐證證據 (Supporting Evidence)

* 開發商應提供佐證證據（例如：截圖、產品文件等），顯示 ISP 管理者憑證的存取權限，已限制為僅供 HG 的已認證 ISP 管理者存取。

#### 評估 (Assessment)

* 評估人員將檢查是否只有 HG 的已認證 ISP 管理者有權存取 ISP 管理者憑證。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款是針對 **ISP 客製機 (Operator Tier)** 的特殊權限隔離要求。

1.  **超級管理者隱藏 (Super Admin Isolation)**：
    * ISP 設備通常會有兩層管理權限：
        * **Local Admin (使用者)**：一般消費者，可以改 Wi-Fi 密碼、設定家長監護。
        * **ISP Admin (維運者)**：電信商客服或遠端管理系統 (ACS)，擁有最高權限，負責下發設定、韌體更新與除錯。
    * **核心衝突**：本地使用者 (Local Admin) **絕對不能**看到或修改 ISP Admin 的帳號密碼（例如 TR-069 的連線密碼、PPPoE 的管理後門密碼）。如果使用者能看到這些，他們可能會誤改導致斷網，或者竊取這些憑證去攻擊 ISP 的內網。
2.  **設定檔保護**：這也意味著，當使用者下載 "Config Backup" (設定檔備份) 時，裡面的 ISP 敏感資訊必須被加密、遮蔽，或者根本不包含在內。

#### 具體落地實現方案建議

* **系統設計與權限分級**：
    * **角色定義 (RBAC)**：
        * 系統內部需定義 `ROLE_USER_ADMIN` 與 `ROLE_ISP_ADMIN`。
        * TR-069 相關參數 (URL, Username, Password) 的讀寫權限僅限於 `ROLE_ISP_ADMIN`。
    * **UI 隱藏**：
        * 當以一般 User Admin 登入時，TR-069 設定頁面應完全隱藏 (Hidden) 或呈現唯讀且遮蔽 (Read-only & Masked)。
    * **CLI/Shell 保護**：
        * 即使是透過 SSH 登入，若身分是 User Admin，也不應有權限 `cat` 出 ISP 的設定檔。

* **證據收集策略**：
    * **對照截圖**：
        * **圖 1 (Local Admin 視角)**：登入一般管理介面，展示「找不到 TR-069 設定」或「設定值被遮蔽 (******)」的畫面。
        * **圖 2 (ISP Admin 視角/說明)**：提供文件說明 ISP 端如何透過 ACS 或特殊帳號進行管理，證明該憑證存在但被隔離。
    * **備份檔檢查**：
        * 下載一份設定備份檔 (backup.conf)，用文字編輯器打開並截圖，證明裡面找不到 ISP 的機密密碼（或已加密亂碼）。

* **測試與驗證**：

    * **越權測試**：QA 使用 Local Admin 帳號登入，嘗試直接輸入 ISP 管理頁面的 URL（例如 `/advanced/tr069.html`），系統應回傳 403 Forbidden 或重新導向回首頁。



---

[回到 5.4 Securely Store Sensitive Security Parameters](./5.4-securely-store-security-parameters.md)