## 5.6 - 最小化暴露的攻擊面 (MINIMISE EXPOSED ATTACK SURFACES)

### 條款 5.6-1 (Provision 5.6-1)

所有未使用 (unused) 的網路與邏輯介面必須被停用。若具備訪客 Wi-Fi® 存取功能，預設必須為停用狀態。

#### 最低要求 (Minimum Requirements)

* 設備必須停用所有未使用及不必要（非設備運作所必需）的網路與邏輯介面。
* 若設備支援訪客 Wi-Fi 功能，該功能預設必須為**停用 (disabled)** 狀態。

#### 佐證證據 (Supporting Evidence)

* 開發商應提供設備所有網路與邏輯介面（例如：藍牙、ZigBee）的清單。此外，開發商應宣告這些介面是「使用中」還是「未使用」。
* 開發商應提供證據（例如：**Ubertooth 掃描**結果、設定檔等），顯示所有未使用及停用的介面確實已被停用。
* 開發商應提供證據（例如：GUI 截圖、使用者手冊等），證明訪客 Wi-Fi 功能（若支援）預設為停用。
* 開發商應針對 WAN 與 LAN 介面執行通訊埠掃描（請參考下列 nmap 指令），並提供證據（例如：截圖、附上 nmap 輸出檔等）顯示完整報告，確保所有連接埠皆已列入考量。
    * 通訊埠掃描可使用以下指令執行：`nmap -sT -sU -A -p- <ip address>`
* 開發商應針對所有**開啟/啟用 (Open/Enabled)** 的連接埠提供正當理由 (Justification)。範例如下：
    * **開啟連接埠**：理由
    * **Port 8443**：HTTPS 用戶端認證連線

#### 評估 (Assessment)

* 評估人員將檢查開發商提供的網路與邏輯介面清單是否完整。
* 評估人員將驗證訪客 Wi-Fi 功能是否預設為停用。
* 評估人員將檢查通訊埠掃描的輸出結果，以判斷是否有任何未說明理由的連接埠或未使用的開啟連接埠。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款是關於**「減少攻擊面 (Attack Surface Reduction)」**的基本功。

1.  **關閉非必要之門**：
    * 任何開啟的 Port 都是潛在的入口。如果您開了 Port 23 (Telnet) 但實際上沒在用，或者開了 Port 8080 用於開發測試但忘記關，這些都會被 Nmap 掃出來並導致不合規。
    * **邏輯介面也算**：不只是 TCP/IP Port，硬體介面如 **ZigBee** 或 **Bluetooth** 若硬體存在但軟體功能未啟用，必須確保其 Radio 是關閉的（不發射訊號）。
2.  **訪客網路的預設狀態**：
    * 訪客網路雖然是為了隔離安全，但如果預設開啟且沒設密碼（Open Network），反而會成為鄰居蹭網或攻擊者進入的跳板。因此要求預設必須是 **OFF**。
3.  **白名單管理**：
    * 對於 Nmap 掃出來的每一個 Open Port，開發者都必須「給個說法」。不能只說「這是系統開的」，要具體說明「這是 DNS 服務 (Port 53)，用於解析內網域名」。

#### 具體落地實現方案建議

* **系統設計與出廠設定**：
    * **服務盤點**：
        * 檢查 `/etc/init.d/` 或 systemd，關閉所有 Production 環境不需要的服務（如 `telnetd`, `ftpd`, `adb`）。
    * **無線介面設定**：
        * 在 `wireless` config 中，確保 Guest SSID 的 `disabled` 選項預設為 `1` (True)。

* **證據收集策略**：
    * **Nmap 全掃描 (必備)**：
        * 這條款對 Nmap 指令有嚴格要求：`-p-` 代表掃描 1-65535 全部端口，`-sU` 代表包含 UDP。這通常非常花時間（數小時），請 QA 團隊提早準備。
        * **輸出處理**：將掃描結果存成 `.txt` 或 `.xml`，並截圖證明掃描完成。
    * **連接埠理由表 (Port Justification Table)**：
        * 準備一份 Excel 表格，列出掃描到的每一個 Port，並填寫用途。這份表格是評估人員對照 Nmap 報告的關鍵文件。

* **測試與驗證**：
    * **藍牙/ZigBee 偵測**：
        * 若宣告未使用藍牙，使用 `hcitool scan` 或手機藍牙掃描，應搜尋不到該設備。

---
[回到 5.6 Minimise Exposed Attack Surfaces](./5.6-minimise-exposed-attack-surfaces.md)