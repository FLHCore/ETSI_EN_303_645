## 生命週期文件 (LIFECYCLE DOCUMENTS)

### 條款 CK-LP-03

您是否使用來自安全供應鏈的組件來實作與維護設備，且無已知的未緩解漏洞？

#### 最低要求 (Minimum Requirements)

* 必須制定適當措施，確保設備組件（包含軟體與硬體組件）沒有已知的未緩解漏洞 (known unmitigated vulnerabilities)。
* 必須制定實務做法，以確保修補過時的函式庫。
* 已發布版本的設備中，不得使用易受攻擊的函式庫（包括來自第三方來源的函式庫）。
* 必須制定實務做法，以評估並選擇用於設備生產版本的組件。
* 若作業系統存在安全漏洞，必須提供支援，以便透過手動或自動更新來解決這些安全漏洞。

#### 佐證證據 (Supporting Evidence)

* 開發商應提供設備組件清單（例如：**軟體物料清單 (SBOM)**、**硬體物料清單 (HBOM)** 等）。
    * 對於 HBOM 提交，非安全相關的組件可省略。
* 開發商應描述（例如：評估標準、效能監控等）如何評估並選擇這些設備組件以用於設備的生產版本。
* 開發商應提供證據（例如：內部流程文件、白皮書等），顯示修補易受攻擊與過時函式庫（包含第三方函式庫）的流程。
* 開發商應提供證據（例如：內部流程文件、白皮書等），顯示修補作業系統安全漏洞的流程。

#### 評估 (Assessment)

* 評估人員將檢查開發商是否提供設備組件清單。
* 評估人員將檢查開發商是否具備評估與選擇設備生產所用組件的流程，以降低組件含有任何已知未緩解漏洞的機率。
* 評估人員將檢查是否有適當的流程，以確保定期修補設備所使用的易受攻擊與過時函式庫（包含第三方函式庫）。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款正式引入了 **軟體供應鏈安全 (Software Supply Chain Security)** 的概念。現代 IoT 設備通常有 80%~90% 的程式碼來自開源專案（如 OpenWrt, OpenSSL, BusyBox, Curl）。

1.  **SBOM 的強制性**：
    * **SBOM (Software Bill of Materials)** 不再是選配，而是必須提交的佐證。這相當於軟體的「食品成分表」，列出所有用到的套件及其版本。
2.  **零已知漏洞 (Zero Known Vulnerabilities)**：
    * 這是極高標準的要求。您不能說「這個 OpenSSL 漏洞很舊，應該沒事」。只要 CVE 資料庫顯示它有未修補的漏洞，且被掃描工具抓出來，您就必須升級該組件，或者提出強而有力的「不可利用 (Not Exploitable)」證明。
3.  **上游選品責任**：
    * 條款要求「評估與選擇流程」。這意味著工程師不能隨便從 GitHub 下載一個 5 年沒維護的 Library 來用。必須證明您有審核過它的維護狀態。

#### 具體落地實現方案建議

* **工具鏈整合 (SCA Tools)**：
    * **SCA (Software Composition Analysis)**：這是自動化產生 SBOM 與掃描漏洞的關鍵。
    * **實作建議**：
        * 在 CI/CD Pipeline 中整合工具，如 **Black Duck**, **Snyk**, **Trivy**, 或 **OWASP Dependency-Check**。
        * 每次編譯時自動產生 SBOM (格式建議：**SPDX** 或 **CycloneDX**)。

* **流程文件化**：
    * **開源軟體使用政策 (OSS Policy)**：
        * 制定內部規定：「禁止使用『停止維護』或『超過 2 年未更新』的開源專案」。
        * 「引入新 Library 需經過 Security Team 核准」。

* **證據收集策略**：
    * **SBOM 檔案**：
        * 直接提供 `.json` 或 `.xml` 格式的 SBOM 檔案。確保裡面包含：Component Name, Version, License。
    * **漏洞掃描報告**：
        * 提供 SCA 工具的掃描結果，證明 **Critical** 與 **High** 級別的漏洞數為 **0**。
        * **例外處理單 (Vulnerability Exception Form)**：如果有掃出漏洞但無法修補（例如硬體限制），必須附上一份分析報告，解釋為何該漏洞在您的設備環境下「無法被利用 (Not Exploitable)」（例如：該漏洞在 USB 模組，但設備沒有 USB 孔）。

* **測試與驗證**：
    * **CVE 狙擊測試**：
        * QA 隨機挑選 SBOM 中的一個組件（例如 `dnsmasq 2.78`），去 CVE 資料庫查詢該版本是否有已知漏洞。如果有，代表 SCA 工具失效或開發者忽略了更新。