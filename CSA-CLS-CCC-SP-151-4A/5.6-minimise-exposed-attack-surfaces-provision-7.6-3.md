## 5.6 - 最小化暴露的攻擊面 (MINIMISE EXPOSED ATTACK SURFACES)

### 條款 7.6-3 (Provision 7.6-3)

若家庭閘道器 (HG) 支援並啟用了訪客 Wi-Fi (guest Wi-Fi) 頻道和/或社群 HG 頻道 (community HG channel)，則每一種對應的 Wi-Fi 帳戶類型彼此之間必須進行**密碼學隔離 (cryptographically isolated)**。

#### 最低要求 (Minimum Requirements)

* 對於 HG 支援並啟用的每一種 Wi-Fi 帳戶類型，各 Wi-Fi 帳戶類型之間必須進行密碼學隔離。
* 範例包括但不限於：
    * 為每個 Wi-Fi 頻道/SSID 配置**獨立的安全參數與加密金鑰**。
    * 為所有 Wi-Fi 帳戶類型實作 **WPA2 或 WPA3**。

#### 佐證證據 (Supporting Evidence)

* 開發商應提供證據（例如：配置或 HG 設定的截圖、存取控制與防火牆規則、使用者手冊等），顯示 Wi-Fi 帳戶類型之間彼此已進行密碼學隔離。

#### 評估 (Assessment)

* 評估人員將檢查 HG 支援並啟用的所有 Wi-Fi 帳戶類型是否彼此進行了密碼學隔離。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款關注的是**多重 SSID 的安全性隔離 (Network Segmentation)**。

1.  **密碼學隔離的定義**：
    * 這意味著不同的網路（如 Main Wi-Fi vs Guest Wi-Fi）不能共用同一個加密金鑰 (Pre-Shared Key, PSK)。
    * **技術實作**：每個 SSID 必須有自己獨立的 `wpa_psk` 設定。如果 Guest Network 只是 Main Network 的一個 alias 且用同樣的密碼，這就不算密碼學隔離。
2.  **社群頻道 (Community Channel)**：
    * 這是針對 ISP 設備的特殊要求。許多 ISP 會在用戶家中的 Router 開一個公開的熱點（如 "Xfinity WiFi" 或 "BT Wi-fi"）供路人使用。
    * **隔離要求**：這個公開熱點的流量必須與用戶家中的私有流量完全分開，通常透過獨立的 **VLAN** 與 **Tunnel** 直接送回 ISP 機房，絕對不能混入用戶的 LAN。



[Image of network diagram showing Wi-Fi guest network isolation via VLAN]


#### 具體落地實現方案建議

* **系統設計與 hostapd 設定**：
    * **多 BSSID 設定 (Multi-BSSID)**：
        * 在 `hostapd.conf` 中定義多個 `bss` 區塊。
        * 每個區塊必須有獨立的 `ssid` 與 `wpa_passphrase`。
    * **網路介面綁定 (Interface Binding)**：
        * Main SSID (`wlan0`) -> Bind to `br-lan` (LAN Bridge).
        * Guest SSID (`wlan0_1`) -> Bind to `br-guest` (Guest Bridge).
    * **防火牆隔離**：
        * 在 iptables 中，設定 `br-guest` 不能轉發封包到 `br-lan`。
        * `iptables -I FORWARD -i br-guest -o br-lan -j DROP`

* **證據收集策略**：
    * **設定檔截圖**：
        * 截取 `hostapd` 設定檔或 `/etc/config/wireless` (OpenWrt)，標示出兩個 SSID 擁有不同的 Key。
    * **GUI 設定畫面**：
        * 截取 Web 管理介面，顯示 "主網路" 與 "訪客網路" 的設定頁面是分開的，且各自有獨立的密碼輸入框。

* **測試與驗證**：
    * **跨網段 Ping 測試**：
        * 連線到 Guest Wi-Fi。
        * 嘗試 Ping 主網路中的 NAS 或印表機 IP。
        * **預期結果**：Request Timed Out (無法連通)。
    * **封包側錄 (Sniffer)**：
        * 使用 Wireshark + 空中封包擷取 (Monitor Mode)。
        * 確認 Guest Wi-Fi 的 4-Way Handshake 使用的 Key 與主網路不同。