## 5.4 – 安全地儲存敏感安全參數 (SECURELY STORE SENSITIVE SECURITY PARAMETERS)

### 條款 7.4-3 (Provision 7.4-3)

安全關鍵數據 (Security critical data) 必須由家庭閘道器 (HG) 獨立於使用者數據 (user data) 進行管理。

#### 最低要求 (Minimum Requirements)

* 設備必須確保在處理安全關鍵數據與使用者數據時，有明確的**隔離 (segregation)**。
* 這兩類數據的範例包括但不限於：
    * **安全關鍵數據**：
        1.  網路配置 (Network Configurations)
        2.  存取憑證 (Access Credentials)
        3.  防火牆規則 (Firewall Rules)
    * **使用者數據**：
        1.  設備使用模式 (Device Usage Patterns)
        2.  網際網路瀏覽紀錄 (Internet Browsing History)
        3.  連線設備資訊 (Connected Device Information)

#### 佐證證據 (Supporting Evidence)

* 開發商應提供證據（例如：GUI 截圖、產品文件等），展示安全關鍵數據是獨立於使用者數據進行管理的。

#### 評估 (Assessment)

* 評估人員將檢查安全關鍵數據是否獨立於使用者數據進行管理。

---

### 開發者深度導讀 (針對 Gateway / App / Cloud 開發商)

#### 本章節核心要求與意涵

本條款的核心在於**「數據治理 (Data Governance) 與 架構隔離」**。這不僅是資安問題，也涉及隱私保護。

1.  **架構上的隔離**：
    * 路由器通常會儲存兩類截然不同的資料：
        * **Type A (Infrastructure)**：讓網路能運作的設定（IP, Wi-Fi 密碼, 防火牆）。
        * **Type B (Privacy/Usage)**：使用者做了什麼的紀錄（DNS Log, 流量統計, 瀏覽紀錄）。
    * **風險**：如果這兩類資料混在一起（例如存在同一個 SQLite DB 或同一個 JSON 檔），當進行「備份」或「重置」時，很容易發生意外。例如：使用者只想「清除瀏覽紀錄」，結果不小心連「Wi-Fi 設定」也洗掉了；或者使用者想備份「網路設定」到新機器，結果把舊的「瀏覽隱私紀錄」也帶過去了。
2.  **生命週期管理的差異**：
    * 安全數據通常需要**高可用性與備份**。
    * 使用者數據（如瀏覽紀錄）通常需要**定期清除或匿名化**。

#### 具體落地實現方案建議

* **系統設計與資料庫規劃**：
    * **資料庫分離**：
        * 建議使用不同的資料庫檔案或分區來儲存。
        * `/data/config.db`：儲存 SSID, Password, Firewall Rules。（備份時僅備份此檔）
        * `/data/logs.db` 或 `/var/log/usage/`：儲存流量統計、連線紀錄。（重開機可清除或定期 Log Rotate）
    * **重置功能的細粒度 (Granularity)**：
        * 在 Web GUI 的「系統管理」頁面，不應只有一個 "Factory Reset"。
        * 建議提供選項：
            * "Reset Network Settings" (僅清除安全關鍵數據)
            * "Clear Usage Data & Logs" (僅清除使用者數據)
            * "Erase All Content and Settings" (雙重清除)

* **證據收集策略**：
    * **GUI 選項截圖**：截取管理介面中，「清除紀錄」與「重置設定」是分開的按鈕，證明管理機制是獨立的。
    * **檔案系統列表**：在 Console 執行 `ls -l /path/to/data`，展示 Config 與 Log 是存放在不同的檔案或資料夾中。
    * **備份檔結構展示**：如果支援匯出 Config，展示備份檔的內容（如 XML/JSON），證明裡面**不包含**使用者的瀏覽紀錄或流量統計數據。

* **測試與驗證**：
    * **獨立清除測試**：
        * 步驟 1：累積一些瀏覽紀錄或流量統計。
        * 步驟 2：執行「重置網路設定」。
        * 步驟 3：檢查網路設定是否回到預設值，但確認 Log 是否被意外保留（或反之，執行清除 Log，確認 Wi-Fi 密碼沒斷線）。

---
[回到 5.4 Securely Store Sensitive Security Parameters](./5.4-securely-store-security-parameters.md)